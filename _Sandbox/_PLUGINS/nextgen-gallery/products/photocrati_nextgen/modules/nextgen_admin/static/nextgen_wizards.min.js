"use strict";function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}if("undefined"==typeof NextGEN_Wizard_Manager){var NextGEN_Wizard=function(t,e){this.id=t,this.manager=e,this.data={},this.steps=[],this.status=null,this.tour=null,this.created=Math.floor(Date.now()/1e3)};NextGEN_Wizard.prototype.start=function(){null!=this.tour&&this.tour.start()},NextGEN_Wizard.prototype.getNextStep=function(t){for(var e=0;e<this.steps.length;e++){if(this.steps[e].id==t)break}return e++,e<this.steps.length?this.steps[e]:null},NextGEN_Wizard.prototype.setState=function(t){};var manager={state:[],wizards:[],runningWizard:null,views:[],starter:null,anchor:null,events:{},targetWatchers:{},refreshTimer:null,nggEvents:[],init:function(){function t(t){this.itemSelector=".view-item",this.currentWizard=null,this.currentStep=null,this.doneFlag=!1,this.init=function(){},this.disable=function(){t.addClass("ngg-wizard-disabled")},this.enable=function(){t.removeClass("ngg-wizard-disabled")},this.setup=function(){},this.reset=function(){t.removeClass("ngg-wizard-has-selection"),t.find(this.itemSelector).removeClass("ngg-wizard-selected")},this.done=function(t){this.doneFlag||(this.doneFlag=!0,this.trigger("done",this,t))}}function e(e){t.call(this,e);var n=this;jQuery(e.get(0).ownerDocument).on("click",e.selector,function(t){n.done(e)})}function n(e){t.call(this,e);var n=this;e.on("click",function(t){(!e.is("a,button.ngg_save_settings_button,input.ngg_save_gallery_changes")||e.attr("href").startsWith("#")||e.attr("href").startsWith("javascript:")||e.hasClass("thickbox"))&&n.done(e)}),this.setup=function(){if(e.is("a,button.ngg_save_settings_button,button.ngg_save_pricelist_button,input.ngg_save_gallery_changes")){if(e.is("a")){var t=e.attr("href");this.originalHref=t}if(e.is("button.ngg_save_settings_button,button.ngg_save_pricelist_button,input.ngg_save_gallery_changes")){var t=e.parents("form").attr("action");t.indexOf("&ngg_wizard")>-1&&(hrefSplit=t.split("&ngg_wizard"),t=hrefSplit[0])}t.startsWith("#")||(-1==t.indexOf("?")?t+="?":t+="&",t=t+"ngg_wizard="+this.currentWizard+"&ngg_wizard_step="+this.currentStep,e.is("a")&&e.attr("href",t),e.is("button.ngg_save_settings_button,button.ngg_save_pricelist_button,input.ngg_save_gallery_changes")&&e.parents("form").attr("action",t))}},this.reset=function(){this.originalHref&&e.is("a")&&e.attr("href",this.originalHref)}}function i(e){t.call(this,e);var n=this;e.on("input",function(t){jQuery(this).val().length>=3&&n.done(e)}),this.setup=function(){}}function r(e){t.call(this,e);var n=this;jQuery(e.get(0).ownerDocument).on("change",e.selector,function(t){jQuery(this).is(":checked")&&n.done(e)}),this.setup=function(){}}function o(e){t.call(this,e);var n=this;e.on("change",function(t){n.done(e)})}"undefined"!=typeof NextGEN_Wizard_Manager_State&&(this.state=NextGEN_Wizard_Manager_State);var a=this;jQuery(window.top.document).find("body").on("nextgen_event",function(t,e){a.nggEvents.push({type:e})}),_.extend(t.prototype,Backbone.Events),_.extend(e.prototype,t.prototype),_.extend(n.prototype,t.prototype),_.extend(i.prototype,t.prototype),_.extend(r.prototype,t.prototype),_.extend(o.prototype,t.prototype);var s=null;s={handler:o,name:"SelectView",selector:"select"},this.views.push(s),s={handler:r,name:"RadioView",selector:"input[type='radio']"},this.views.push(s),s={handler:i,name:"TextView",selector:"input[type='text'], input[type='search'], input[type='email'], input[type='tel'], input[type='number'], input[type='username'], input[type='password'], textarea"},this.views.push(s),s={handler:n,name:"ButtonView",selector:"a, input[type='button'], input[type='submit'], button"},this.views.push(s),s={handler:e,name:"GenericView",selector:"*"},this.views.push(s),Tourist.Tip.Base.prototype.nextButtonTemplate='<a class="button-primary pull-right tour-next">Next step â†’</a>',Tourist.Tip.Base.prototype.finalButtonTemplate='<button class="button-primary pull-right tour-next">Finish up</button>',Tourist.Tip.Base.prototype.closeButtonTemplate='<a class="btn btn-close tour-close" href="#"><i class="icon icon-remove far fa-window-close"></i></a>',Tourist.Tip.BootstrapTip.prototype._getTargetBounds=function(t){var e,n;e=t[0],n="function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight};var i=t.offset();if(t.ownerDocument!=document)for(var r=function t(e,n){for(var i=e.find("iframe"),r=[],o=0;o<i.length;o++){var a=jQuery(i.get(o));try{if(a.prop("contentWindow").document==n)return[a]}catch(t){continue}var s=t(a.contents(),n);if(s.length>0){r.push(a);for(var u=0;u<s.length;u++)r.push(s[u]);break}}return r}(jQuery(document),t.get(0).ownerDocument),o=0;o<r.length;o++){var a=r[o],s=a.offset();i.left+=s.left,i.top+=s.top}return jQuery.extend({},n,i)},jQuery(".ngg-wizard-invoker").on("click",function(t){t.preventDefault();for(var e=NextGEN_Wizard_Manager,n=jQuery(this).data("ngg-wizard"),i=null,r=0;r<e.wizards.length;r++){var o=e.wizards[r];if(o.id==n){i=o;break}}return null!=i&&null==this.runningWizard&&i.start(),!1})},bind:function(t,e){t in this.events||(this.events[t]=[]);var n={handler:e};this.events[t].push(n)},trigger:function(t,e){if(void 0===e&&(e={}),t in this.events)for(var n=this.events[t],i=0;i<n.length;i++){var r=n[i];r.handler&&r.handler(this,e)}},didNextgenEventFire:function(t){for(var e=0;e<this.nggEvents.length;e++){if(this.nggEvents[e].type==t)return!0}return!1},getViewForSelector:function(t,e){var n=null;void 0===e&&(e=!0);for(var i=0;i<this.views.length;i++){var r=this.views[i];if(t.is(r.selector)){n=r.handler;break}}if(null!=n){var r=new n(t);return e&&r.init(),r}return null},getViewFor:function(t,e,n){var i=this.getViewForSelector(t,!1);return null!=i&&(i.currentWizard=e,i.currentStep=n,i.init()),i},generateQueue:function(t){var e=this,n=this.state,i=n.wizard_list.length,r=n.starter,o=n.running_wizard;if(i>0){var a=t('<div id="ngg-wizard-starter" class="ngg-wizard-starter"></div>');a.append('<div class="starter-wrap-top"><div class="starter-wrap-icon"><img class="starter-icon" src="'+r.image+'" /></div></div>'),a.append('<div class="starter-wrap-bottom"><div class="starter-wrap-text">'+r.text+"</div></div>"),a.on("click",".starter-wrap-icon, starter-wrap-bottom",function(){e.startQueue()}),a.hide(),a.appendTo("body"),this.starter=a;var s=t('<div id="ngg-wizard-anchor" class="ngg-wizard-anchor"></div>');s.appendTo("body"),this.anchor=s;for(var u=0,l=0;l<i;l++){var d=n.wizard_list[l],h=new NextGEN_Wizard(d.id,this);h.data=d,h.steps=d.steps;var g=this.generateTour(h);"ok"==g.result?(h.status="ready",h.tour=g.tour):"wait_element"==g.result&&(h.status="wait",u++),h.id==o?(this.wizards.unshift(h),this.runningWizard=h):this.wizards.push(h)}u>0?this.enqueueRefreshOperation():this.trigger("ready")}},getContextObject:function(t){var e=null;if(null!=t){"object"!==_typeof(t)&&(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(e=null==e?jQuery(i):e.find(i),e.is("iframe")){var r=e.prop("contentWindow");if("interactive"!=r.document.readyState&&"complete"!=r.document.readyState){e=jQuery([]);break}e=r.jQuery?r.jQuery("body"):e.contents().find("body")}}0==e.length&&(e=jQuery([]))}else e=jQuery(document);return e},computeStepTarget:function(t,e,n){var i=e.target_wait,r=e.target,o=e.view,a=null,s=null,u=null,l=this.getContextObject(e.context),d=!1;if(null!=r){if(a=l.find(r),a.length>0?d=!0:a=this.anchor,!d&&null!=i&&Math.floor(Date.now()/1e3)-t.created<=i)return!1}else a=this.anchor;return null!=o&&(s=l.find(o),s.length>0&&(u=this.getViewFor(s,t.id,e.id))),n.highlightTarget=d,n.nextButton=!d||e.optional,n.target=a,n.ngg_view=u,!0},scrollIntoView:function(t){},generateTour:function(t){if(null==t.tour){var e=t.data,n=e.steps,i=e.current_step,r=0,o=[],a=null;if(null!=e.view&&null==(a=this.getViewFor(jQuery(e.view),t.id)))return{result:"wait_element",element:e.view};for(var s=0;s<n.length;s++){var u=n[s];null!=i&&i==u.id&&(r=s);var l={ngg_step_id:u.id,ngg_step_data:u,viewport:jQuery(window),closeButton:!0,content:'<div class="ngg-wizard-text">'+u.text+"</div>",my:u.popup_anchor,at:u.target_anchor,bind:["onDone"],onDone:function(t,e,n,i){var r=t.ngg_wizard,o=this.ngg_step_data,a=!0;if(null!=o.condition&&(this.condition_met||(a=!1,this.condition_setup||this.setupCondition(t,e))),a&&null!=r){var s=r.getNextStep(this.ngg_step_id);if(null!=s&&s.lazy){a=!1;for(var u=null,l=0;l<t.options.steps.length;l++){var d=t.options.steps[l];if(d.ngg_step_id==s.id){u=d;break}}null!=u&&(null==u.target||0==u.target.length||"ngg-wizard-anchor"==u.target.attr("id")?!(a=r.manager.computeStepTarget(r,s,u))||null!=u.target&&0!=u.target.length&&"ngg-wizard-anchor"!=u.target.attr("id")||(a=!1):a=!0)}}if(a)t.next();else{null!=this.lazyTimeout&&(clearTimeout(this.lazyTimeout),this.lazyTimeout=null);var h=this;this.lazyTimeout=setTimeout(function(){h.lazyTimeout=null,h.onDone(t,e,n,i)},500)}}};if(!this.computeStepTarget(t,u,l))return{result:"wait_element",element:u.target};l.setupCondition=function(t,e){var n=t.ngg_wizard,i=this.ngg_step_data;if(!this.condition_setup&&null!=i.condition){var r=i.condition,o=r.type,a=r.value,s=r.context,u=r.timeout;this.condition_met=!1,this.condition_setup=!1,s&&"object"!==_typeof(s)&&(s=[s]);var l=jQuery([]);if(s){s=s.slice(0);var d=s.pop();l=n.manager.getContextObject(s).find(d)}if(l.length>0){var h=l.get(0).ownerDocument;h.defaultView||h.parentWindow}switch(o){case"frame_event":if(window.Frame_Event_Publisher){this.condition_setup=!0;var g=this;Frame_Event_Publisher.listen_for(a,function(){g.condition_met=!0})}break;case"event_bind":case"uppy_bind":var c=l.length>0;if("uppy_bind"===o&&void 0!==window.ngg_uppy&&(l=window.ngg_uppy),c){this.condition_setup=!0;var g=this;l.on(a,function(){g.condition_met=!0})}break;case"nextgen_event":if(this.condition_setup=!0,n.manager.didNextgenEventFire(a))this.condition_met=!0;else{var g=this;jQuery(window.top.document).find("body").on("nextgen_event",function(t,e){e==a&&(g.condition_met=!0)})}break;case"wait":this.condition_setup=!0;var g=this;setTimeout(function(){g.condition_met=!0},a)}}var p=jQuery(".tourist-popover .ngg-wizard-text"),f=p.find(".ngg-wizard-loading");if(f.hide(),this.condition_setup&&!this.condition_met&&u>0){this.condition_timeout=0,0==f.length&&(f=jQuery('<div class="ngg-wizard-loading"></div>'),p.append(f)),f.html("Loading... ("+Math.ceil(u/1e3).toString()+")"),f.show();var g=this;g.condition_timer=setInterval(function(){g.condition_timeout+=1e3,g.condition_timeout>=u&&(g.condition_met=!0);var t=(Math.floor(g.condition_timeout/1e3),Math.ceil(u/1e3),Math.floor((u-g.condition_timeout)/1e3));f.html("Loading... ("+t.toString()+")"),g.condition_met&&(f.hide(),clearInterval(g.condition_timer),g.condition_timer=null)},1e3)}return this.condition_setup},l.setup=function(t,e){var n=e.view;null!=this.ngg_view&&(n=this.ngg_view),null!=n&&(n.currentWizard=t.ngg_wizard_id,n.currentStep=this.ngg_step_id,n.setup(),n.on("done",this.onDone),n.enable())},l.teardown=function(t,e){var n=e.view;null!=this.ngg_view&&(n=this.ngg_view),null!=n&&(n.disable(),n.off("done",this.onDone),n.reset())},o.push(l)}var d={steps:o,tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"},stepOptions:{}};null!=a&&(d.stepOptions.view=a);var h=new Tourist.Tour(d);for(h.ngg_wizard_id=t.id,h.ngg_wizard=t;r>0;)h.next(),r--;return{result:"ok",tour:h}}},enqueueRefreshOperation:function(){null!=this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null),this.refreshTimer=setTimeout(function(t){NextGEN_Wizard_Manager.refreshQueue()},500)},refreshQueue:function(){this.refreshTimer=null;for(var t=0,e=0;e<this.wizards.length;e++){var n=this.wizards[e];if("wait"==n.status){var i=this.generateTour(n);"ok"==i.result?(n.status="ready",n.tour=i.tour):"wait_element"==i.result&&(n.status="wait",t++)}}t>0?this.enqueueRefreshOperation():this.trigger("ready")},start:function(){null!=this.runningWizard?this.runningWizard.start():this.showStarter()},showStarter:function(){},startQueue:function(){if(null!=this.starter){var t=this;this.starter.fadeOut(function(){t.nextTour()})}else this.nextTour()},nextTour:function(){for(var t=0,e=0;e<this.wizards.length;e++){var n=this.wizards[e];if("ready"==n.status&&null!=n.tour){t=e;break}}if(t<this.wizards.length){var n=this.wizards[t];n.tour.start()}},updateWizardState:function(t){}};manager.init(),window.NextGEN_Wizard_Manager=manager}jQuery(function(t){"undefined"!=typeof NextGEN_Wizard_Manager&&(NextGEN_Wizard_Manager.bind("ready",function(){NextGEN_Wizard_Manager.start()}),NextGEN_Wizard_Manager.generateQueue(t))});