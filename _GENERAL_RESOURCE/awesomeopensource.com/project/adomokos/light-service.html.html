<!DOCTYPE html>
<html>
  <head>
<script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam-cell.nr-data.net","errorBeacon":"bam-cell.nr-data.net","licenseKey":"98ebaa2fbd","applicationID":"233526624","transactionName":"c11aERNaXltSERdDR19YUQYVGltZUwZA","queueTime":3,"applicationTime":320,"agent":""}</script>
<script>(window.NREUM||(NREUM={})).loader_config={licenseKey:"98ebaa2fbd",applicationID:"233526624"};window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var i=t[n]={exports:{}};e[n][0].call(i.exports,function(t){var i=e[n][1][t];return r(i||t)},i,i.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,n){function r(){}function i(e,t,n){return function(){return o(e,[u.now()].concat(c(arguments)),t?null:this,n),t?void 0:this}}var o=e("handle"),a=e(6),c=e(7),f=e("ee").get("tracer"),u=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],p="api-",l=p+"ixn-";a(d,function(e,t){s[t]=i(p+t,!0,"api")}),s.addPageAction=i(p+"addPageAction",!0),s.setCurrentRouteName=i(p+"routeName",!0),t.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,t){var n={},r=this,i="function"==typeof t;return o(l+"tracer",[u.now(),e,n],r),function(){if(f.emit((i?"":"no-")+"fn-start",[u.now(),r,i],n),i)try{return t.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],n),e}finally{f.emit("fn-end",[u.now()],n)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,t){m[t]=i(l+t)}),newrelic.noticeError=function(e,t){"string"==typeof e&&(e=new Error(e)),o("err",[e,u.now(),!1,t])}},{}],2:[function(e,t,n){function r(){return c.exists&&performance.now?Math.round(performance.now()):(o=Math.max((new Date).getTime(),o))-a}function i(){return o}var o=(new Date).getTime(),a=o,c=e(8);t.exports=r,t.exports.offset=a,t.exports.getLastTimestamp=i},{}],3:[function(e,t,n){function r(e,t){var n=e.getEntries();n.forEach(function(e){"first-paint"===e.name?d("timing",["fp",Math.floor(e.startTime)]):"first-contentful-paint"===e.name&&d("timing",["fcp",Math.floor(e.startTime)])})}function i(e,t){var n=e.getEntries();n.length>0&&d("lcp",[n[n.length-1]])}function o(e){e.getEntries().forEach(function(e){e.hadRecentInput||d("cls",[e])})}function a(e){if(e instanceof m&&!g){var t=Math.round(e.timeStamp),n={type:e.type};t<=p.now()?n.fid=p.now()-t:t>p.offset&&t<=Date.now()?(t-=p.offset,n.fid=p.now()-t):t=p.now(),g=!0,d("timing",["fi",t,n])}}function c(e){d("pageHide",[p.now(),e])}if(!("init"in NREUM&&"page_view_timing"in NREUM.init&&"enabled"in NREUM.init.page_view_timing&&NREUM.init.page_view_timing.enabled===!1)){var f,u,s,d=e("handle"),p=e("loader"),l=e(5),m=NREUM.o.EV;if("PerformanceObserver"in window&&"function"==typeof window.PerformanceObserver){f=new PerformanceObserver(r);try{f.observe({entryTypes:["paint"]})}catch(v){}u=new PerformanceObserver(i);try{u.observe({entryTypes:["largest-contentful-paint"]})}catch(v){}s=new PerformanceObserver(o);try{s.observe({type:"layout-shift",buffered:!0})}catch(v){}}if("addEventListener"in document){var g=!1,w=["click","keydown","mousedown","pointerdown","touchstart"];w.forEach(function(e){document.addEventListener(e,a,!1)})}l(c)}},{}],4:[function(e,t,n){function r(e,t){if(!i)return!1;if(e!==i)return!1;if(!t)return!0;if(!o)return!1;for(var n=o.split("."),r=t.split("."),a=0;a<r.length;a++)if(r[a]!==n[a])return!1;return!0}var i=null,o=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var c=navigator.userAgent,f=c.match(a);f&&c.indexOf("Chrome")===-1&&c.indexOf("Chromium")===-1&&(i="Safari",o=f[1])}t.exports={agent:i,version:o,match:r}},{}],5:[function(e,t,n){function r(e){function t(){e(a&&document[a]?document[a]:document[i]?"hidden":"visible")}"addEventListener"in document&&o&&document.addEventListener(o,t,!1)}t.exports=r;var i,o,a;"undefined"!=typeof document.hidden?(i="hidden",o="visibilitychange",a="visibilityState"):"undefined"!=typeof document.msHidden?(i="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(i="webkitHidden",o="webkitvisibilitychange",a="webkitVisibilityState")},{}],6:[function(e,t,n){function r(e,t){var n=[],r="",o=0;for(r in e)i.call(e,r)&&(n[o]=t(r,e[r]),o+=1);return n}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],7:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,o=Array(i<0?0:i);++r<i;)o[r]=e[t+r];return o}t.exports=r},{}],8:[function(e,t,n){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,n){function r(){}function i(e){function t(e){return e&&e instanceof r?e:e?u(e,f,a):a()}function n(n,r,i,o,a){if(a!==!1&&(a=!0),!l.aborted||o){e&&a&&e(n,r,i);for(var c=t(i),f=v(n),u=f.length,s=0;s<u;s++)f[s].apply(c,r);var p=d[h[n]];return p&&p.push([b,n,r,c]),c}}function o(e,t){y[e]=v(e).concat(t)}function m(e,t){var n=y[e];if(n)for(var r=0;r<n.length;r++)n[r]===t&&n.splice(r,1)}function v(e){return y[e]||[]}function g(e){return p[e]=p[e]||i(n)}function w(e,t){s(e,function(e,n){t=t||"feature",h[n]=t,t in d||(d[t]=[])})}var y={},h={},b={on:o,addEventListener:o,removeEventListener:m,emit:n,get:g,listeners:v,context:t,buffer:w,abort:c,aborted:!1};return b}function o(e){return u(e,f,a)}function a(){return new r}function c(){(d.api||d.feature)&&(l.aborted=!0,d=l.backlog={})}var f="nr@context",u=e("gos"),s=e(6),d={},p={},l=t.exports=i();t.exports.getOrSetContext=o,l.backlog=d},{}],gos:[function(e,t,n){function r(e,t,n){if(i.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(o){}return e[t]=r,r}var i=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){i.buffer([e],r),i.emit(e,t,n)}var i=e("ee").get("handle");t.exports=r,r.ee=i},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,o,function(){return i++})}var i=1,o="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!x++){var e=b.info=NREUM.info,t=p.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return u.abort();f(y,function(t,n){e[t]||(e[t]=n)});var n=a();c("mark",["onload",n+b.offset],null,"api"),c("timing",["load",n]);var r=p.createElement("script");r.src="https://"+e.agent,t.parentNode.insertBefore(r,t)}}function i(){"complete"===p.readyState&&o()}function o(){c("mark",["domContent",a()+b.offset],null,"api")}var a=e(2),c=e("handle"),f=e(6),u=e("ee"),s=e(4),d=window,p=d.document,l="addEventListener",m="attachEvent",v=d.XMLHttpRequest,g=v&&v.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:v,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var w=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1194.min.js"},h=v&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),b=t.exports={offset:a.getLastTimestamp(),now:a,origin:w,features:{},xhrWrappable:h,userAgent:s};e(1),e(3),p[l]?(p[l]("DOMContentLoaded",o,!1),d[l]("load",r,!1)):(p[m]("onreadystatechange",i),d[m]("onload",r)),c("mark",["firstbyte",a.getLastTimestamp()],null,"api");var x=0},{}],"wrap-function":[function(e,t,n){function r(e,t){function n(t,n,r,f,u){function nrWrapper(){var o,a,s,p;try{a=this,o=d(arguments),s="function"==typeof r?r(o,a):r||{}}catch(l){i([l,"",[o,a,f],s],e)}c(n+"start",[o,a,f],s,u);try{return p=t.apply(a,o)}catch(m){throw c(n+"err",[o,a,m],s,u),m}finally{c(n+"end",[o,a,p],s,u)}}return a(t)?t:(n||(n=""),nrWrapper[p]=t,o(t,nrWrapper,e),nrWrapper)}function r(e,t,r,i,o){r||(r="");var c,f,u,s="-"===r.charAt(0);for(u=0;u<t.length;u++)f=t[u],c=e[f],a(c)||(e[f]=n(c,s?f+r:r,i,f,o))}function c(n,r,o,a){if(!m||t){var c=m;m=!0;try{e.emit(n,r,o,t,a)}catch(f){i([f,n,r,o],e)}m=c}}return e||(e=s),n.inPlace=r,n.flag=p,n}function i(e,t){t||(t=s);try{t.emit("internal-error",e)}catch(n){}}function o(e,t,n){if(Object.defineProperty&&Object.keys)try{var r=Object.keys(e);return r.forEach(function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){return e[n]=t,t}})}),t}catch(o){i([o],n)}for(var a in e)l.call(e,a)&&(t[a]=e[a]);return t}function a(e){return!(e&&e instanceof Function&&e.apply&&!e[p])}function c(e,t){var n=t(e);return n[p]=e,o(e,n,s),n}function f(e,t,n){var r=e[t];e[t]=c(r,n)}function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;++n)t[n]=arguments[n];return t}var s=e("ee"),d=e(7),p="nr@original",l=Object.prototype.hasOwnProperty,m=!1;t.exports=r,t.exports.wrapFunction=c,t.exports.wrapInPlace=f,t.exports.argsToArray=u},{}]},{},["loader"]);</script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-6242674-23"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-6242674-23', { 'optimize_id': 'GTM-T48MRN9'});
    </script>

    <title>Light Service</title>
<meta name="description" content="Series of Actions with an emphasis on simplicity.">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://awesomeopensource.com/project/adomokos/light-service">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

      /* copy template below */
      /* ------------------- */
      /* ----------------- */
      /* ----------------- */

      /*ipad and below */


      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {

      }

      /* end template copy */
      /* ----------------- */
      /* ----------------- */
      /* ----------------- */

      /*ipad and below */
      .show_on_phones {
        display: block;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .show_on_phones {
          display: none;
        }
      }

      .twenty_px_padding_top {
        padding-top: 20px;
      }

      /*ipad and below */
      .projects_category_explorer_left_column {
        max-width: 0;
        margin-right: 0;
        display: none;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .projects_category_explorer_left_column {
          min-width: 20%;
          margin-right: 5%;
          display: block;
        }
      }

      /*ipad and below */
      .projects_list_right_column {
        min-width: 100%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .projects_list_right_column {
          min-width: 75%;
        }
      }

      .display_flex {
        display: flex;
      }

      .margin_bottom_15 {
        margin-bottom: 15px;
      }

      /*ipad and below */
      .image-gallery-image {
        width: 100% !important;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .image-gallery-image {
          width: 1280px !important;
        }
      }

      /*ipad and below */
      .aos_sponsorship_link {
        font-size: 14px;
        font-weight: bold;
        color: blue;
        text-decoration: underline;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_sponsorship_link {
          font-size: 18px;
          font-weight: bold;
          color: blue;
          text-decoration: underline;
        }
      }

      /*ipad and below */
      .aos_desktop_right_ads_container {
        display: none;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_desktop_right_ads_container {
          display: block;
        }
      }

      /*ipad and below */
      .aos_project_screen_container {
        margin-left: 5%;
        margin-right: 5%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_screen_container {
          margin-left: 5%;
          margin-right: 0;
          display: flex;
        }
      }

      /*ipad and below */
      .aos_project_inner_screen_container {
        width: 100%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_inner_screen_container {
          width: 95%;
        }
      }

      /*ipad and below
      .aos_license_text_metadata {
        margin-top: 0 !important;
      }

      everything larger than ipad
      @media screen and (min-width: 1024px) {
        .aos_license_text_metadata {
          margin-top: 0 !important;
        }
      }*/

      /*ipad and below */
      .projects_list_ad_slot_1 {
        height: fit-content;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .projects_list_ad_slot_1 {
          height: fit-content;
        }
      }

      /*ipad and below */
      .projects_list_ad_slot_2 {
        height: fit-content;
        margin-top: -34px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .projects_list_ad_slot_2 {
          height: fit-content;
          margin-top: 0;
        }
      }

      /*ipad and below */
      .project_page_ad_slot_1 {
        display: block;
        height: fit-content;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .project_page_ad_slot_1 {
          display: block;
          height: fit-content;
        }
      }

      /*ipad and below */
      .project_page_ad_slot_2 {
        display: block;
        height: fit-content;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .project_page_ad_slot_2 {
          display: block;
          height: fit-content;
        }
      }

      /*ipad and below */
      .aos_category_explorer_category_container {
        background-color: white;
        padding: 10px;
        margin-bottom: 0px;
        border-bottom: 1px solid lightgray;
        border-left: 1px solid lightgray;
        border-right: 1px solid lightgray;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_category_explorer_category_container {
          background-color: white;
          padding: 10px;
          margin-bottom: 0px;
          border-bottom: 1px solid lightgray;
          border-left: 1px solid lightgray;
          border-right: 1px solid lightgray;
        }
      }

      .aos_category_explorer_category_container:first-child {
        border-top: 1px solid lightgray;
      }

      /*ipad and below */
      .aos_topic_count {
        font-size: 10px;
        color: #4f4f4f;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_topic_count {
          font-size: 16px;
          color: #4f4f4f;
        }
      }

      /*ipad and below */
      .aos_topic_icon {
        display: none;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_topic_icon {
          font-size: 14px;
          display: inline-block;
        }
      }

      /*ipad and below */
      .aos_project_count {
        color: #4f4f4f;
        font-size: 14px;
        font-weight: bold;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_count {
          font-size: 14px;
          font-weight: bold;
        }
      }

      /*ipad and below */
      .aos_project_star {
        font-size: 14px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_star {
          font-size: 14px;
          /*margin-right: 7px;*/
        }
      }

      /*ipad and below */
      .aos_project_metadata_trademark_notice {
        font-size: 8px;
        color: gray;
        margin-top: 10px;
        border-bottom: 1px solid lightgray;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_metadata_trademark_notice {
          font-size: 12px;
          color: gray;
          margin-top: 20px;
          border-bottom: 1px solid lightgray;
        }
      }

      /*ipad and below */
      .aos_project_metadata_description {
        margin-bottom: 10px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_metadata_description {
          margin-bottom: 5px;
        }
      }

      .aos_project_metadata {
        display: inline-block;
        margin-bottom: 10px;
        width: 100%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_metadata {
          display: inline-block;
          margin-bottom: 10px;
          width: 100%;
        }
      }

      /*ipad and below */
      .aos_project_metadata_content {
        /*border-bottom: 1px solid lightgray;*/
        font-size: 16px;
        color: #000000;
        font-weight: 300;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_metadata_content {
          /*border-bottom: 1px solid lightgray;*/
          font-size: 16px;
          color: #000000;
          font-weight: 300;
        }
      }

      /*ipad and below */
      .aos_project_metadata_header {
        color: #808080;
        margin-bottom: 10px;
        margin-top: 10px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_metadata_header {
          color: #808080;
          margin-bottom: 10px;
          margin-top: 10px;
          font-size: 16px;
        }
      }

      aos_project_metadata_header:hover {
        color: #808080;
      }

      /*ipad and below */
      .aos_project_metadata_title {
        font-size: 20px;
        margin-bottom: 5px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_metadata_title {
          font-size: 30px;
          margin-bottom: 10px;
        }
      }

      /*ipad and below */
      .aos_app_container {
        display: flex;
        flex-direction: row;
        width: 100%;
        margin-bottom: 2px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_app_container {
          display: flex;
          flex-direction: row;
          width: 100%;
          margin-bottom: 0;
        }
      }

      @media screen and (min-width: 1025px) {
        .aos_desktop_ad_spacer {
          margin-top: 5px;
          margin-bottom: 5px;
        }
      }

      /*ipad and below */
      .aos_show_ad_on_mobile {
        display: none;
      }

      @media screen and (max-width: 1024px) {
        .aos_show_ad_on_mobile {
          /*display: inline-block;*/
          display: block; /*adsense recommended*/
        }
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1025px) {
        .aos_show_ad_on_desktop {
          /*display: inline-block;*/
          display: block; /*adsense recommended*/
        }
      }

      /*ipad and below */
      @media screen and (max-width: 1024px) {
        .aos_show_ad_on_desktop {
          display: none;
        }
      }

      /*ipad and below */
      .aos_filter_topics_input {
        font-size: 16px;
        padding: 10px;
        border: 1px solid lightgray;
        background-color: white;
        border-radius: 10px;
        box-shadow: 1px 1px 5px lightgrey;
        margin-bottom: 20px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_filter_topics_input {
          font-size: 20px;
          padding: 10px;
          border: 1px solid lightgray;
          background-color: white;
          border-radius: 10px;
          box-shadow: 1px 1px 5px lightgrey;
          margin-bottom: 20px;
        }
      }

      /* ipad and below */
      .aos_topics_project {
        font-family: helvetica, arial, sans-serif;
        font-size: 12px;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        width: 100%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_topics_project {
          font-family: helvetica, arial, sans-serif;
          margin-bottom: 0;
          font-size: 20px;
          border-radius: 10px;
          padding: 0;
          display: flex;
          flex-direction: column;
          align-items: flex-start;
          width: 100%;
        }
      }

      /* ipad and below
      .aos_topics_sidebar {
        font-family: helvetica, arial, sans-serif;
        font-size: 12px;
        margin-left: 2%;
        margin-right: 2%;
        width: 94%;
        padding: 0;
        display: flex;
        flex-direction: column;
      }

       everything larger than ipad
      @media screen and (min-width: 1024px) {
        .aos_topics_sidebar {
          font-family: helvetica, arial, sans-serif;
          margin-left: 5%;
          margin-right: 2%;
          width: 30%;
          margin-bottom: 0;
          font-size: 20px;
          border-radius: 10px;
          padding: 0;
          display: flex;
          flex-direction: column;
        }
      }*/

      /*ipad and below */
      .aos_pill_box {
        display: flex;
        color: black;
        border-radius: 5px;
        padding: 2px;
        margin: 2px;
        align-items: center;
        border-color: black;
        background-color: white;
        font-size: 12px;
        border: 1px solid black;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_pill_box {
          display: flex;
          color: black;
          border-radius: 5px;
          padding: 5px;
          margin: 10px;
          align-items: center;
          border: 0;
          background-color: white;
          box-shadow: 1px 1px 10px 1px rgba(0,0,0,0.25);
          font-size: 16px;
        }
      }

      /*ipad and below */
      .aos_selected_topics_text_container {
        display: none;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_selected_topics_text_container {
          margin-left: 25px;
          margin-right: 10px;
          margin-bottom: 10px;
          margin-top: 10px;
          padding: 5px;
          font-weight: bold;
          font-size: 20px;
          white-space: nowrap;
          display: inline-block;
        }
      }

      /*ipad and below */
      .aos_pagenavigator_links_container {
        display: flex;
        justify-content: space-around;
        font-size: 12px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_pagenavigator_links_container {
          display: flex;
          justify-content: space-around;
          font-size: 16px;
        }
      }

      /*ipad and below */
      .aos_project_container {
        padding-bottom: 20px;
        padding-left: 0;
        padding-right: 0;
        padding-top: 5px;
        width: 100%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_container {
          /*border-radius: 10px;*/
          padding-bottom: 20px;
          padding-left: 0;
          padding-right: 0;
          padding-top: 5px;
          width: 100%;
        }
      }

      /*ipad and below */
      .aos_project_description {
        font-size: 16px;
        width: 100%;
        font-weight: 300; /* match adsense */
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_description {
          font-size: 16px;
          font-weight: 300; /* match adsense */
        }
      }

      /*ipad and below */
      .aos_project_title {
        font-size: 20px;
        margin-bottom: 2px;
        font-weight: 400; /* match adsense */
        width: 100%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_project_title {
          font-size: 20px;
          margin-bottom: 2px;
          font-weight: 400; /* match adsense */
        }
      }

      .aos_project_title a :hover {
        text-decoration: none !important;
      }

      .aos_no_underline:hover {
        text-decoration: none !important;
      }

      .aos_grey_link:hover {
        color: #808080 !important;
      }

      .aos_grey_link {
        color: #808080 !important;
      }

      /*ipad and below */
      .category_topic_filter_container {
        width: 94%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .category_topic_filter_container {
          width: 94%;
        }
      }

      /*ipad and below */
      .aos_projects_container {
        font-family: helvetica, arial, sans-serif;
        margin-right: 2%;
        width: 96%; /* won't insert an ad this small (68%), but bigger and it overflows to the right with some topics that are long */
        font-size: 14px;
        margin-bottom: 5px;
        margin-left: 2%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_projects_container {
          font-family: helvetica, arial, sans-serif;
          margin-right: 0;
          width: 90%; /* was 53 before removing right margin spacer / ad container */
          font-size: 18px;
          margin-bottom: 5px;
          min-width: 800px;
          margin-left: 5%;
        }
      }

      /*ipad and below */
      .aos_pagenavigator_container {
        display: flex;
        justify-content: center;
        font-size: 9px;
        margin-bottom: 0;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_pagenavigator_container {
          display: flex;
          justify-content: center;
          font-size: 16px;
          margin-bottom: 10px;
        }
      }

      /*ipad and below */
      .aos_header_title_container_ipad_and_smaller {
        font-size: 12px;
        font-weight: bold;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 134px;
        white-space: nowrap;
        flex-direction: column;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_header_title_container_ipad_and_smaller {
          display: none;
        }
      }


      /*ipad and below */
      .aos_header_title_container_larger_than_ipad {
        display: none;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_header_title_container_larger_than_ipad {
          display: block;
        }
      }

      /*ipad and below */
      .aos_logo_image {
        height: 25px;
        width: 25px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_logo_image {
          height: 50px;
          width: 50px;
        }
      }

      /*ipad and below */
      .aos_fixed_footer_container {
        display: flex;
        margin-left: 0;
        margin-right: 0;
        margin-top: 2px;
        width: 100%;
        justify-content: center;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_fixed_footer_container {
          display: flex;
          margin-left: 5%;
          margin-right: 20%;
          margin-top: 5px;
          margin-bottom: 5px;
          width: 75%;
          justify-content: center;
        }
      }

      /*ipad and below */
      .aos_fixed_header_container {
        margin-left: 2%;
        margin-right: 2%;
        margin-top: 4px;
        margin-bottom: 2px;
        width: 96%;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_fixed_header_container {
          margin-left: 5%;
          margin-right: 20%;
          margin-top: 5px;
          margin-bottom: 5px;
          width: 75%;
        }
      }

      /*ipad and below */
      body {
        margin-top: 0;
        margin-right: 0;
        margin-bottom: 0;
        margin-left: 0;
        padding: 0
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        body {
          margin-top: 0;
          margin-right: 0;
          margin-bottom: 0;
          margin-left: 0;
          padding: 0
        }
      }

      /* ipad and below */
      .aos_topics_sidebar_link {
        width: 100%;
        margin-bottom: 10px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 14px;
      }

      /* everything larger than ipad */
      @media screen and (min-width: 1024px) {
        .aos_topics_sidebar_link {
          width: 100%;
          margin-bottom: 10px;
          font-size: 18px;
        }
      }

      html {
        margin: 0;
        padding: 0
      }

      a {
        color: #000000;
        text-decoration: none;
      }

      a:visited {
        text-decoration: none;
      }

      a:hover {
        /*color: #0366d6;*/
        color: #000000; /* match adsense */
        text-decoration: underline;
      }

      .AOS_Pill:hover {
        text-decoration: none;
      }

      /* MIT licensed github-markdown.css */
      /* https://github.com/sindresorhus/github-markdown-css */
      @font-face {
        font-family: octicons-link;
        src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
      }
      .markdown-body {
        -ms-text-size-adjust: 100%;
        -webkit-text-size-adjust: 100%;
        line-height: 1.5;
        color: #24292e;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        font-size: 16px;
        line-height: 1.5;
        word-wrap: break-word;
      }
      .markdown-body .pl-c {
        color: #6a737d;
      }
      .markdown-body .pl-c1,
      .markdown-body .pl-s .pl-v {
        color: #005cc5;
      }
      .markdown-body .pl-e,
      .markdown-body .pl-en {
        color: #6f42c1;
      }
      .markdown-body .pl-smi,
      .markdown-body .pl-s .pl-s1 {
        color: #24292e;
      }
      .markdown-body .pl-ent {
        color: #22863a;
      }
      .markdown-body .pl-k {
        color: #d73a49;
      }
      .markdown-body .pl-s,
      .markdown-body .pl-pds,
      .markdown-body .pl-s .pl-pse .pl-s1,
      .markdown-body .pl-sr,
      .markdown-body .pl-sr .pl-cce,
      .markdown-body .pl-sr .pl-sre,
      .markdown-body .pl-sr .pl-sra {
        color: #032f62;
      }
      .markdown-body .pl-v,
      .markdown-body .pl-smw {
        color: #e36209;
      }
      .markdown-body .pl-bu {
        color: #b31d28;
      }
      .markdown-body .pl-ii {
        color: #fafbfc;
        background-color: #b31d28;
      }
      .markdown-body .pl-c2 {
        color: #fafbfc;
        background-color: #d73a49;
      }
      .markdown-body .pl-c2::before {
        content: "^M";
      }
      .markdown-body .pl-sr .pl-cce {
        font-weight: bold;
        color: #22863a;
      }
      .markdown-body .pl-ml {
        color: #735c0f;
      }
      .markdown-body .pl-mh,
      .markdown-body .pl-mh .pl-en,
      .markdown-body .pl-ms {
        font-weight: bold;
        color: #005cc5;
      }
      .markdown-body .pl-mi {
        font-style: italic;
        color: #24292e;
      }
      .markdown-body .pl-mb {
        font-weight: bold;
        color: #24292e;
      }
      .markdown-body .pl-md {
        color: #b31d28;
        background-color: #ffeef0;
      }
      .markdown-body .pl-mi1 {
        color: #22863a;
        background-color: #f0fff4;
      }
      .markdown-body .pl-mc {
        color: #e36209;
        background-color: #ffebda;
      }
      .markdown-body .pl-mi2 {
        color: #f6f8fa;
        background-color: #005cc5;
      }
      .markdown-body .pl-mdr {
        font-weight: bold;
        color: #6f42c1;
      }
      .markdown-body .pl-ba {
        color: #586069;
      }
      .markdown-body .pl-sg {
        color: #959da5;
      }
      .markdown-body .pl-corl {
        text-decoration: underline;
        color: #032f62;
      }
      .markdown-body .octicon {
        display: inline-block;
        vertical-align: text-top;
        fill: currentColor;
      }
      .markdown-body a {
        background-color: transparent;
      }
      .markdown-body a:active,
      .markdown-body a:hover {
        outline-width: 0;
      }
      .markdown-body strong {
        font-weight: inherit;
      }
      .markdown-body strong {
        font-weight: bolder;
      }
      .markdown-body h1 {
        font-size: 2em;
        margin: 0.67em 0;
      }
      .markdown-body img {
        border-style: none;
      }
      .markdown-body code,
      .markdown-body kbd,
      .markdown-body pre {
        font-family: monospace, monospace;
        font-size: 1em;
      }
      .markdown-body hr {
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }
      .markdown-body input {
        font: inherit;
        margin: 0;
      }
      .markdown-body input {
        overflow: visible;
      }
      .markdown-body [type="checkbox"] {
        box-sizing: border-box;
        padding: 0;
      }
      .markdown-body * {
        box-sizing: border-box;
      }
      .markdown-body input {
        font-family: inherit;
        font-size: inherit;
        line-height: inherit;
      }
      .markdown-body a {
        color: #0366d6;
        text-decoration: none;
      }
      .markdown-body a:hover {
        text-decoration: underline;
      }
      .markdown-body strong {
        font-weight: 600;
      }
      .markdown-body hr {
        height: 0;
        margin: 15px 0;
        overflow: hidden;
        background: transparent;
        border: 0;
        border-bottom: 1px solid #dfe2e5;
      }
      .markdown-body hr::before {
        display: table;
        content: "";
      }
      .markdown-body hr::after {
        display: table;
        clear: both;
        content: "";
      }
      .markdown-body table {
        border-spacing: 0;
        border-collapse: collapse;
      }
      .markdown-body td,
      .markdown-body th {
        padding: 0;
      }
      .markdown-body h1,
      .markdown-body h2,
      .markdown-body h3,
      .markdown-body h4,
      .markdown-body h5,
      .markdown-body h6 {
        margin-top: 0;
        margin-bottom: 0;
      }
      .markdown-body h1 {
        font-size: 32px;
        font-weight: 600;
      }
      .markdown-body h2 {
        font-size: 24px;
        font-weight: 600;
      }
      .markdown-body h3 {
        font-size: 20px;
        font-weight: 600;
      }
      .markdown-body h4 {
        font-size: 16px;
        font-weight: 600;
      }
      .markdown-body h5 {
        font-size: 14px;
        font-weight: 600;
      }
      .markdown-body h6 {
        font-size: 12px;
        font-weight: 600;
      }
      .markdown-body p {
        margin-top: 0;
        margin-bottom: 10px;
      }
      .markdown-body blockquote {
        margin: 0;
      }
      .markdown-body ul,
      .markdown-body ol {
        padding-left: 0;
        margin-top: 0;
        margin-bottom: 0;
      }
      .markdown-body ol ol,
      .markdown-body ul ol {
        list-style-type: lower-roman;
      }
      .markdown-body ul ul ol,
      .markdown-body ul ol ol,
      .markdown-body ol ul ol,
      .markdown-body ol ol ol {
        list-style-type: lower-alpha;
      }
      .markdown-body dd {
        margin-left: 0;
      }
      .markdown-body code {
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        font-size: 12px;
      }
      .markdown-body pre {
        margin-top: 0;
        margin-bottom: 0;
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        font-size: 12px;
      }
      .markdown-body .octicon {
        vertical-align: text-bottom;
      }
      .markdown-body .pl-0 {
        padding-left: 0 !important;
      }
      .markdown-body .pl-1 {
        padding-left: 4px !important;
      }
      .markdown-body .pl-2 {
        padding-left: 8px !important;
      }
      .markdown-body .pl-3 {
        padding-left: 16px !important;
      }
      .markdown-body .pl-4 {
        padding-left: 24px !important;
      }
      .markdown-body .pl-5 {
        padding-left: 32px !important;
      }
      .markdown-body .pl-6 {
        padding-left: 40px !important;
      }
      .markdown-body::before {
        display: table;
        content: "";
      }
      .markdown-body::after {
        display: table;
        clear: both;
        content: "";
      }
      .markdown-body>*:first-child {
        margin-top: 0 !important;
      }
      .markdown-body>*:last-child {
        margin-bottom: 0 !important;
      }
      .markdown-body a:not([href]) {
        color: inherit;
        text-decoration: none;
      }
      .markdown-body .anchor {
        float: left;
        padding-right: 4px;
        margin-left: -20px;
        line-height: 1;
      }
      .markdown-body .anchor:focus {
        outline: none;
      }
      .markdown-body p,
      .markdown-body blockquote,
      .markdown-body ul,
      .markdown-body ol,
      .markdown-body dl,
      .markdown-body table,
      .markdown-body pre {
        margin-top: 0;
        margin-bottom: 16px;
      }
      .markdown-body hr {
        height: 0.25em;
        padding: 0;
        margin: 24px 0;
        background-color: #e1e4e8;
        border: 0;
      }
      .markdown-body blockquote {
        padding: 0 1em;
        color: #6a737d;
        border-left: 0.25em solid #dfe2e5;
      }
      .markdown-body blockquote>:first-child {
        margin-top: 0;
      }
      .markdown-body blockquote>:last-child {
        margin-bottom: 0;
      }
      .markdown-body kbd {
        display: inline-block;
        padding: 3px 5px;
        font-size: 11px;
        line-height: 10px;
        color: #444d56;
        vertical-align: middle;
        background-color: #fafbfc;
        border: solid 1px #c6cbd1;
        border-bottom-color: #959da5;
        border-radius: 3px;
        box-shadow: inset 0 -1px 0 #959da5;
      }
      .markdown-body h1,
      .markdown-body h2,
      .markdown-body h3,
      .markdown-body h4,
      .markdown-body h5,
      .markdown-body h6 {
        margin-top: 24px;
        margin-bottom: 16px;
        font-weight: 600;
        line-height: 1.25;
      }
      .markdown-body h1 .octicon-link,
      .markdown-body h2 .octicon-link,
      .markdown-body h3 .octicon-link,
      .markdown-body h4 .octicon-link,
      .markdown-body h5 .octicon-link,
      .markdown-body h6 .octicon-link {
        color: #1b1f23;
        vertical-align: middle;
        visibility: hidden;
      }
      .markdown-body h1:hover .anchor,
      .markdown-body h2:hover .anchor,
      .markdown-body h3:hover .anchor,
      .markdown-body h4:hover .anchor,
      .markdown-body h5:hover .anchor,
      .markdown-body h6:hover .anchor {
        text-decoration: none;
      }
      .markdown-body h1:hover .anchor .octicon-link,
      .markdown-body h2:hover .anchor .octicon-link,
      .markdown-body h3:hover .anchor .octicon-link,
      .markdown-body h4:hover .anchor .octicon-link,
      .markdown-body h5:hover .anchor .octicon-link,
      .markdown-body h6:hover .anchor .octicon-link {
        visibility: visible;
      }
      .markdown-body h1 {
        padding-bottom: 0.3em;
        font-size: 2em;
        border-bottom: 1px solid #eaecef;
      }
      .markdown-body h2 {
        padding-bottom: 0.3em;
        font-size: 1.5em;
        border-bottom: 1px solid #eaecef;
      }
      .markdown-body h3 {
        font-size: 1.25em;
      }
      .markdown-body h4 {
        font-size: 1em;
      }
      .markdown-body h5 {
        font-size: 0.875em;
      }
      .markdown-body h6 {
        font-size: 0.85em;
        color: #6a737d;
      }
      .markdown-body ul,
      .markdown-body ol {
        padding-left: 2em;
      }
      .markdown-body ul ul,
      .markdown-body ul ol,
      .markdown-body ol ol,
      .markdown-body ol ul {
        margin-top: 0;
        margin-bottom: 0;
      }
      .markdown-body li {
        word-wrap: break-all;
      }
      .markdown-body li>p {
        margin-top: 16px;
      }
      .markdown-body li+li {
        margin-top: 0.25em;
      }
      .markdown-body dl {
        padding: 0;
      }
      .markdown-body dl dt {
        padding: 0;
        margin-top: 16px;
        font-size: 1em;
        font-style: italic;
        font-weight: 600;
      }
      .markdown-body dl dd {
        padding: 0 16px;
        margin-bottom: 16px;
      }
      .markdown-body table {
        display: block;
        width: 100%;
        overflow: auto;
      }
      .markdown-body table th {
        font-weight: 600;
      }
      .markdown-body table th,
      .markdown-body table td {
        padding: 6px 13px;
        border: 1px solid #dfe2e5;
      }
      .markdown-body table tr {
        background-color: #fff;
        border-top: 1px solid #c6cbd1;
      }
      .markdown-body table tr:nth-child(2n) {
        background-color: #f6f8fa;
      }
      .markdown-body img {
        max-width: 100%;
        box-sizing: content-box;
        background-color: #fff;
      }
      .markdown-body img[align=right] {
        padding-left: 20px;
      }
      .markdown-body img[align=left] {
        padding-right: 20px;
      }
      .markdown-body code {
        padding: 0.2em 0.4em;
        margin: 0;
        font-size: 85%;
        background-color: rgba(27,31,35,0.05);
        border-radius: 3px;
      }
      .markdown-body pre {
        word-wrap: normal;
      }
      .markdown-body pre>code {
        padding: 0;
        margin: 0;
        font-size: 100%;
        word-break: normal;
        white-space: pre;
        background: transparent;
        border: 0;
      }
      .markdown-body .highlight {
        margin-bottom: 16px;
      }
      .markdown-body .highlight pre {
        margin-bottom: 0;
        word-break: normal;
      }
      .markdown-body .highlight pre,
      .markdown-body pre {
        padding: 16px;
        overflow: auto;
        font-size: 85%;
        line-height: 1.45;
        background-color: #f6f8fa;
        border-radius: 3px;
      }
      .markdown-body pre code {
        display: inline;
        max-width: auto;
        padding: 0;
        margin: 0;
        overflow: visible;
        line-height: inherit;
        word-wrap: normal;
        background-color: transparent;
        border: 0;
      }
      .markdown-body .full-commit .btn-outline:not(:disabled):hover {
        color: #005cc5;
        border-color: #005cc5;
      }
      .markdown-body kbd {
        display: inline-block;
        padding: 3px 5px;
        font: 11px "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        line-height: 10px;
        color: #444d56;
        vertical-align: middle;
        background-color: #fafbfc;
        border: solid 1px #d1d5da;
        border-bottom-color: #c6cbd1;
        border-radius: 3px;
        box-shadow: inset 0 -1px 0 #c6cbd1;
      }
      .markdown-body :checked+.radio-label {
        position: relative;
        z-index: 1;
        border-color: #0366d6;
      }
      .markdown-body .task-list-item {
        list-style-type: none;
      }
      .markdown-body .task-list-item+.task-list-item {
        margin-top: 3px;
      }
      .markdown-body .task-list-item input {
        margin: 0 0.2em 0.25em -1.6em;
        vertical-align: middle;
      }
      .markdown-body hr {
        border-bottom-color: #eee;
      }
      /* github-markdown.css overrides */
      .markdown-body h2 {
        margin-bottom: 0;
        margin-top: 0;
      }

      .hll { background-color: #ffffcc }
      .c { color: #008000 } /* Comment */
      .err { border: 1px solid #FF0000 } /* Error */
      .k { color: #0000ff } /* Keyword */
      .cm { color: #008000 } /* Comment.Multiline */
      .cp { color: #0000ff } /* Comment.Preproc */
      .c1 { color: #008000 } /* Comment.Single */
      .cs { color: #008000 } /* Comment.Special */
      .ge { font-style: italic } /* Generic.Emph */
      .gh { font-weight: bold } /* Generic.Heading */
      .gp { font-weight: bold } /* Generic.Prompt */
      .gs { font-weight: bold } /* Generic.Strong */
      .gu { font-weight: bold } /* Generic.Subheading */
      .kc { color: #0000ff } /* Keyword.Constant */
      .kd { color: #0000ff } /* Keyword.Declaration */
      .kn { color: #0000ff } /* Keyword.Namespace */
      .kp { color: #0000ff } /* Keyword.Pseudo */
      .kr { color: #0000ff } /* Keyword.Reserved */
      .kt { color: #2b91af } /* Keyword.Type */
      .s { color: #a31515 } /* Literal.String */
      .nc { color: #2b91af } /* Name.Class */
      .ow { color: #0000ff } /* Operator.Word */
      .sb { color: #a31515 } /* Literal.String.Backtick */
      .sc { color: #a31515 } /* Literal.String.Char */
      .sd { color: #a31515 } /* Literal.String.Doc */
      .s2 { color: #a31515 } /* Literal.String.Double */
      .se { color: #a31515 } /* Literal.String.Escape */
      .sh { color: #a31515 } /* Literal.String.Heredoc */
      .si { color: #a31515 } /* Literal.String.Interpol */
      .sx { color: #a31515 } /* Literal.String.Other */
      .sr { color: #a31515 } /* Literal.String.Regex */
      .s1 { color: #a31515 } /* Literal.String.Single */
      .ss { color: #a31515 } /* Literal.String.Symbol */

    </style>

    <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Product",
  "name": "adomokos/light-service",
  "description": "Series of Actions with an emphasis on simplicity.",
  "url": "https://awesomeopensource.com/project/adomokos/light-service",
  "sku": "project/adomokos/light-service",
  "mpn": "project/adomokos/light-service",
  "image": "https://github.com/adomokos.png",
  "brand": {
    "@type": "Brand",
    "name": "adomokos/light-service",
    "logo": "https://github.com/adomokos.png"
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.61",
    "ratingCount": "525"
  }
}
</script>


    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="2bYsYaLvVo1XXy1+KVP5RaNvR3i6/iuzrMB1fAlURnTZRrwzqTTGHFhCYwqXs5mgfJIYE6ljIsupchXotLSsKA==" />
  <script async src='/cdn-cgi/bm/cv/669835187/api.js'></script></head>

  <body>
    <script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","rorVersion":"11.2.1","rorPro":false,"href":"http://awesomeopensource.com/project/adomokos/light-service","location":"/project/adomokos/light-service","scheme":"http","host":"awesomeopensource.com","port":null,"pathname":"/project/adomokos/light-service","search":null,"httpAcceptLanguage":null,"serverSide":false}</script>
<div id="Root-react-component-aaba4198-aa4e-4ad4-bfe0-0b9ee349e822"><div style="font-family:helvetica, arial, sans-serif" data-reactroot=""><div class="aos_fixed_header_container"><div class="display_flex margin_bottom_15"><div style="margin-right:1%;display:flex;align-items:center"><a href="https://awesomeopensource.com" title="Awesome Open Source Home" rel="canonical"><img src="https://awesomeopensource.com/awesome.gif" class="aos_logo_image"/></a></div><div class="aos_header_title_container_larger_than_ipad"><div style="white-space:nowrap;font-size:24px;font-weight:bold;display:flex;flex-direction:row;align-items:center;height:100%"><div>Awesome Open Source</div></div></div><div class="aos_header_title_container_ipad_and_smaller"><div>Awesome Open Source</div></div><div style="display:flex;flex-wrap:wrap"></div></div><div></div></div><div class="aos_project_screen_container"><div class="aos_project_inner_screen_container"><div class="aos_project_metadata"><div class="aos_project_metadata_title">Light <!-- -->Service</div><div class="aos_project_metadata_description">Series of Actions with an emphasis on simplicity.</div><div class="aos_project_metadata_header">Stars</div><span class="aos_project_metadata_content">525</span><div class="project_page_ad_slot_1"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-gv-v+1t-u+27" data-ad-client="ca-pub-1878397330895234" data-ad-slot="5649017589"></ins></div><div class="aos_project_metadata_header aos_license_text_metadata">License</div><span class="aos_project_metadata_content">mit</span><div class="aos_project_metadata_header"><a href="https://github.com/adomokos/light-service" target="_blank" class="aos_grey_link" rel="nofollow">Repository</a></div><span class="aos_project_metadata_content"><a href="https://github.com/adomokos/light-service" target="_blank">https://github.com/adomokos/light-service</a></span><div class="aos_project_metadata_header"><a href="https://github.com/adomokos/light-service/issues" target="_blank" class="aos_grey_link" rel="nofollow">Open Issues</a></div><span class="aos_project_metadata_content"><a href="https://github.com/adomokos/light-service/issues" target="_blank">11</a></span><div class="aos_project_metadata_header">Most Recent Commit</div><span class="aos_project_metadata_content">11 days ago</span><div class="aos_project_metadata_header">Related Projects</div><span class="aos_project_metadata_content"><a href="https://awesomeopensource.com/projects/ruby"><div style="display:block;text-decoration:none;padding-bottom:10px">ruby<span> (<!-- -->12,268<!-- -->)</span></div></a><a href="https://awesomeopensource.com/projects/workflow"><div style="display:block;text-decoration:none;padding-bottom:10px">workflow<span> (<!-- -->315<!-- -->)</span></div></a><a href="https://awesomeopensource.com/projects/aop"><div style="display:block;text-decoration:none;padding-bottom:10px">aop<span> (<!-- -->82<!-- -->)</span></div></a></span></div><div class="markdown-body"><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<p><a href="https://raw.githubusercontent.com/adomokos/light-service/master/resources/light-service.png" target="_blank" rel="nofollow"><img src="https://raw.githubusercontent.com/adomokos/light-service/master/resources/light-service.png" alt="LightService" style="max-width:100%;"></a></p>
<p><a href="https://rubygems.org/gems/light-service" rel="nofollow"><img src="https://img.shields.io/gem/v/light-service.svg" alt="Gem Version" style="max-width:100%;"></a>
<a href="http://travis-ci.org/adomokos/light-service" rel="nofollow"><img src="https://secure.travis-ci.org/adomokos/light-service.svg" alt="Build Status" style="max-width:100%;"></a>
<a href="https://codecov.io/gh/adomokos/light-service" rel="nofollow"><img src="https://codecov.io/gh/adomokos/light-service/branch/master/graph/badge.svg" alt="codecov" style="max-width:100%;"></a>
<a href="https://codeclimate.com/github/adomokos/light-service" rel="nofollow"><img src="https://codeclimate.com/github/adomokos/light-service.svg" alt="Code Climate" style="max-width:100%;"></a>
<a href="http://opensource.org/licenses/MIT" rel="nofollow"><img src="https://img.shields.io/badge/license-MIT-green.svg" alt="License" style="max-width:100%;"></a>
<a href="https://rubygems.org/gems/light-service" rel="nofollow"><img src="https://ruby-gem-downloads-badge.herokuapp.com/light-service?type=total" alt="Download Count" style="max-width:100%;"></a></p>
<br>
<p><a href="https://github.com/adomokos/light-service/blob/master/resources/orchestrators_deprecated.svg" target="_blank" rel="nofollow"><img src="https://raw.githubusercontent.com/adomokos/light-service/master/resources/orchestrators_deprecated.svg?sanitize=true" alt="Orchestrators-Deprecated" style="max-width:100%;"></a>
<br>Version 0.9.0 deprecates Orchestrators and moves all their functionalities into Organizers. Please check out <a href="https://github.com/adomokos/light-service/pull/132" rel="nofollow">this PR</a> to see the changes.</p>
<br>
<p>You can find the Python sibling project called <code>pyservice</code> <a href="https://github.com/adomokos/pyservice" rel="nofollow">here</a>.</p>
<br>
<h2>
<a id="table-of-content" class="anchor" href="#table-of-content" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Table of Content</h2>
<ul>
<li><a href="#why-lightservice">Why LightService?</a></li>
<li>
<a href="#getting-started">Getting Started</a>
<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#your-first-action">Your first action</a></li>
<li><a href="#your-first-organizer">Your first organizer</a></li>
</ul>
</li>
<li>
<a href="#stopping-the-series-of-actions">Stopping the Series of Actions</a>
<ul>
<li><a href="#failing-the-context">Failing the Context</a></li>
<li><a href="#skipping-the-rest-of-the-actions">Skipping the Rest of the Actions</a></li>
</ul>
</li>
<li><a href="#benchmarking-actions-with-around-advice">Benchmarking Actions with Around Advice</a></li>
<li><a href="#before-and-after-action-hooks">Before and After Action Hooks</a></li>
<li><a href="#key-aliases">Key Aliases</a></li>
<li><a href="#logging">Logging</a></li>
<li><a href="#error-codes">Error Codes</a></li>
<li><a href="#action-rollback">Action Rollback</a></li>
<li><a href="#localizing-messages">Localizing Messages</a></li>
<li><a href="#orchestrator-logic-in-organizers">Orchestrator Logic in Organizers</a></li>
<li><a href="#contextfactory-for-faster-action-testing">ContextFactory for Faster Action Testing</a></li>
<li><a href="#rails-support">Rails support</a></li>
</ul>
<h2>
<a id="why-lightservice" class="anchor" href="#why-lightservice" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Why LightService?</h2>
<p>What do you think of this code?</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">TaxController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">update</span>
    <span class="vi">@order</span> <span class="o">=</span> <span class="no">Order</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
    <span class="n">tax_ranges</span> <span class="o">=</span> <span class="no">TaxRange</span><span class="p">.</span><span class="nf">for_region</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="nf">region</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tax_ranges</span><span class="p">.</span><span class="nf">nil?</span>
      <span class="n">render</span> <span class="ss">:action</span> <span class="o">=&gt;</span> <span class="ss">:edit</span><span class="p">,</span> <span class="ss">:error</span> <span class="o">=&gt;</span> <span class="s2">"The tax ranges were not found"</span>
      <span class="k">return</span> <span class="c1"># Avoiding the double render error</span>
    <span class="k">end</span>

    <span class="n">tax_percentage</span> <span class="o">=</span> <span class="n">tax_ranges</span><span class="p">.</span><span class="nf">for_total</span><span class="p">(</span><span class="vi">@order</span><span class="p">.</span><span class="nf">total</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tax_percentage</span><span class="p">.</span><span class="nf">nil?</span>
      <span class="n">render</span> <span class="ss">:action</span> <span class="o">=&gt;</span> <span class="ss">:edit</span><span class="p">,</span> <span class="ss">:error</span> <span class="o">=&gt;</span> <span class="s2">"The tax percentage  was not found"</span>
      <span class="k">return</span> <span class="c1"># Avoiding the double render error</span>
    <span class="k">end</span>

    <span class="vi">@order</span><span class="p">.</span><span class="nf">tax</span> <span class="o">=</span> <span class="p">(</span><span class="vi">@order</span><span class="p">.</span><span class="nf">total</span> <span class="o">*</span> <span class="p">(</span><span class="n">tax_percentage</span><span class="o">/</span><span class="mi">100</span><span class="p">)).</span><span class="nf">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="vi">@order</span><span class="p">.</span><span class="nf">total_with_tax</span> <span class="o">&gt;</span> <span class="mi">200</span>
      <span class="vi">@order</span><span class="p">.</span><span class="nf">provide_free_shipping!</span>
    <span class="k">end</span>

    <span class="n">redirect_to</span> <span class="n">checkout_shipping_path</span><span class="p">(</span><span class="vi">@order</span><span class="p">),</span> <span class="ss">:notice</span> <span class="o">=&gt;</span> <span class="s2">"Tax was calculated successfully"</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>This controller violates <a href="http://en.wikipedia.org/wiki/Single_responsibility_principle" rel="nofollow">SRP</a> all over.
Also, imagine what it would take to test this beast.
You could move the tax_percentage finders and calculations into the tax model,
but then you'll make your model logic heavy.</p>
<p>This controller does 3 things in order:</p>
<ul>
<li>Looks up the tax percentage based on order total</li>
<li>Calculates the order tax</li>
<li>Provides free shipping if the total with tax is greater than $200</li>
</ul>
<p>The order of these tasks matters: you can't calculate the order tax without the percentage.
Wouldn't it be nice to see this instead?</p>
<pre lang="ruby" class="highlight-ruby"><span class="p">(</span>
  <span class="no">LooksUpTaxPercentage</span><span class="p">,</span>
  <span class="no">CalculatesOrderTax</span><span class="p">,</span>
  <span class="no">ProvidesFreeShipping</span>
<span class="p">)</span>
</pre>
<p>This block of code should tell you the "story" of what's going on in this workflow.
With the help of LightService you can write code this way. First you need an organizer object that sets up the actions in order
and executes them one-by-one. Then you need to create the actions with one method (that will do only one thing).</p>
<p>This is how the organizer and actions interact with each other:</p>
<p><a href="https://raw.githubusercontent.com/adomokos/light-service/master/resources/organizer_and_actions.png" target="_blank" rel="nofollow"><img src="https://raw.githubusercontent.com/adomokos/light-service/master/resources/organizer_and_actions.png" alt="LightService" style="max-width:100%;"></a></p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">CalculatesTax</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="n">with</span><span class="p">(</span><span class="ss">:order</span> <span class="o">=&gt;</span> <span class="n">order</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span>
        <span class="no">LooksUpTaxPercentageAction</span><span class="p">,</span>
        <span class="no">CalculatesOrderTaxAction</span><span class="p">,</span>
        <span class="no">ProvidesFreeShippingAction</span>
      <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">LooksUpTaxPercentageAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:order</span>
  <span class="n">promises</span> <span class="ss">:tax_percentage</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">tax_ranges</span> <span class="o">=</span> <span class="no">TaxRange</span><span class="p">.</span><span class="nf">for_region</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="nf">order</span><span class="p">.</span><span class="nf">region</span><span class="p">)</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">tax_percentage</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">next</span> <span class="n">context</span> <span class="k">if</span> <span class="n">object_is_nil?</span><span class="p">(</span><span class="n">tax_ranges</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="s1">'The tax ranges were not found'</span><span class="p">)</span>

    <span class="n">context</span><span class="p">.</span><span class="nf">tax_percentage</span> <span class="o">=</span> <span class="n">tax_ranges</span><span class="p">.</span><span class="nf">for_total</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="nf">order</span><span class="p">.</span><span class="nf">total</span><span class="p">)</span>

    <span class="k">next</span> <span class="n">context</span> <span class="k">if</span> <span class="n">object_is_nil?</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="nf">tax_percentage</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="s1">'The tax percentage was not found'</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">object_is_nil?</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">object</span><span class="p">.</span><span class="nf">nil?</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="k">return</span> <span class="kp">true</span>
    <span class="k">end</span>

    <span class="kp">false</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">CalculatesOrderTaxAction</span>
  <span class="kp">extend</span> <span class="o">::</span><span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:order</span><span class="p">,</span> <span class="ss">:tax_percentage</span>

  <span class="c1"># I am using ctx as an abbreviation for context</span>
  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">ctx</span><span class="o">|</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">order</span>
    <span class="n">order</span><span class="p">.</span><span class="nf">tax</span> <span class="o">=</span> <span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="nf">total</span> <span class="o">*</span> <span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="nf">tax_percentage</span><span class="o">/</span><span class="mi">100</span><span class="p">)).</span><span class="nf">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="k">end</span>

<span class="k">end</span>

<span class="k">class</span> <span class="nc">ProvidesFreeShippingAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:order</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">ctx</span><span class="o">|</span>
    <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">order</span><span class="p">.</span><span class="nf">total_with_tax</span> <span class="o">&gt;</span> <span class="mi">200</span>
      <span class="n">ctx</span><span class="p">.</span><span class="nf">order</span><span class="p">.</span><span class="nf">provide_free_shipping!</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>And with all that, your controller should be super simple:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">TaxController</span> <span class="o">&lt;</span> <span class="no">ApplicationContoller</span>
  <span class="k">def</span> <span class="nf">update</span>
    <span class="vi">@order</span> <span class="o">=</span> <span class="no">Order</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>

    <span class="n">service_result</span> <span class="o">=</span> <span class="no">CalculatesTax</span><span class="p">.</span><span class="nf">for_order</span><span class="p">(</span><span class="vi">@order</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">service_result</span><span class="p">.</span><span class="nf">failure?</span>
      <span class="n">render</span> <span class="ss">:action</span> <span class="o">=&gt;</span> <span class="ss">:edit</span><span class="p">,</span> <span class="ss">:error</span> <span class="o">=&gt;</span> <span class="n">service_result</span><span class="p">.</span><span class="nf">message</span>
    <span class="k">else</span>
      <span class="n">redirect_to</span> <span class="n">checkout_shipping_path</span><span class="p">(</span><span class="vi">@order</span><span class="p">),</span> <span class="ss">:notice</span> <span class="o">=&gt;</span> <span class="s2">"Tax was calculated successfully"</span>
    <span class="k">end</span>

  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>I gave a <a href="http://www.adomokos.com/2013/06/simple-and-elegant-rails-code-with.html" rel="nofollow">talk at RailsConf 2013</a> on
simple and elegant Rails code where I told the story of how LightService was extracted from the projects I had worked on.</p>
<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting started</h2>
<h3>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Requirements</h3>
<p>This gem requires ruby 2.x. Use of <a href="#rails-support">generators</a> requires Rails 5+ (tested on Rails 5.x &amp; 6.x only. Will probably work on
Rails versions as old as 3.2)</p>
<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h3>
<p>In your Gemfile:</p>
<pre lang="ruby" class="highlight-ruby"><span class="n">gem</span> <span class="s1">'light-service'</span>
</pre>
<p>And then</p>
<pre lang="shell" class="highlight-shell">bundle <span class="nb">install</span>
</pre>
<p>Or install it yourself as:</p>
<pre lang="shell" class="highlight-shell">gem <span class="nb">install </span>light-service
</pre>
<h3>
<a id="your-first-action" class="anchor" href="#your-first-action" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Your first action</h3>
<p>LightService's building blocks are actions that are normally composed within an organizer, but can be run independently.
Let's make a simple greeter action. Each action can take an optional list of expected inputs and promised outputs. If
these are specified and missing at action start and stop respectively, an exception will be thrown.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">GreetsPerson</span>
  <span class="kp">extend</span> <span class="o">::</span><span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

  <span class="n">expects</span> <span class="ss">:name</span>
  <span class="n">promises</span> <span class="ss">:greeting</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">greeting</span> <span class="o">=</span> <span class="s2">"Hey there, </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">. You enjoying LightService so far?"</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>When an action is run, you have access to its returned context, and the status of the action. You can invoke an
action by calling <code>.execute</code> on its class with <code>key: value</code> arguments, and inspect its status and context like so:</p>
<pre lang="ruby" class="highlight-ruby"><span class="n">outcome</span> <span class="o">=</span> <span class="no">GreetsPerson</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Han"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">outcome</span><span class="p">.</span><span class="nf">success?</span>
  <span class="nb">puts</span> <span class="n">outcome</span><span class="p">.</span><span class="nf">greeting</span> <span class="c1"># which was a promised context value</span>
<span class="k">elsif</span> <span class="n">outcome</span><span class="p">.</span><span class="nf">failure?</span>
  <span class="nb">puts</span> <span class="s2">"Rats... I can't say hello to you"</span>
<span class="k">end</span>
</pre>
<p>You will notice that actions are set up to promote simplicity, i.e. they either succeed or fail, and they have
very clear inputs and outputs. Ideally, they should do <a href="https://en.wikipedia.org/wiki/Single-responsibility_principle" rel="nofollow">exactly one thing</a>. This makes them as easy to test as unit tests.</p>
<h3>
<a id="your-first-organizer" class="anchor" href="#your-first-organizer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Your first organizer</h3>
<p>LightService provides a facility to compose actions using organizers. This is great when you have a business process
to execute that has multiple steps. By composing actions that do exactly one thing, you can sequence simple
actions together to perform complex multi-step business processes in a clear manner that is very easy
to reason about.</p>
<p>There are advanced ways to sequence actions that can be found later in the README, but we'll keep this simple for now.
First, let's add a second action that we can sequence to run after the <code>GreetsPerson</code> action from above:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">RandomlyAwardsPrize</span>
  <span class="kp">extend</span> <span class="o">::</span><span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

  <span class="n">expects</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:greeting</span>
  <span class="n">promises</span> <span class="ss">:did_i_win</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">prize_num</span>  <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">context</span><span class="p">.</span><span class="nf">name</span><span class="si">}</span><span class="s2">__</span><span class="si">#{</span><span class="n">context</span><span class="p">.</span><span class="nf">greeting</span><span class="si">}</span><span class="s2">"</span><span class="p">.</span><span class="nf">length</span>
    <span class="n">prizes</span>     <span class="o">=</span> <span class="p">[</span><span class="s2">"jelly beans"</span><span class="p">,</span> <span class="s2">"ice cream"</span><span class="p">,</span> <span class="s2">"pie"</span><span class="p">]</span>
    <span class="n">did_i_win</span>  <span class="o">=</span> <span class="nb">rand</span><span class="p">((</span><span class="mi">1</span><span class="o">..</span><span class="n">prize_num</span><span class="p">))</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">did_i_lose</span> <span class="o">=</span> <span class="nb">rand</span><span class="p">((</span><span class="mi">1</span><span class="o">..</span><span class="n">prize_num</span><span class="p">))</span> <span class="o">%</span> <span class="mi">13</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">did_i_lose</span>
      <span class="c1"># When failing, send a message as an argument, readable from the return context</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span><span class="p">(</span><span class="s2">"you are exceptionally unlucky"</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="c1"># You can specify 'optional' context items by treating context like a hash.</span>
      <span class="c1"># Useful for when you may or may not be returning extra data. Ideally, selecting</span>
      <span class="c1"># a prize should be a separate action that is only run if you win.</span>
      <span class="n">context</span><span class="p">[</span><span class="ss">:prize</span><span class="p">]</span>   <span class="o">=</span> <span class="s2">"lifetime supply of </span><span class="si">#{</span><span class="n">prizes</span><span class="p">.</span><span class="nf">sample</span><span class="si">}</span><span class="s2">"</span> <span class="k">if</span> <span class="n">did_i_win</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">did_i_win</span> <span class="o">=</span> <span class="n">did_i_win</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>And here's the organizer that ties the two together. You implement a <code>call</code> class method that takes some arguments and
from there sends them to <code>with</code> in <code>key: value</code> format which forms the initial state of the context. From there, chain
<code>reduce</code> to <code>with</code> and send it a list of action class names in sequence. The organizer will call each action, one
after the other, and build up the context as it goes along.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">WelcomeAPotentiallyLuckyPerson</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
    <span class="n">with</span><span class="p">(</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="nb">name</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span><span class="no">GreetsPerson</span><span class="p">,</span> <span class="no">RandomlyAwardsPrize</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>When an organizer is run, you have access to the context as it passed through all actions, and the overall status
of the organized execution. You can invoke an organizer by calling <code>.call</code> on the class with the expected arguments,
and inspect its status and context just like you would an action:</p>
<pre lang="ruby" class="highlight-ruby"><span class="n">outcome</span> <span class="o">=</span> <span class="no">WelcomeAPotentiallyLuckyPerson</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="s2">"Han"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">outcome</span><span class="p">.</span><span class="nf">success?</span>
  <span class="nb">puts</span> <span class="n">outcome</span><span class="p">.</span><span class="nf">greeting</span> <span class="c1"># which was a promised context value</span>

  <span class="k">if</span> <span class="n">outcome</span><span class="p">.</span><span class="nf">did_i_win</span>
    <span class="nb">puts</span> <span class="s2">"And you've won a prize! Lucky you. Please see the front desk for your </span><span class="si">#{</span><span class="n">outcome</span><span class="p">.</span><span class="nf">prize</span><span class="si">}</span><span class="s2">."</span>
  <span class="k">end</span>
<span class="k">else</span> <span class="c1"># outcome.failure? is true, and we can pull the failure message out of the context for feedback to the user.</span>
  <span class="nb">puts</span> <span class="s2">"Rats... I can't say hello to you, because </span><span class="si">#{</span><span class="n">outcome</span><span class="p">.</span><span class="nf">message</span><span class="si">}</span><span class="s2">."</span>
<span class="k">end</span>
</pre>
<p>Because organizers generally run through complex business logic, and every action has the potential to cause a failure,
testing an organizer is functionally equivalent to an integration test.</p>
<p>For further examples, please visit the project's <a href="https://github.com/adomokos/light-service/wiki" rel="nofollow">Wiki</a> and review
the <a href="#why-lightservice">"Why LightService" section</a> above.</p>
<h2>
<a id="stopping-the-series-of-actions" class="anchor" href="#stopping-the-series-of-actions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Stopping the Series of Actions</h2>
<p>When nothing unexpected happens during the organizer's call, the returned <code>context</code> will be successful. Here is how you can check for this:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">SomeController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">index</span>
    <span class="n">result_context</span> <span class="o">=</span> <span class="no">SomeOrganizer</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">current_user</span><span class="p">.</span><span class="nf">id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result_context</span><span class="p">.</span><span class="nf">success?</span>
      <span class="n">redirect_to</span> <span class="n">foo_path</span><span class="p">,</span> <span class="ss">:notice</span> <span class="o">=&gt;</span> <span class="s2">"Everything went OK! Thanks!"</span>
    <span class="k">else</span>
      <span class="n">flash</span><span class="p">[</span><span class="ss">:error</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_context</span><span class="p">.</span><span class="nf">message</span>
      <span class="n">render</span> <span class="ss">:action</span> <span class="o">=&gt;</span> <span class="s2">"new"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>However, sometimes not everything will play out as you expect it. An external API call might not be available or some complex business logic will need to stop the processing of the Series of Actions.
You have two options to stop the call chain:</p>
<ol>
<li>Failing the context</li>
<li>Skipping the rest of the actions</li>
</ol>
<h3>
<a id="failing-the-context" class="anchor" href="#failing-the-context" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Failing the Context</h3>
<p>When something goes wrong in an action and you want to halt the chain, you need to call <code>fail!</code> on the context object. This will push the context in a failure state (<code>context.failure? # will evalute to true</code>).
The context's <code>fail!</code> method can take an optional message argument, this message might help describing what went wrong.
In case you need to return immediately from the point of failure, you have to do that by calling <code>next context</code>.</p>
<p>In case you want to fail the context and stop the execution of the executed block, use the <code>fail_and_return!('something went wrong')</code> method.
This will immediately leave the block, you don't need to call <code>next context</code> to return from the block.</p>
<p>Here is an example:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">SubmitsOrderAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:order</span><span class="p">,</span> <span class="ss">:mailer</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="k">unless</span> <span class="n">context</span><span class="p">.</span><span class="nf">order</span><span class="p">.</span><span class="nf">submit_order_successful?</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">fail_and_return!</span><span class="p">(</span><span class="s2">"Failed to submit the order"</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="c1"># This won't be executed</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">mailer</span><span class="p">.</span><span class="nf">send_order_notification!</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p><a href="https://raw.githubusercontent.com/adomokos/light-service/master/resources/fail_actions.png" target="_blank" rel="nofollow"><img src="https://raw.githubusercontent.com/adomokos/light-service/master/resources/fail_actions.png" alt="fail-actions" style="max-width:100%;"></a></p>
<p>In the example above the organizer called 4 actions. The first 2 actions got executed successfully. The 3rd had a failure, that pushed the context into a failure state and the 4th action was skipped.</p>
<h3>
<a id="skipping-the-rest-of-the-actions" class="anchor" href="#skipping-the-rest-of-the-actions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Skipping the rest of the actions</h3>
<p>You can skip the rest of the actions by calling <code>context.skip_remaining!</code>. This behaves very similarly to the above-mentioned <code>fail!</code> mechanism, except this will not push the context into a failure state.
A good use case for this is executing the first couple of action and based on a check you might not need to execute the rest.
Here is an example of how you do it:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">ChecksOrderStatusAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:order</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="k">if</span> <span class="n">context</span><span class="p">.</span><span class="nf">order</span><span class="p">.</span><span class="nf">send_notification?</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">skip_remaining!</span><span class="p">(</span><span class="s2">"Everything is good, no need to execute the rest of the actions"</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p><a href="https://raw.githubusercontent.com/adomokos/light-service/master/resources/skip_actions.png" target="_blank" rel="nofollow"><img src="https://raw.githubusercontent.com/adomokos/light-service/master/resources/skip_actions.png" alt="skip-actions" style="max-width:100%;"></a></p>
<p>In the example above the organizer called 4 actions. The first 2 actions got executed successfully. The 3rd decided to skip the rest, the 4th action was not invoked. The context was successful.</p>
<h2>
<a id="benchmarking-actions-with-around-advice" class="anchor" href="#benchmarking-actions-with-around-advice" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Benchmarking Actions with Around Advice</h2>
<p>Benchmarking your action is needed when you profile the series of actions. You could add benchmarking logic to each and every action, however, that would blur the business logic you have in your actions.</p>
<p>Take advantage of the organizer's <code>around_each</code> method, which wraps the action calls as its reducing them in order.</p>
<p>Check out this example:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">LogDuration</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">yield</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="no">LightService</span><span class="o">::</span><span class="no">Configuration</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span>
      <span class="ss">:action</span>   <span class="o">=&gt;</span> <span class="n">context</span><span class="p">.</span><span class="nf">current_action</span><span class="p">,</span>
      <span class="ss">:duration</span> <span class="o">=&gt;</span> <span class="n">duration</span>
    <span class="p">)</span>

    <span class="n">result</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">CalculatesTax</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="n">with</span><span class="p">(</span><span class="ss">:order</span> <span class="o">=&gt;</span> <span class="n">order</span><span class="p">).</span><span class="nf">around_each</span><span class="p">(</span><span class="no">LogDuration</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span>
        <span class="no">LooksUpTaxPercentageAction</span><span class="p">,</span>
        <span class="no">CalculatesOrderTaxAction</span><span class="p">,</span>
        <span class="no">ProvidesFreeShippingAction</span>
      <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>Any object passed into <code>around_each</code> must respond to #call with two arguments: the action name and the context it will execute with. It is also passed a block, where LightService's action execution will be done in, so the result must be returned. While this is a little work, it also gives you before and after state access to the data for any auditing and/or checks you may need to accomplish.</p>
<h2>
<a id="before-and-after-action-hooks" class="anchor" href="#before-and-after-action-hooks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Before and After Action Hooks</h2>
<p>In case you need to inject code right before and after the actions are executed, you can use the <code>before_actions</code> and <code>after_actions</code> hooks. It accepts one or multiple lambdas that the Action implementation will invoke. This addition to LightService is a great way to decouple instrumentation from business logic.</p>
<p>Consider this code:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">SomeOrganizer</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
    <span class="n">with</span><span class="p">(</span><span class="n">ctx</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">actions</span>
    <span class="p">[</span>
      <span class="no">OneAction</span><span class="p">,</span>
      <span class="no">TwoAction</span><span class="p">,</span>
      <span class="no">ThreeAction</span>
    <span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">TwoAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:user</span><span class="p">,</span> <span class="ss">:logger</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">ctx</span><span class="o">|</span>
    <span class="c1"># Logging information</span>
    <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">role</span> <span class="o">==</span> <span class="s1">'admin'</span>
       <span class="n">ctx</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s1">'admin is doing something'</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="n">ctx</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">do_something</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>The logging logic makes <code>TwoAction</code> more complex, there is more code for logging than for business logic.</p>
<p>You have two options to decouple instrumentation from real logic with <code>before_actions</code> and <code>after_actions</code> hooks:</p>
<ol>
<li>Declare your hooks in the Organizer</li>
<li>Attach hooks to the Organizer from the outside</li>
</ol>
<p>This is how you can declaratively add before and after hooks to the Organizer:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">SomeOrganizer</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>
  <span class="n">before_actions</span> <span class="p">(</span><span class="nb">lambda</span> <span class="k">do</span> <span class="o">|</span><span class="n">ctx</span><span class="o">|</span>
                           <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">current_action</span> <span class="o">==</span> <span class="no">TwoAction</span>
                             <span class="k">return</span> <span class="k">unless</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">role</span> <span class="o">==</span> <span class="s1">'admin'</span>
                             <span class="n">ctx</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s1">'admin is doing something'</span><span class="p">)</span>
                           <span class="k">end</span>
                         <span class="k">end</span><span class="p">)</span>
  <span class="n">after_actions</span> <span class="p">(</span><span class="nb">lambda</span> <span class="k">do</span> <span class="o">|</span><span class="n">ctx</span><span class="o">|</span>
                          <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">current_action</span> <span class="o">==</span> <span class="no">TwoAction</span>
                            <span class="k">return</span> <span class="k">unless</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">role</span> <span class="o">==</span> <span class="s1">'admin'</span>
                            <span class="n">ctx</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s1">'admin is DONE doing something'</span><span class="p">)</span>
                          <span class="k">end</span>
                        <span class="k">end</span><span class="p">)</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
    <span class="n">with</span><span class="p">(</span><span class="n">ctx</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">actions</span>
    <span class="p">[</span>
      <span class="no">OneAction</span><span class="p">,</span>
      <span class="no">TwoAction</span><span class="p">,</span>
      <span class="no">ThreeAction</span>
    <span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">TwoAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:user</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">ctx</span><span class="o">|</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">do_something</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>Note how the action has no logging logic after this change. Also, you can target before and after action logic for specific actions, as the <code>ctx.current_action</code> will have the class name of the currently processed action. In the example above, logging will occur only for <code>TwoAction</code> and not for <code>OneAction</code> or <code>ThreeAction</code>.</p>
<p>Here is how you can declaratively add <code>before_hooks</code> or <code>after_hooks</code> to your Organizer from the outside:</p>
<pre lang="ruby" class="highlight-ruby"><span class="no">SomeOrganizer</span><span class="p">.</span><span class="nf">before_actions</span> <span class="o">=</span>
  <span class="nb">lambda</span> <span class="k">do</span> <span class="o">|</span><span class="n">ctx</span><span class="o">|</span>
    <span class="k">if</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">current_action</span> <span class="o">==</span> <span class="no">TwoAction</span>
      <span class="k">return</span> <span class="k">unless</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">role</span> <span class="o">==</span> <span class="s1">'admin'</span>
      <span class="n">ctx</span><span class="p">.</span><span class="nf">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s1">'admin is doing something'</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
</pre>
<p>These ideas are originally from Aspect Oriented Programming, read more about them <a href="https://en.wikipedia.org/wiki/Aspect-oriented_programming" rel="nofollow">here</a>.</p>
<h2>
<a id="expects-and-promises" class="anchor" href="#expects-and-promises" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Expects and Promises</h2>
<p>The <code>expects</code> and <code>promises</code> macros are rules for the inputs/outputs of an action.
<code>expects</code> describes what keys it needs to execute, and <code>promises</code> makes sure the keys are in the context after the
action is reduced. If either of them are violated, a custom exception is thrown.</p>
<p>This is how it's used:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">FooAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:baz</span>
  <span class="n">promises</span> <span class="ss">:bar</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">baz</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="nf">fetch</span> <span class="ss">:baz</span>

    <span class="n">bar</span> <span class="o">=</span> <span class="n">baz</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">context</span><span class="p">[</span><span class="ss">:bar</span><span class="p">]</span> <span class="o">=</span> <span class="n">bar</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>The <code>expects</code> macro does a bit more for you: it pulls the value with the expected key from the context, and
makes it available to you through a reader. You can refactor the action like this:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">FooAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:baz</span>
  <span class="n">promises</span> <span class="ss">:bar</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">bar</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="nf">baz</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">context</span><span class="p">[</span><span class="ss">:bar</span><span class="p">]</span> <span class="o">=</span> <span class="n">bar</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>The <code>promises</code> macro will not only check if the context has the promised keys, it also sets it for you in the context if
you use the accessor with the same name. The code above can be further simplified:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">FooAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:baz</span>
  <span class="n">promises</span> <span class="ss">:bar</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">bar</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="nf">baz</span> <span class="o">+</span> <span class="mi">2</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>Take a look at <a href="https://github.com/adomokos/light-service/blob/master/spec/action_expects_and_promises_spec.rb" rel="nofollow">this spec</a> to see the refactoring in action.</p>
<h2>
<a id="key-aliases" class="anchor" href="#key-aliases" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Key Aliases</h2>
<p>The <code>aliases</code> macro sets up pairs of keys and aliases in an organizer. Actions can access the context using the aliases.</p>
<p>This allows you to put together existing actions from different sources and have them work together without having to modify their code. Aliases will work with or without action <code>expects</code>.</p>
<p>Say for example you have actions <code>AnAction</code> and <code>AnotherAction</code> that you've used in previous projects.  <code>AnAction</code> provides <code>:my_key</code> but <code>AnotherAction</code> needs to use that value but expects <code>:key_alias</code>.  You can use them together in an organizer like so:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">AnOrganizer</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>

  <span class="n">aliases</span> <span class="ss">:my_key</span> <span class="o">=&gt;</span> <span class="ss">:key_alias</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="n">with</span><span class="p">(</span><span class="ss">:order</span> <span class="o">=&gt;</span> <span class="n">order</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span>
      <span class="no">AnAction</span><span class="p">,</span>
      <span class="no">AnotherAction</span><span class="p">,</span>
    <span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">AnAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">promises</span> <span class="ss">:my_key</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">my_key</span> <span class="o">=</span> <span class="s2">"value"</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">AnotherAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:key_alias</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">key_alias</span> <span class="c1"># =&gt; "value"</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<h2>
<a id="logging" class="anchor" href="#logging" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Logging</h2>
<p>Enable LightService's logging to better understand what goes on within the series of actions,
what's in the context or when an action fails.</p>
<p>Logging in LightService is turned off by default. However, turning it on is simple. Add this line to your
project's config file:</p>
<pre lang="ruby" class="highlight-ruby"><span class="no">LightService</span><span class="o">::</span><span class="no">Configuration</span><span class="p">.</span><span class="nf">logger</span> <span class="o">=</span> <span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">)</span>
</pre>
<p>You can turn off the logger by setting it to nil or <code>/dev/null</code>.</p>
<pre lang="ruby" class="highlight-ruby"><span class="no">LightService</span><span class="o">::</span><span class="no">Configuration</span><span class="p">.</span><span class="nf">logger</span> <span class="o">=</span> <span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s1">'/dev/null'</span><span class="p">)</span>
</pre>
<p>Watch the console while you are executing the workflow through the organizer. You should see something like this:</p>
<pre lang="bash" class="highlight-bash">I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] - calling organizer &lt;TestDoubles::MakesTeaAndCappuccino&gt;
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -     keys <span class="k">in </span>context: :tea, :milk, :coffee
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] - executing &lt;TestDoubles::MakesTeaWithMilkAction&gt;
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -   expects: :tea, :milk
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -   promises: :milk_tea
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -     keys <span class="k">in </span>context: :tea, :milk, :coffee, :milk_tea
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] - executing &lt;TestDoubles::MakesLatteAction&gt;
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -   expects: :coffee, :milk
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -   promises: :latte
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -     keys <span class="k">in </span>context: :tea, :milk, :coffee, :milk_tea, :latte
</pre>
<p>The log provides a blueprint of the series of actions. You can see what organizer is invoked, what actions
are called in what order, what do the expect and promise and most importantly what keys you have in the context
after each action is executed.</p>
<p>The logger logs its messages with "INFO" level. The exception to this is the event when an action fails the context.
That message is logged with "WARN" level:</p>
<pre lang="bash" class="highlight-bash">I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] - calling organizer &lt;TestDoubles::MakesCappuccinoAddsTwoAndFails&gt;
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -     keys <span class="k">in </span>context: :milk, :coffee
W, <span class="o">[</span>DATE]  WARN <span class="nt">--</span> : <span class="o">[</span>LightService] - :-<span class="o">(((</span> &lt;TestDoubles::MakesLatteAction&gt; has failed...
W, <span class="o">[</span>DATE]  WARN <span class="nt">--</span> : <span class="o">[</span>LightService] - context message: Can<span class="s1">'t make a latte from a milk that'</span>s too hot!
</pre>
<p>The log message will show you what message was added to the context when the action pushed the
context into a failure state.</p>
<p>The event of skipping the rest of the actions is also captured by its logs:</p>
<pre lang="bash" class="highlight-bash">I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] - calling organizer &lt;TestDoubles::MakesCappuccinoSkipsAddsTwo&gt;
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] -     keys <span class="k">in </span>context: :milk, :coffee
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] - <span class="p">;</span>-<span class="o">)</span> &lt;TestDoubles::MakesLatteAction&gt; has decided to skip the rest of the actions
I, <span class="o">[</span>DATE]  INFO <span class="nt">--</span> : <span class="o">[</span>LightService] - context message: Can<span class="s1">'t make a latte with a fatty milk like that!
</span></pre>
<p>You can specify the logger on the organizer level, so the organizer does not use the global logger.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">FooOrganizer</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>
  <span class="n">log_with</span> <span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"/my/special.log"</span><span class="p">)</span>
<span class="k">end</span>
</pre>
<h2>
<a id="error-codes" class="anchor" href="#error-codes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Error Codes</h2>
<p>You can add some more structure to your error handling by taking advantage of error codes in the context.
Normally, when something goes wrong in your actions, you fail the process by setting the context to failure:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">FooAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span><span class="p">(</span><span class="s2">"I don't like what happened here."</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>However, you might need to handle the errors coming from your action pipeline differently.
Using an error code can help you check what type of expected error occurred in the organizer
or in the actions.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">FooAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="k">unless</span> <span class="p">(</span><span class="n">service_call</span><span class="p">.</span><span class="nf">success?</span><span class="p">)</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span><span class="p">(</span><span class="s2">"Service call failed"</span><span class="p">,</span> <span class="ss">error_code: </span><span class="mi">1001</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="c1"># Do something else</span>

    <span class="k">unless</span> <span class="p">(</span><span class="n">entity</span><span class="p">.</span><span class="nf">save</span><span class="p">)</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span><span class="p">(</span><span class="s2">"Saving the entity failed"</span><span class="p">,</span> <span class="ss">error_code: </span><span class="mi">2001</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<h2>
<a id="action-rollback" class="anchor" href="#action-rollback" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Action Rollback</h2>
<p>Sometimes your action has to undo what it did when an error occurs. Think about a chain of actions where you need
to persist records in your data store in one action and you have to call an external service in the next. What happens if there
is an error when you call the external service? You want to remove the records you previously saved. You can do it now with
the <code>rolled_back</code> macro.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">SaveEntities</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>
  <span class="n">expects</span> <span class="ss">:user</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">save!</span>
  <span class="k">end</span>

  <span class="n">rolled_back</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">context</span><span class="p">.</span><span class="nf">user</span><span class="p">.</span><span class="nf">destroy</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>You need to call the <code>fail_with_rollback!</code> method to initiate a rollback for actions starting with the action where the failure
was triggered.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">CallExternalApi</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="n">api_call_result</span> <span class="o">=</span> <span class="no">SomeAPI</span><span class="p">.</span><span class="nf">save_user</span><span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="nf">user</span><span class="p">)</span>

    <span class="n">context</span><span class="p">.</span><span class="nf">fail_with_rollback!</span><span class="p">(</span><span class="s2">"Error when calling external API"</span><span class="p">)</span> <span class="k">if</span> <span class="n">api_call_result</span><span class="p">.</span><span class="nf">failure?</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>Using the <code>rolled_back</code> macro is optional for the actions in the chain. You shouldn't care about undoing non-persisted changes.</p>
<p>The actions are rolled back in reversed order from the point of failure starting with the action that triggered it.</p>
<p>See <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/rollback_spec.rb" rel="nofollow">this acceptance test</a> to learn more about this functionality.</p>
<p>You may find yourself directly using an action that can roll back by calling <code>.execute</code> instead of using it from within an Organizer.
If this action fails and attempts a rollback, a <code>FailWithRollbackError</code> exception will be raised. This is so that the organizer can
rollback the actions one by one. If you don't want to wrap your call to the action with a <code>begin, rescue FailWithRollbackError</code>
block, you can introspect the context like so, and keep your usage of the action clean:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">FooAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="c1"># context.organized_by will be nil if run from an action,</span>
    <span class="c1"># or will be the class name if run from an organizer</span>
    <span class="k">if</span> <span class="n">context</span><span class="p">.</span><span class="nf">organized_by</span><span class="p">.</span><span class="nf">nil?</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span>
    <span class="k">else</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">fail_with_rollback!</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<h2>
<a id="localizing-messages" class="anchor" href="#localizing-messages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Localizing Messages</h2>
<p>By default LightService provides a mechanism for easily translating your error or success messages via I18n.  You can also provide your own custom localization adapter if your application's logic is more complex than what is shown here.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">FooAction</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

  <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
    <span class="k">unless</span> <span class="n">service_call</span><span class="p">.</span><span class="nf">success?</span>
      <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span><span class="p">(</span><span class="ss">:exceeded_api_limit</span><span class="p">)</span>

      <span class="c1"># The failure message used here equates to:</span>
      <span class="c1"># I18n.t(:exceeded_api_limit, scope: "foo_action.light_service.failures")</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>This also works with nested classes via the ActiveSupport <code>#underscore</code> method, just as ActiveRecord performs localization lookups on models placed inside a module.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">module</span> <span class="nn">PaymentGateway</span>
  <span class="k">class</span> <span class="nc">CaptureFunds</span>
    <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

    <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
      <span class="k">if</span> <span class="n">api_service</span><span class="p">.</span><span class="nf">failed?</span>
        <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span><span class="p">(</span><span class="ss">:funds_not_available</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="c1"># this failure message equates to:</span>
      <span class="c1"># I18n.t(:funds_not_available, scope: "payment_gateway/capture_funds.light_service.failures")</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>If you need to provide custom variables for interpolation during localization, pass that along in a hash.</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">module</span> <span class="nn">PaymentGateway</span>
  <span class="k">class</span> <span class="nc">CaptureFunds</span>
    <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Action</span>

    <span class="n">executed</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
      <span class="k">if</span> <span class="n">api_service</span><span class="p">.</span><span class="nf">failed?</span>
        <span class="n">context</span><span class="p">.</span><span class="nf">fail!</span><span class="p">(</span><span class="ss">:funds_not_available</span><span class="p">,</span> <span class="ss">last_four: </span><span class="s2">"1234"</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="c1"># this failure message equates to:</span>
      <span class="c1"># I18n.t(:funds_not_available, last_four: "1234", scope: "payment_gateway/capture_funds.light_service.failures")</span>

      <span class="c1"># the translation string itself being:</span>
      <span class="c1"># =&gt; "Unable to process your payment for account ending in %{last_four}"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>To provide your own custom adapter, use the configuration setting and subclass the default adapter LightService provides.</p>
<pre lang="ruby" class="highlight-ruby"><span class="no">LightService</span><span class="o">::</span><span class="no">Configuration</span><span class="p">.</span><span class="nf">localization_adapter</span> <span class="o">=</span> <span class="no">MyLocalizer</span><span class="p">.</span><span class="nf">new</span>

<span class="c1"># lib/my_localizer.rb</span>
<span class="k">class</span> <span class="nc">MyLocalizer</span> <span class="o">&lt;</span> <span class="no">LightService</span><span class="o">::</span><span class="no">LocalizationAdapter</span>

  <span class="c1"># I just want to change the default lookup path</span>
  <span class="c1"># =&gt; "light_service.failures.payment_gateway/capture_funds"</span>
  <span class="k">def</span> <span class="nf">i18n_scope_from_class</span><span class="p">(</span><span class="n">action_class</span><span class="p">,</span> <span class="n">type</span><span class="p">)</span>
    <span class="s2">"light_service.</span><span class="si">#{</span><span class="n">type</span><span class="p">.</span><span class="nf">pluralize</span><span class="si">}</span><span class="s2">.</span><span class="si">#{</span><span class="n">action_class</span><span class="p">.</span><span class="nf">name</span><span class="p">.</span><span class="nf">underscore</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>To get the value of a <code>fail!</code> or <code>succeed!</code> message, simply call <code>#message</code> on the returned context.</p>
<h2>
<a id="orchestrator-logic-in-organizers" class="anchor" href="#orchestrator-logic-in-organizers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Orchestrator Logic in Organizers</h2>
<p>The Organizer - Action combination works really well for simple use cases. However, as business logic gets more complex, or when LightService is used in an ETL workflow, the code that routes the different organizers becomes very complex and imperative. Let's look at a piece of code that does basic data transformations:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">ExtractsTransformsLoadsData</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">run</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="no">RetrievesConnectionInfo</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="no">PullsDataFromRemoteApi</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

    <span class="n">retrieved_items</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="nf">retrieved_items</span>
    <span class="k">if</span> <span class="n">retrieved_items</span><span class="p">.</span><span class="nf">empty?</span>
      <span class="no">NotifiesEngineeringTeamAction</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="n">retrieved_items</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
      <span class="n">context</span><span class="p">[</span><span class="ss">:item</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
      <span class="no">TransformsData</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="n">context</span> <span class="o">=</span> <span class="no">LoadsData</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

    <span class="no">SendsNotifications</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>The <code>LightService::Context</code> is initialized with the first action, that context is passed around among organizers and actions. This code is still simpler than many out there, but it feels very imperative: it has conditionals, iterators in it. Let's see how we could make it a bit more simpler with a declarative style:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">ExtractsTransformsLoadsData</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
    <span class="n">with</span><span class="p">(</span><span class="ss">:connection</span> <span class="o">=&gt;</span> <span class="n">connection</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">actions</span>
    <span class="p">[</span>
      <span class="no">RetrievesConnectionInfo</span><span class="p">,</span>
      <span class="no">PullsDataFromRemoteApi</span><span class="p">,</span>
      <span class="n">reduce_if</span><span class="p">(</span><span class="o">-&gt;</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">retrieved_items</span><span class="p">.</span><span class="nf">empty?</span> <span class="p">},</span> <span class="p">[</span>
        <span class="no">NotifiesEngineeringTeamAction</span>
      <span class="p">]),</span>
      <span class="n">iterate</span><span class="p">(</span><span class="ss">:retrieved_items</span><span class="p">,</span> <span class="p">[</span>
        <span class="no">TransformsData</span>
      <span class="p">]),</span>
      <span class="no">LoadsData</span><span class="p">,</span>
      <span class="no">SendsNotifications</span>
    <span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>This code is much easier to reason about, it's less noisy and it captures the goal of LightService well: simple, declarative code that's easy to understand.</p>
<p>The 7 different orchestrator constructs an organizer can have:</p>
<ol>
<li><code>reduce_until</code></li>
<li><code>reduce_if</code></li>
<li><code>iterate</code></li>
<li><code>execute</code></li>
<li><code>with_callback</code></li>
<li><code>add_to_context</code></li>
<li><code>add_aliases</code></li>
</ol>
<p><code>reduce_until</code> behaves like a while loop in imperative languages, it iterates until the provided predicate in the lambda evaluates to true. Take a look at <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/reduce_until_spec.rb" rel="nofollow">this acceptance test</a> to see how it's used.</p>
<p><code>reduce_if</code> will reduce the included organizers and/or actions if the predicate in the lambda evaluates to true. <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/reduce_if_spec.rb" rel="nofollow">This acceptance test</a> describes this functionality.</p>
<p><code>iterate</code> gives your iteration logic, the symbol you define there has to be in the context as a key. For example, to iterate over items you will use <code>iterate(:items)</code> in your steps, the context needs to have <code>items</code> as a key, otherwise it will fail. The organizer will singularize the collection name and will put the actual item into the context under that name. Remaining with the example above, each element will be accessible by the name <code>item</code> for the actions in the <code>iterate</code> steps. <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/iterate_spec.rb" rel="nofollow">This acceptance test</a> should provide you with an example.</p>
<p>To take advantage of another organizer or action, you might need to tweak the context a bit. Let's say you have a hash, and you need to iterate over its values in a series of action. To alter the context and have the values assigned into a variable, you need to create a new action with 1 line of code in it. That seems a lot of ceremony for a simple change. You can do that in a <code>execute</code> method like this <code>execute(-&gt;(ctx) { ctx[:some_values] = ctx.some_hash.values })</code>. <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/execute_spec.rb" rel="nofollow">This test</a> describes how you can use it.</p>
<p>Use <code>with_callback</code> when you want to execute actions with a deferred and controlled callback. It works similar to a Sax parser, I've used it for processing large files. The advantage of it is not having to keep large amount of data in memory. See <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/with_callback_spec.rb" rel="nofollow">this acceptance test</a> as a working example.</p>
<p><code>add_to_context</code> can add key-value pairs on the fly to the context. This functionality is useful when you need a value injected into the context under a specific key right before the subsequent actions are executed. <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/add_to_context_spec.rb" rel="nofollow">This test</a> describes its functionality.</p>
<p>Your action needs a certain key in the context but it's under a different one? Use the function <code>add_aliases</code> to alias an existing key in the context under the desired key. Take a look at <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/add_aliases_spec.rb" rel="nofollow">this test</a> to see an example.</p>
<h2>
<a id="contextfactory-for-faster-action-testing" class="anchor" href="#contextfactory-for-faster-action-testing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ContextFactory for Faster Action Testing</h2>
<p>As the complexity of your workflow increases, you will find yourself spending more and more time creating a context (LightService::Context it is) for your action tests. Some of this code can be reused by clever factories, but still, you are using a context that is artificial, and can be different from what the previous actions produced. This is especially true, when you use LightService in ETLs, where you start out with initial data and your actions are mutating its state.</p>
<p>Here is an example:</p>
<pre lang="ruby" class="highlight-ruby"><span class="k">class</span> <span class="nc">SomeOrganizer</span>
  <span class="kp">extend</span> <span class="no">LightService</span><span class="o">::</span><span class="no">Organizer</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
    <span class="n">with</span><span class="p">(</span><span class="n">ctx</span><span class="p">).</span><span class="nf">reduce</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">actions</span>
    <span class="p">[</span>
       <span class="no">ETL</span><span class="o">::</span><span class="no">ParsesPayloadAction</span><span class="p">,</span>
       <span class="no">ETL</span><span class="o">::</span><span class="no">BuildsEnititiesAction</span><span class="p">,</span>
       <span class="no">ETL</span><span class="o">::</span><span class="no">SetsUpMappingsAction</span><span class="p">,</span>
       <span class="no">ETL</span><span class="o">::</span><span class="no">SavesEntitiesAction</span><span class="p">,</span>
       <span class="no">ETL</span><span class="o">::</span><span class="no">SendsNotificationAction</span>
    <span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>You should test your workflow from the outside, invoking the organizer’s <code>call</code> method and verify that the data was properly created or updated in your data store. However, sometimes you need to zoom into one action, and setting up the context to test it is tedious work. This is where <code>ContextFactory</code> can be helpful.</p>
<p>In order to test the third action <code>ETL::SetsUpMappingAction</code>, you have to have several entities in the context. Depending on the logic you need to write code for, this could be a lot of work. However, by using the <code>ContextFactory</code> in your spec, you could easily have a prepared context that’s ready for testing:</p>
<pre lang="ruby" class="highlight-ruby"><span class="nb">require</span> <span class="s1">'spec_helper'</span>
<span class="nb">require</span> <span class="s1">'light-service/testing'</span>

<span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">ETL</span><span class="o">::</span><span class="no">SetsUpMappingsAction</span> <span class="k">do</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:context</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">LightService</span><span class="o">::</span><span class="no">Testing</span><span class="o">::</span><span class="no">ContextFactory</span>
      <span class="p">.</span><span class="nf">make_from</span><span class="p">(</span><span class="no">SomeOrganizer</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">for</span><span class="p">(</span><span class="n">described_class</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">with</span><span class="p">(</span><span class="ss">:payload</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="err">‘</span><span class="n">spec</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">payload</span><span class="p">.</span><span class="nf">json</span><span class="err">’</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="err">‘</span><span class="n">works</span> <span class="n">like</span> <span class="n">it</span> <span class="n">should</span><span class="err">’</span> <span class="k">do</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">described_class</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">result</span><span class="p">).</span><span class="nf">to</span> <span class="n">be_success</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<p>This context then can be passed to the action under test, freeing you up from the 20 lines of factory or fixture calls to create a context for your specs.</p>
<p>In case your organizer has more logic in its <code>call</code> method, you could create your own test organizer in your specs like you can see it in this <a href="https://github.com/adomokos/light-service/blob/master/spec/acceptance/testing/context_factory_spec.rb#L4-L11" rel="nofollow">acceptance test</a>. This is reusable in all your action tests.</p>
<h2>
<a id="rails-support" class="anchor" href="#rails-support" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rails support</h2>
<p>LightService includes Rails generators for creating both Organizers and Actions along with corresponding tests. Currently only RSpec is
supported (<a href="https://github.com/adomokos/light-service/pulls" rel="nofollow">PR's for supporting MiniTest are welcome</a>)</p>
<p>Note: Generators are namespaced to <code>light_service</code> not <code>light-service</code> due to Rake name constraints.</p>
<h3>
<a id="organizer-generation" class="anchor" href="#organizer-generation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Organizer generation</h3>
<pre lang="shell" class="highlight-shell">rails generate light_service:organizer My::SuperFancy::Organizer
<span class="c"># -- or</span>
rails generate light_service:organizer my/super_fancy/organizer
</pre>
<p>Options for this generator are:</p>
<ul>
<li>
<code>--dir=&lt;SOME_DIR&gt;</code>. <code>&lt;SOME_DIR&gt;</code> defaults to <code>organizers</code>. Will write organizers to <code>/app/organizers</code>, and specs to <code>/spec/organizers</code>
</li>
<li>
<code>--no-tests</code>. Default is <code>--tests</code>. Will generate a test file matching the namespace you've supplied.</li>
</ul>
<h3>
<a id="action-generation" class="anchor" href="#action-generation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Action generation</h3>
<pre lang="shell" class="highlight-shell">rails generate light_service:action My::SuperFancy::Action
<span class="c"># -- or</span>
rails generate light_service:action my/super_fancy/action
</pre>
<p>Options for this generator are:</p>
<ul>
<li>
<code>--dir=&lt;SOME_DIR&gt;</code>. <code>&lt;SOME_DIR&gt;</code> defaults to <code>actions</code>. Will write actions to <code>/app/actions</code>, and specs to <code>/spec/actions</code>
</li>
<li>
<code>--no-tests</code>. Defaults is <code>--tests</code>. Will generate a test file matching the namespace you've supplied.</li>
<li>
<code>--no-roll-back</code>. Default is <code>--roll-back</code>. Will generate a <code>rolled_back</code> block for you to implement with <a href="#action-rollback">roll back functionality</a>.</li>
</ul>
<h3>
<a id="advanced-action-generation" class="anchor" href="#advanced-action-generation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Advanced action generation</h3>
<p>You are able to optionally specify <code>expects</code> and/or <code>promises</code> keys during generation</p>
<pre lang="shell" class="highlight-shell">rails generate light_service:action CrankWidget expects:one_fish,two_fish promises:red_fish,blue_fish
</pre>
<p>When specifying <code>expects</code>, convenience variables will be initialized in the <code>executed</code> block so that you don't have to call
them through the context. A stub context will be created in the test file using these keys too.</p>
<p>When specifying <code>promises</code>, specs will be created testing for their existence after executing the action.</p>
<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contributing</h2>
<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Added some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol>
<p>Huge thanks to the <a href="https://github.com/adomokos/light-service/graphs/contributors" rel="nofollow">contributors</a>!</p>
<h2>
<a id="release-notes" class="anchor" href="#release-notes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Release Notes</h2>
<p>Follow the release notes in this <a href="https://github.com/adomokos/light-service/blob/master/RELEASES.md" rel="nofollow">document</a>.</p>
<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>
<p>LightService is released under the <a href="http://www.opensource.org/licenses/MIT" rel="nofollow">MIT License</a>.</p>
<script type="text/javascript">(function(){window['__CF$cv$params']={r:'6120bd408eb3e738',m:'b14f646b4cbcef299ac509a50e3a251d64d8f903-1610725688-1800-Abg8tNQJVCx87bmd+bYBAbsFVltGUjPdIYaAOnF2/hiyyW3bxRzxWsCoXyqAkCk0BdOt8BbDtApld+OUc/DOyNE+ee84V5+irilwXV4ECLGcoMJ12XaSCEGRWlPUGO7LdFew8/zmnaAO8SjaFCo4tJ4=',s:[0xfd32565599,0x60f6f489db],}})();</script></body></html>
</div><div><br/><div style="border:1px solid gray;border-radius:5px;background-color:lightgray;padding:2%"><div style="font-size:24px;font-weight:bold;margin-bottom:10px">Get A Weekly Email With Trending Projects For These Topics</div><div style="margin-bottom:10px">No Spam.  Unsubscribe easily at any time.</div><div><div><input type="checkbox" name="topics" value="ruby"/> <!-- -->ruby<!-- --> (<!-- -->12,268<!-- -->) </div><div><input type="checkbox" name="topics" value="workflow"/> <!-- -->workflow<!-- --> (<!-- -->315<!-- -->) </div><div><input type="checkbox" name="topics" value="aop"/> <!-- -->aop<!-- --> (<!-- -->82<!-- -->) </div></div><div><input type="email" style="width:95%;margin-top:10px;margin-bottom:10px;padding:5px;font-size:20px;border-radius:5px" name="email" placeholder="Your email address"/></div><div><input type="submit" style="color:white;background-color:#0366d6;font-size:20px;border:1px solid black;border-radius:5px;padding:5px;cursor:pointer" value="Subscribe"/></div></div></div><h2>Find Open Source By Browsing 7,000 Topics Across 59 Categories</h2><div class="aos_topics_sidebar" style="margin:0;width:100%"><div class="category_topic_filter_container"><input style="width:100%" placeholder="Search, browse and combine topics" value="" class="aos_filter_topics_input"/></div><div style="display:block;box-shadow:1px 1px 5px lightgray"><a data-category-name="Advertising" href="https://awesomeopensource.com/categories/advertising"><div class="aos_category_explorer_category_container" data-category-name="Advertising"><span data-category-name="Advertising">Advertising<span data-category-name="Advertising" class="aos_project_count"> 📦 <!-- -->10</span></span></div></a><a data-category-name="All Projects" href="https://awesomeopensource.com/projects"><div class="aos_category_explorer_category_container" data-category-name="All Projects"><span data-category-name="All Projects">All Projects</span></div></a><a data-category-name="Application Programming Interfaces" href="https://awesomeopensource.com/categories/application-programming-interfaces"><div class="aos_category_explorer_category_container" data-category-name="Application Programming Interfaces"><span data-category-name="Application Programming Interfaces">Application Programming Interfaces<span data-category-name="Application Programming Interfaces" class="aos_project_count"> 📦 <!-- -->124</span></span></div></a><a data-category-name="Applications" href="https://awesomeopensource.com/categories/applications"><div class="aos_category_explorer_category_container" data-category-name="Applications"><span data-category-name="Applications">Applications<span data-category-name="Applications" class="aos_project_count"> 📦 <!-- -->192</span></span></div></a><a data-category-name="Artificial Intelligence" href="https://awesomeopensource.com/categories/artificial-intelligence"><div class="aos_category_explorer_category_container" data-category-name="Artificial Intelligence"><span data-category-name="Artificial Intelligence">Artificial Intelligence<span data-category-name="Artificial Intelligence" class="aos_project_count"> 📦 <!-- -->78</span></span></div></a><a data-category-name="Blockchain" href="https://awesomeopensource.com/categories/blockchain"><div class="aos_category_explorer_category_container" data-category-name="Blockchain"><span data-category-name="Blockchain">Blockchain<span data-category-name="Blockchain" class="aos_project_count"> 📦 <!-- -->73</span></span></div></a><a data-category-name="Build Tools" href="https://awesomeopensource.com/categories/build-tools"><div class="aos_category_explorer_category_container" data-category-name="Build Tools"><span data-category-name="Build Tools">Build Tools<span data-category-name="Build Tools" class="aos_project_count"> 📦 <!-- -->113</span></span></div></a><a data-category-name="Cloud Computing" href="https://awesomeopensource.com/categories/cloud-computing"><div class="aos_category_explorer_category_container" data-category-name="Cloud Computing"><span data-category-name="Cloud Computing">Cloud Computing<span data-category-name="Cloud Computing" class="aos_project_count"> 📦 <!-- -->80</span></span></div></a><a data-category-name="Code Quality" href="https://awesomeopensource.com/categories/code-quality"><div class="aos_category_explorer_category_container" data-category-name="Code Quality"><span data-category-name="Code Quality">Code Quality<span data-category-name="Code Quality" class="aos_project_count"> 📦 <!-- -->28</span></span></div></a><a data-category-name="Collaboration" href="https://awesomeopensource.com/categories/collaboration"><div class="aos_category_explorer_category_container" data-category-name="Collaboration"><span data-category-name="Collaboration">Collaboration<span data-category-name="Collaboration" class="aos_project_count"> 📦 <!-- -->32</span></span></div></a><a data-category-name="Command Line Interface" href="https://awesomeopensource.com/categories/command-line-interface"><div class="aos_category_explorer_category_container" data-category-name="Command Line Interface"><span data-category-name="Command Line Interface">Command Line Interface<span data-category-name="Command Line Interface" class="aos_project_count"> 📦 <!-- -->49</span></span></div></a><a data-category-name="Community" href="https://awesomeopensource.com/categories/community"><div class="aos_category_explorer_category_container" data-category-name="Community"><span data-category-name="Community">Community<span data-category-name="Community" class="aos_project_count"> 📦 <!-- -->83</span></span></div></a><a data-category-name="Companies" href="https://awesomeopensource.com/categories/companies"><div class="aos_category_explorer_category_container" data-category-name="Companies"><span data-category-name="Companies">Companies<span data-category-name="Companies" class="aos_project_count"> 📦 <!-- -->60</span></span></div></a><a data-category-name="Compilers" href="https://awesomeopensource.com/categories/compilers"><div class="aos_category_explorer_category_container" data-category-name="Compilers"><span data-category-name="Compilers">Compilers<span data-category-name="Compilers" class="aos_project_count"> 📦 <!-- -->63</span></span></div></a><a data-category-name="Computer Science" href="https://awesomeopensource.com/categories/computer-science"><div class="aos_category_explorer_category_container" data-category-name="Computer Science"><span data-category-name="Computer Science">Computer Science<span data-category-name="Computer Science" class="aos_project_count"> 📦 <!-- -->80</span></span></div></a><a data-category-name="Configuration Management" href="https://awesomeopensource.com/categories/configuration-management"><div class="aos_category_explorer_category_container" data-category-name="Configuration Management"><span data-category-name="Configuration Management">Configuration Management<span data-category-name="Configuration Management" class="aos_project_count"> 📦 <!-- -->42</span></span></div></a><a data-category-name="Content Management" href="https://awesomeopensource.com/categories/content-management"><div class="aos_category_explorer_category_container" data-category-name="Content Management"><span data-category-name="Content Management">Content Management<span data-category-name="Content Management" class="aos_project_count"> 📦 <!-- -->175</span></span></div></a><a data-category-name="Control Flow" href="https://awesomeopensource.com/categories/control-flow"><div class="aos_category_explorer_category_container" data-category-name="Control Flow"><span data-category-name="Control Flow">Control Flow<span data-category-name="Control Flow" class="aos_project_count"> 📦 <!-- -->213</span></span></div></a><a data-category-name="Data Formats" href="https://awesomeopensource.com/categories/data-formats"><div class="aos_category_explorer_category_container" data-category-name="Data Formats"><span data-category-name="Data Formats">Data Formats<span data-category-name="Data Formats" class="aos_project_count"> 📦 <!-- -->78</span></span></div></a><a data-category-name="Data Processing" href="https://awesomeopensource.com/categories/data-processing"><div class="aos_category_explorer_category_container" data-category-name="Data Processing"><span data-category-name="Data Processing">Data Processing<span data-category-name="Data Processing" class="aos_project_count"> 📦 <!-- -->276</span></span></div></a><a data-category-name="Data Storage" href="https://awesomeopensource.com/categories/data-storage"><div class="aos_category_explorer_category_container" data-category-name="Data Storage"><span data-category-name="Data Storage">Data Storage<span data-category-name="Data Storage" class="aos_project_count"> 📦 <!-- -->135</span></span></div></a><a data-category-name="Economics" href="https://awesomeopensource.com/categories/economics"><div class="aos_category_explorer_category_container" data-category-name="Economics"><span data-category-name="Economics">Economics<span data-category-name="Economics" class="aos_project_count"> 📦 <!-- -->64</span></span></div></a><a data-category-name="Frameworks" href="https://awesomeopensource.com/categories/frameworks"><div class="aos_category_explorer_category_container" data-category-name="Frameworks"><span data-category-name="Frameworks">Frameworks<span data-category-name="Frameworks" class="aos_project_count"> 📦 <!-- -->215</span></span></div></a><a data-category-name="Games" href="https://awesomeopensource.com/categories/games"><div class="aos_category_explorer_category_container" data-category-name="Games"><span data-category-name="Games">Games<span data-category-name="Games" class="aos_project_count"> 📦 <!-- -->129</span></span></div></a><a data-category-name="Graphics" href="https://awesomeopensource.com/categories/graphics"><div class="aos_category_explorer_category_container" data-category-name="Graphics"><span data-category-name="Graphics">Graphics<span data-category-name="Graphics" class="aos_project_count"> 📦 <!-- -->110</span></span></div></a><a data-category-name="Hardware" href="https://awesomeopensource.com/categories/hardware"><div class="aos_category_explorer_category_container" data-category-name="Hardware"><span data-category-name="Hardware">Hardware<span data-category-name="Hardware" class="aos_project_count"> 📦 <!-- -->152</span></span></div></a><a data-category-name="Integrated Development Environments" href="https://awesomeopensource.com/categories/integrated-development-environments"><div class="aos_category_explorer_category_container" data-category-name="Integrated Development Environments"><span data-category-name="Integrated Development Environments">Integrated Development Environments<span data-category-name="Integrated Development Environments" class="aos_project_count"> 📦 <!-- -->49</span></span></div></a><a data-category-name="Learning Resources" href="https://awesomeopensource.com/categories/learning-resources"><div class="aos_category_explorer_category_container" data-category-name="Learning Resources"><span data-category-name="Learning Resources">Learning Resources<span data-category-name="Learning Resources" class="aos_project_count"> 📦 <!-- -->166</span></span></div></a><a data-category-name="Legal" href="https://awesomeopensource.com/categories/legal"><div class="aos_category_explorer_category_container" data-category-name="Legal"><span data-category-name="Legal">Legal<span data-category-name="Legal" class="aos_project_count"> 📦 <!-- -->29</span></span></div></a><a data-category-name="Libraries" href="https://awesomeopensource.com/categories/libraries"><div class="aos_category_explorer_category_container" data-category-name="Libraries"><span data-category-name="Libraries">Libraries<span data-category-name="Libraries" class="aos_project_count"> 📦 <!-- -->129</span></span></div></a><a data-category-name="Lists Of Projects" href="https://awesomeopensource.com/categories/lists-of-projects"><div class="aos_category_explorer_category_container" data-category-name="Lists Of Projects"><span data-category-name="Lists Of Projects">Lists Of Projects<span data-category-name="Lists Of Projects" class="aos_project_count"> 📦 <!-- -->22</span></span></div></a><a data-category-name="Machine Learning" href="https://awesomeopensource.com/categories/machine-learning"><div class="aos_category_explorer_category_container" data-category-name="Machine Learning"><span data-category-name="Machine Learning">Machine Learning<span data-category-name="Machine Learning" class="aos_project_count"> 📦 <!-- -->347</span></span></div></a><a data-category-name="Mapping" href="https://awesomeopensource.com/categories/mapping"><div class="aos_category_explorer_category_container" data-category-name="Mapping"><span data-category-name="Mapping">Mapping<span data-category-name="Mapping" class="aos_project_count"> 📦 <!-- -->64</span></span></div></a><a data-category-name="Marketing" href="https://awesomeopensource.com/categories/marketing"><div class="aos_category_explorer_category_container" data-category-name="Marketing"><span data-category-name="Marketing">Marketing<span data-category-name="Marketing" class="aos_project_count"> 📦 <!-- -->15</span></span></div></a><a data-category-name="Mathematics" href="https://awesomeopensource.com/categories/mathematics"><div class="aos_category_explorer_category_container" data-category-name="Mathematics"><span data-category-name="Mathematics">Mathematics<span data-category-name="Mathematics" class="aos_project_count"> 📦 <!-- -->55</span></span></div></a><a data-category-name="Media" href="https://awesomeopensource.com/categories/media"><div class="aos_category_explorer_category_container" data-category-name="Media"><span data-category-name="Media">Media<span data-category-name="Media" class="aos_project_count"> 📦 <!-- -->239</span></span></div></a><a data-category-name="Messaging" href="https://awesomeopensource.com/categories/messaging"><div class="aos_category_explorer_category_container" data-category-name="Messaging"><span data-category-name="Messaging">Messaging<span data-category-name="Messaging" class="aos_project_count"> 📦 <!-- -->98</span></span></div></a><a data-category-name="Networking" href="https://awesomeopensource.com/categories/networking"><div class="aos_category_explorer_category_container" data-category-name="Networking"><span data-category-name="Networking">Networking<span data-category-name="Networking" class="aos_project_count"> 📦 <!-- -->315</span></span></div></a><a data-category-name="Operating Systems" href="https://awesomeopensource.com/categories/operating-systems"><div class="aos_category_explorer_category_container" data-category-name="Operating Systems"><span data-category-name="Operating Systems">Operating Systems<span data-category-name="Operating Systems" class="aos_project_count"> 📦 <!-- -->89</span></span></div></a><a data-category-name="Operations" href="https://awesomeopensource.com/categories/operations"><div class="aos_category_explorer_category_container" data-category-name="Operations"><span data-category-name="Operations">Operations<span data-category-name="Operations" class="aos_project_count"> 📦 <!-- -->121</span></span></div></a><a data-category-name="Package Managers" href="https://awesomeopensource.com/categories/package-managers"><div class="aos_category_explorer_category_container" data-category-name="Package Managers"><span data-category-name="Package Managers">Package Managers<span data-category-name="Package Managers" class="aos_project_count"> 📦 <!-- -->55</span></span></div></a><a data-category-name="Programming Languages" href="https://awesomeopensource.com/categories/programming-languages"><div class="aos_category_explorer_category_container" data-category-name="Programming Languages"><span data-category-name="Programming Languages">Programming Languages<span data-category-name="Programming Languages" class="aos_project_count"> 📦 <!-- -->245</span></span></div></a><a data-category-name="Runtime Environments" href="https://awesomeopensource.com/categories/runtime-environments"><div class="aos_category_explorer_category_container" data-category-name="Runtime Environments"><span data-category-name="Runtime Environments">Runtime Environments<span data-category-name="Runtime Environments" class="aos_project_count"> 📦 <!-- -->100</span></span></div></a><a data-category-name="Science" href="https://awesomeopensource.com/categories/science"><div class="aos_category_explorer_category_container" data-category-name="Science"><span data-category-name="Science">Science<span data-category-name="Science" class="aos_project_count"> 📦 <!-- -->42</span></span></div></a><a data-category-name="Security" href="https://awesomeopensource.com/categories/security"><div class="aos_category_explorer_category_container" data-category-name="Security"><span data-category-name="Security">Security<span data-category-name="Security" class="aos_project_count"> 📦 <!-- -->396</span></span></div></a><a data-category-name="Social Media" href="https://awesomeopensource.com/categories/social-media"><div class="aos_category_explorer_category_container" data-category-name="Social Media"><span data-category-name="Social Media">Social Media<span data-category-name="Social Media" class="aos_project_count"> 📦 <!-- -->27</span></span></div></a><a data-category-name="Software Architecture" href="https://awesomeopensource.com/categories/software-architecture"><div class="aos_category_explorer_category_container" data-category-name="Software Architecture"><span data-category-name="Software Architecture">Software Architecture<span data-category-name="Software Architecture" class="aos_project_count"> 📦 <!-- -->72</span></span></div></a><a data-category-name="Software Development" href="https://awesomeopensource.com/categories/software-development"><div class="aos_category_explorer_category_container" data-category-name="Software Development"><span data-category-name="Software Development">Software Development<span data-category-name="Software Development" class="aos_project_count"> 📦 <!-- -->72</span></span></div></a><a data-category-name="Software Performance" href="https://awesomeopensource.com/categories/software-performance"><div class="aos_category_explorer_category_container" data-category-name="Software Performance"><span data-category-name="Software Performance">Software Performance<span data-category-name="Software Performance" class="aos_project_count"> 📦 <!-- -->58</span></span></div></a><a data-category-name="Software Quality" href="https://awesomeopensource.com/categories/software-quality"><div class="aos_category_explorer_category_container" data-category-name="Software Quality"><span data-category-name="Software Quality">Software Quality<span data-category-name="Software Quality" class="aos_project_count"> 📦 <!-- -->133</span></span></div></a><a data-category-name="Text Editors" href="https://awesomeopensource.com/categories/text-editors"><div class="aos_category_explorer_category_container" data-category-name="Text Editors"><span data-category-name="Text Editors">Text Editors<span data-category-name="Text Editors" class="aos_project_count"> 📦 <!-- -->49</span></span></div></a><a data-category-name="Text Processing" href="https://awesomeopensource.com/categories/text-processing"><div class="aos_category_explorer_category_container" data-category-name="Text Processing"><span data-category-name="Text Processing">Text Processing<span data-category-name="Text Processing" class="aos_project_count"> 📦 <!-- -->136</span></span></div></a><a data-category-name="User Interface" href="https://awesomeopensource.com/categories/user-interface"><div class="aos_category_explorer_category_container" data-category-name="User Interface"><span data-category-name="User Interface">User Interface<span data-category-name="User Interface" class="aos_project_count"> 📦 <!-- -->330</span></span></div></a><a data-category-name="User Interface Components" href="https://awesomeopensource.com/categories/user-interface-components"><div class="aos_category_explorer_category_container" data-category-name="User Interface Components"><span data-category-name="User Interface Components">User Interface Components<span data-category-name="User Interface Components" class="aos_project_count"> 📦 <!-- -->514</span></span></div></a><a data-category-name="Version Control" href="https://awesomeopensource.com/categories/version-control"><div class="aos_category_explorer_category_container" data-category-name="Version Control"><span data-category-name="Version Control">Version Control<span data-category-name="Version Control" class="aos_project_count"> 📦 <!-- -->30</span></span></div></a><a data-category-name="Virtualization" href="https://awesomeopensource.com/categories/virtualization"><div class="aos_category_explorer_category_container" data-category-name="Virtualization"><span data-category-name="Virtualization">Virtualization<span data-category-name="Virtualization" class="aos_project_count"> 📦 <!-- -->71</span></span></div></a><a data-category-name="Web Browsers" href="https://awesomeopensource.com/categories/web-browsers"><div class="aos_category_explorer_category_container" data-category-name="Web Browsers"><span data-category-name="Web Browsers">Web Browsers<span data-category-name="Web Browsers" class="aos_project_count"> 📦 <!-- -->42</span></span></div></a><a data-category-name="Web Servers" href="https://awesomeopensource.com/categories/web-servers"><div class="aos_category_explorer_category_container" data-category-name="Web Servers"><span data-category-name="Web Servers">Web Servers<span data-category-name="Web Servers" class="aos_project_count"> 📦 <!-- -->26</span></span></div></a><a data-category-name="Web User Interface" href="https://awesomeopensource.com/categories/web-user-interface"><div class="aos_category_explorer_category_container" data-category-name="Web User Interface"><span data-category-name="Web User Interface">Web User Interface<span data-category-name="Web User Interface" class="aos_project_count"> 📦 <!-- -->210</span></span></div></a></div></div><div class="aos_project_metadata_trademark_notice">&quot;<!-- -->Light <!-- -->Service<!-- -->&quot; and other potentially trademarked words, copyrighted images and copyrighted readme contents likely belong to the legal entity who owns the &quot;<a href="https://github.com/adomokos" target="_blank">Adomokos</a>&quot; organization.  Awesome Open Source is not affiliated with the legal entity who owns the &quot;<a href="https://github.com/adomokos" target="_blank">Adomokos</a>&quot; organization.</div></div></div><div class="aos_fixed_footer_container"><br/></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Root" data-dom-id="Root-react-component-aaba4198-aa4e-4ad4-bfe0-0b9ee349e822">{"topics":[{"id":null,"name":"javascript","count":67310},{"id":null,"name":"python","count":49729},{"id":null,"name":"java","count":30048},{"id":null,"name":"c-plus-plus","count":17339},{"id":null,"name":"php","count":15812},{"id":null,"name":"c","count":14340},{"id":null,"name":"go","count":14132},{"id":null,"name":"ruby","count":12268},{"id":null,"name":"c-sharp","count":11505},{"id":null,"name":"objective-c","count":10769}],"projectTopics":[{"id":null,"name":"aop","count":82},{"id":null,"name":"ruby","count":12268},{"id":null,"name":"workflow","count":315}],"selectedTopics":[],"currentUrl":"https://awesomeopensource.com/project/adomokos/light-service","projects":[],"project":{"id":77368,"created_at":"2018-08-21T01:10:26.107Z","updated_at":"2021-01-13T21:23:49.747Z","markdown_readme":"\u003c!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\"\u003e\n\u003chtml\u003e\u003cbody\u003e\n\u003cp\u003e\u003ca href=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/light-service.png\" target=\"_blank\" rel=\"nofollow\"\u003e\u003cimg src=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/light-service.png\" alt=\"LightService\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://rubygems.org/gems/light-service\" rel=\"nofollow\"\u003e\u003cimg src=\"https://img.shields.io/gem/v/light-service.svg\" alt=\"Gem Version\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\n\u003ca href=\"http://travis-ci.org/adomokos/light-service\" rel=\"nofollow\"\u003e\u003cimg src=\"https://secure.travis-ci.org/adomokos/light-service.svg\" alt=\"Build Status\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\n\u003ca href=\"https://codecov.io/gh/adomokos/light-service\" rel=\"nofollow\"\u003e\u003cimg src=\"https://codecov.io/gh/adomokos/light-service/branch/master/graph/badge.svg\" alt=\"codecov\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\n\u003ca href=\"https://codeclimate.com/github/adomokos/light-service\" rel=\"nofollow\"\u003e\u003cimg src=\"https://codeclimate.com/github/adomokos/light-service.svg\" alt=\"Code Climate\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\n\u003ca href=\"http://opensource.org/licenses/MIT\" rel=\"nofollow\"\u003e\u003cimg src=\"https://img.shields.io/badge/license-MIT-green.svg\" alt=\"License\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\n\u003ca href=\"https://rubygems.org/gems/light-service\" rel=\"nofollow\"\u003e\u003cimg src=\"https://ruby-gem-downloads-badge.herokuapp.com/light-service?type=total\" alt=\"Download Count\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/adomokos/light-service/blob/master/resources/orchestrators_deprecated.svg\" target=\"_blank\" rel=\"nofollow\"\u003e\u003cimg src=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/orchestrators_deprecated.svg?sanitize=true\" alt=\"Orchestrators-Deprecated\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\n\u003cbr\u003eVersion 0.9.0 deprecates Orchestrators and moves all their functionalities into Organizers. Please check out \u003ca href=\"https://github.com/adomokos/light-service/pull/132\" rel=\"nofollow\"\u003ethis PR\u003c/a\u003e to see the changes.\u003c/p\u003e\n\u003cbr\u003e\n\u003cp\u003eYou can find the Python sibling project called \u003ccode\u003epyservice\u003c/code\u003e \u003ca href=\"https://github.com/adomokos/pyservice\" rel=\"nofollow\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cbr\u003e\n\u003ch2\u003e\n\u003ca id=\"table-of-content\" class=\"anchor\" href=\"#table-of-content\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eTable of Content\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#why-lightservice\"\u003eWhy LightService?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#getting-started\"\u003eGetting Started\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#requirements\"\u003eRequirements\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#installation\"\u003eInstallation\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#your-first-action\"\u003eYour first action\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#your-first-organizer\"\u003eYour first organizer\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ca href=\"#stopping-the-series-of-actions\"\u003eStopping the Series of Actions\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#failing-the-context\"\u003eFailing the Context\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#skipping-the-rest-of-the-actions\"\u003eSkipping the Rest of the Actions\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#benchmarking-actions-with-around-advice\"\u003eBenchmarking Actions with Around Advice\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#before-and-after-action-hooks\"\u003eBefore and After Action Hooks\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#key-aliases\"\u003eKey Aliases\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#logging\"\u003eLogging\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#error-codes\"\u003eError Codes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#action-rollback\"\u003eAction Rollback\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#localizing-messages\"\u003eLocalizing Messages\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#orchestrator-logic-in-organizers\"\u003eOrchestrator Logic in Organizers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#contextfactory-for-faster-action-testing\"\u003eContextFactory for Faster Action Testing\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#rails-support\"\u003eRails support\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\n\u003ca id=\"why-lightservice\" class=\"anchor\" href=\"#why-lightservice\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWhy LightService?\u003c/h2\u003e\n\u003cp\u003eWhat do you think of this code?\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTaxController\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eApplicationController\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eupdate\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@order\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eOrder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etax_ranges\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eTaxRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efor_region\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eregion\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003etax_ranges\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enil?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003erender\u003c/span\u003e \u003cspan class=\"ss\"\u003e:action\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"ss\"\u003e:edit\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:error\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"The tax ranges were not found\"\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"c1\"\u003e# Avoiding the double render error\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003etax_percentage\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etax_ranges\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efor_total\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vi\"\u003e@order\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etotal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003etax_percentage\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enil?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003erender\u003c/span\u003e \u003cspan class=\"ss\"\u003e:action\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"ss\"\u003e:edit\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:error\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"The tax percentage  was not found\"\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"c1\"\u003e# Avoiding the double render error\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"vi\"\u003e@order\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etax\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vi\"\u003e@order\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etotal\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etax_percentage\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nf\"\u003eround\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"vi\"\u003e@order\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etotal_with_tax\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e\n      \u003cspan class=\"vi\"\u003e@order\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eprovide_free_shipping!\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eredirect_to\u003c/span\u003e \u003cspan class=\"n\"\u003echeckout_shipping_path\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vi\"\u003e@order\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"ss\"\u003e:notice\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Tax was calculated successfully\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThis controller violates \u003ca href=\"http://en.wikipedia.org/wiki/Single_responsibility_principle\" rel=\"nofollow\"\u003eSRP\u003c/a\u003e all over.\nAlso, imagine what it would take to test this beast.\nYou could move the tax_percentage finders and calculations into the tax model,\nbut then you'll make your model logic heavy.\u003c/p\u003e\n\u003cp\u003eThis controller does 3 things in order:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLooks up the tax percentage based on order total\u003c/li\u003e\n\u003cli\u003eCalculates the order tax\u003c/li\u003e\n\u003cli\u003eProvides free shipping if the total with tax is greater than $200\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe order of these tasks matters: you can't calculate the order tax without the percentage.\nWouldn't it be nice to see this instead?\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eLooksUpTaxPercentage\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eCalculatesOrderTax\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"no\"\u003eProvidesFreeShipping\u003c/span\u003e\n\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThis block of code should tell you the \"story\" of what's going on in this workflow.\nWith the help of LightService you can write code this way. First you need an organizer object that sets up the actions in order\nand executes them one-by-one. Then you need to create the actions with one method (that will do only one thing).\u003c/p\u003e\n\u003cp\u003eThis is how the organizer and actions interact with each other:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/organizer_and_actions.png\" target=\"_blank\" rel=\"nofollow\"\u003e\u003cimg src=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/organizer_and_actions.png\" alt=\"LightService\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCalculatesTax\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:order\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eLooksUpTaxPercentageAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eCalculatesOrderTaxAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eProvidesFreeShippingAction\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eLooksUpTaxPercentageAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:order\u003c/span\u003e\n  \u003cspan class=\"n\"\u003epromises\u003c/span\u003e \u003cspan class=\"ss\"\u003e:tax_percentage\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003etax_ranges\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eTaxRange\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efor_region\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eregion\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etax_percentage\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003enext\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eobject_is_nil?\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etax_ranges\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'The tax ranges were not found'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etax_percentage\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etax_ranges\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efor_total\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etotal\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003enext\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eobject_is_nil?\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etax_percentage\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e'The tax percentage was not found'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eobject_is_nil?\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eobject\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enil?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kp\"\u003etrue\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"kp\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCalculatesOrderTaxAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:order\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:tax_percentage\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e# I am using ctx as an abbreviation for context\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eorder\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eorder\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etax\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etotal\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etax_percentage\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e)).\u003c/span\u003e\u003cspan class=\"nf\"\u003eround\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eProvidesFreeShippingAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:order\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003etotal_with_tax\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eprovide_free_shipping!\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eAnd with all that, your controller should be super simple:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTaxController\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eApplicationContoller\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eupdate\u003c/span\u003e\n    \u003cspan class=\"vi\"\u003e@order\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eOrder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eparams\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:id\u003c/span\u003e\u003cspan class=\"p\"\u003e])\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eservice_result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eCalculatesTax\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efor_order\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vi\"\u003e@order\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eservice_result\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efailure?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003erender\u003c/span\u003e \u003cspan class=\"ss\"\u003e:action\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"ss\"\u003e:edit\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:error\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eservice_result\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emessage\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eredirect_to\u003c/span\u003e \u003cspan class=\"n\"\u003echeckout_shipping_path\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vi\"\u003e@order\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"ss\"\u003e:notice\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Tax was calculated successfully\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eI gave a \u003ca href=\"http://www.adomokos.com/2013/06/simple-and-elegant-rails-code-with.html\" rel=\"nofollow\"\u003etalk at RailsConf 2013\u003c/a\u003e on\nsimple and elegant Rails code where I told the story of how LightService was extracted from the projects I had worked on.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"getting-started\" class=\"anchor\" href=\"#getting-started\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eGetting started\u003c/h2\u003e\n\u003ch3\u003e\n\u003ca id=\"requirements\" class=\"anchor\" href=\"#requirements\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eRequirements\u003c/h3\u003e\n\u003cp\u003eThis gem requires ruby 2.x. Use of \u003ca href=\"#rails-support\"\u003egenerators\u003c/a\u003e requires Rails 5+ (tested on Rails 5.x \u0026amp; 6.x only. Will probably work on\nRails versions as old as 3.2)\u003c/p\u003e\n\u003ch3\u003e\n\u003ca id=\"installation\" class=\"anchor\" href=\"#installation\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eInstallation\u003c/h3\u003e\n\u003cp\u003eIn your Gemfile:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"n\"\u003egem\u003c/span\u003e \u003cspan class=\"s1\"\u003e'light-service'\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eAnd then\u003c/p\u003e\n\u003cpre lang=\"shell\" class=\"highlight-shell\"\u003ebundle \u003cspan class=\"nb\"\u003einstall\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eOr install it yourself as:\u003c/p\u003e\n\u003cpre lang=\"shell\" class=\"highlight-shell\"\u003egem \u003cspan class=\"nb\"\u003einstall \u003c/span\u003elight-service\n\u003c/pre\u003e\n\u003ch3\u003e\n\u003ca id=\"your-first-action\" class=\"anchor\" href=\"#your-first-action\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eYour first action\u003c/h3\u003e\n\u003cp\u003eLightService's building blocks are actions that are normally composed within an organizer, but can be run independently.\nLet's make a simple greeter action. Each action can take an optional list of expected inputs and promised outputs. If\nthese are specified and missing at action start and stop respectively, an exception will be thrown.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eGreetsPerson\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\n  \u003cspan class=\"n\"\u003epromises\u003c/span\u003e \u003cspan class=\"ss\"\u003e:greeting\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egreeting\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Hey there, \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"nb\"\u003ename\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e. You enjoying LightService so far?\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eWhen an action is run, you have access to its returned context, and the status of the action. You can invoke an\naction by calling \u003ccode\u003e.execute\u003c/code\u003e on its class with \u003ccode\u003ekey: value\u003c/code\u003e arguments, and inspect its status and context like so:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eGreetsPerson\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eexecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003ename: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Han\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esuccess?\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egreeting\u003c/span\u003e \u003cspan class=\"c1\"\u003e# which was a promised context value\u003c/span\u003e\n\u003cspan class=\"k\"\u003eelsif\u003c/span\u003e \u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efailure?\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Rats... I can't say hello to you\"\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eYou will notice that actions are set up to promote simplicity, i.e. they either succeed or fail, and they have\nvery clear inputs and outputs. Ideally, they should do \u003ca href=\"https://en.wikipedia.org/wiki/Single-responsibility_principle\" rel=\"nofollow\"\u003eexactly one thing\u003c/a\u003e. This makes them as easy to test as unit tests.\u003c/p\u003e\n\u003ch3\u003e\n\u003ca id=\"your-first-organizer\" class=\"anchor\" href=\"#your-first-organizer\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eYour first organizer\u003c/h3\u003e\n\u003cp\u003eLightService provides a facility to compose actions using organizers. This is great when you have a business process\nto execute that has multiple steps. By composing actions that do exactly one thing, you can sequence simple\nactions together to perform complex multi-step business processes in a clear manner that is very easy\nto reason about.\u003c/p\u003e\n\u003cp\u003eThere are advanced ways to sequence actions that can be found later in the README, but we'll keep this simple for now.\nFirst, let's add a second action that we can sequence to run after the \u003ccode\u003eGreetsPerson\u003c/code\u003e action from above:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eRandomlyAwardsPrize\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:name\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:greeting\u003c/span\u003e\n  \u003cspan class=\"n\"\u003epromises\u003c/span\u003e \u003cspan class=\"ss\"\u003e:did_i_win\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprize_num\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e__\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egreeting\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elength\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eprizes\u003c/span\u003e     \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"jelly beans\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"ice cream\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"pie\"\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edid_i_win\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e..\u003c/span\u003e\u003cspan class=\"n\"\u003eprize_num\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n    \u003cspan class=\"n\"\u003edid_i_lose\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"o\"\u003e..\u003c/span\u003e\u003cspan class=\"n\"\u003eprize_num\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"mi\"\u003e13\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003edid_i_lose\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e# When failing, send a message as an argument, readable from the return context\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"you are exceptionally unlucky\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e# You can specify 'optional' context items by treating context like a hash.\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e# Useful for when you may or may not be returning extra data. Ideally, selecting\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e# a prize should be a separate action that is only run if you win.\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:prize\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e   \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"lifetime supply of \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eprizes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esample\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003edid_i_win\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edid_i_win\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edid_i_win\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eAnd here's the organizer that ties the two together. You implement a \u003ccode\u003ecall\u003c/code\u003e class method that takes some arguments and\nfrom there sends them to \u003ccode\u003ewith\u003c/code\u003e in \u003ccode\u003ekey: value\u003c/code\u003e format which forms the initial state of the context. From there, chain\n\u003ccode\u003ereduce\u003c/code\u003e to \u003ccode\u003ewith\u003c/code\u003e and send it a list of action class names in sequence. The organizer will call each action, one\nafter the other, and build up the context as it goes along.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eWelcomeAPotentiallyLuckyPerson\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"nb\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eGreetsPerson\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"no\"\u003eRandomlyAwardsPrize\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eWhen an organizer is run, you have access to the context as it passed through all actions, and the overall status\nof the organized execution. You can invoke an organizer by calling \u003ccode\u003e.call\u003c/code\u003e on the class with the expected arguments,\nand inspect its status and context just like you would an action:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eWelcomeAPotentiallyLuckyPerson\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Han\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esuccess?\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003egreeting\u003c/span\u003e \u003cspan class=\"c1\"\u003e# which was a promised context value\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edid_i_win\u003c/span\u003e\n    \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"And you've won a prize! Lucky you. Please see the front desk for your \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eprize\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e.\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"c1\"\u003e# outcome.failure? is true, and we can pull the failure message out of the context for feedback to the user.\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003eputs\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Rats... I can't say hello to you, because \u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eoutcome\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emessage\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e.\"\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eBecause organizers generally run through complex business logic, and every action has the potential to cause a failure,\ntesting an organizer is functionally equivalent to an integration test.\u003c/p\u003e\n\u003cp\u003eFor further examples, please visit the project's \u003ca href=\"https://github.com/adomokos/light-service/wiki\" rel=\"nofollow\"\u003eWiki\u003c/a\u003e and review\nthe \u003ca href=\"#why-lightservice\"\u003e\"Why LightService\" section\u003c/a\u003e above.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"stopping-the-series-of-actions\" class=\"anchor\" href=\"#stopping-the-series-of-actions\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eStopping the Series of Actions\u003c/h2\u003e\n\u003cp\u003eWhen nothing unexpected happens during the organizer's call, the returned \u003ccode\u003econtext\u003c/code\u003e will be successful. Here is how you can check for this:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSomeController\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eApplicationController\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eindex\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresult_context\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eSomeOrganizer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecurrent_user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eresult_context\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esuccess?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eredirect_to\u003c/span\u003e \u003cspan class=\"n\"\u003efoo_path\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:notice\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"Everything went OK! Thanks!\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eflash\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:error\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eresult_context\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emessage\u003c/span\u003e\n      \u003cspan class=\"n\"\u003erender\u003c/span\u003e \u003cspan class=\"ss\"\u003e:action\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"new\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eHowever, sometimes not everything will play out as you expect it. An external API call might not be available or some complex business logic will need to stop the processing of the Series of Actions.\nYou have two options to stop the call chain:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eFailing the context\u003c/li\u003e\n\u003cli\u003eSkipping the rest of the actions\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e\n\u003ca id=\"failing-the-context\" class=\"anchor\" href=\"#failing-the-context\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eFailing the Context\u003c/h3\u003e\n\u003cp\u003eWhen something goes wrong in an action and you want to halt the chain, you need to call \u003ccode\u003efail!\u003c/code\u003e on the context object. This will push the context in a failure state (\u003ccode\u003econtext.failure? # will evalute to true\u003c/code\u003e).\nThe context's \u003ccode\u003efail!\u003c/code\u003e method can take an optional message argument, this message might help describing what went wrong.\nIn case you need to return immediately from the point of failure, you have to do that by calling \u003ccode\u003enext context\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIn case you want to fail the context and stop the execution of the executed block, use the \u003ccode\u003efail_and_return!('something went wrong')\u003c/code\u003e method.\nThis will immediately leave the block, you don't need to call \u003ccode\u003enext context\u003c/code\u003e to return from the block.\u003c/p\u003e\n\u003cp\u003eHere is an example:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSubmitsOrderAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:order\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:mailer\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esubmit_order_successful?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail_and_return!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Failed to submit the order\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# This won't be executed\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emailer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esend_order_notification!\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/fail_actions.png\" target=\"_blank\" rel=\"nofollow\"\u003e\u003cimg src=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/fail_actions.png\" alt=\"fail-actions\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn the example above the organizer called 4 actions. The first 2 actions got executed successfully. The 3rd had a failure, that pushed the context into a failure state and the 4th action was skipped.\u003c/p\u003e\n\u003ch3\u003e\n\u003ca id=\"skipping-the-rest-of-the-actions\" class=\"anchor\" href=\"#skipping-the-rest-of-the-actions\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eSkipping the rest of the actions\u003c/h3\u003e\n\u003cp\u003eYou can skip the rest of the actions by calling \u003ccode\u003econtext.skip_remaining!\u003c/code\u003e. This behaves very similarly to the above-mentioned \u003ccode\u003efail!\u003c/code\u003e mechanism, except this will not push the context into a failure state.\nA good use case for this is executing the first couple of action and based on a check you might not need to execute the rest.\nHere is an example of how you do it:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eChecksOrderStatusAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:order\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esend_notification?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eskip_remaining!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Everything is good, no need to execute the rest of the actions\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/skip_actions.png\" target=\"_blank\" rel=\"nofollow\"\u003e\u003cimg src=\"https://raw.githubusercontent.com/adomokos/light-service/master/resources/skip_actions.png\" alt=\"skip-actions\" style=\"max-width:100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn the example above the organizer called 4 actions. The first 2 actions got executed successfully. The 3rd decided to skip the rest, the 4th action was not invoked. The context was successful.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"benchmarking-actions-with-around-advice\" class=\"anchor\" href=\"#benchmarking-actions-with-around-advice\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eBenchmarking Actions with Around Advice\u003c/h2\u003e\n\u003cp\u003eBenchmarking your action is needed when you profile the series of actions. You could add benchmarking logic to each and every action, however, that would blur the business logic you have in your actions.\u003c/p\u003e\n\u003cp\u003eTake advantage of the organizer's \u003ccode\u003earound_each\u003c/code\u003e method, which wraps the action calls as its reducing them in order.\u003c/p\u003e\n\u003cp\u003eCheck out this example:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eLogDuration\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003estart_time\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enow\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003eyield\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eduration\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eTime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enow\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"n\"\u003estart_time\u003c/span\u003e\n    \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"ss\"\u003e:action\u003c/span\u003e   \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecurrent_action\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"ss\"\u003e:duration\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eduration\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eresult\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCalculatesTax\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:order\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003earound_each\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eLogDuration\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eLooksUpTaxPercentageAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eCalculatesOrderTaxAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eProvidesFreeShippingAction\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eAny object passed into \u003ccode\u003earound_each\u003c/code\u003e must respond to #call with two arguments: the action name and the context it will execute with. It is also passed a block, where LightService's action execution will be done in, so the result must be returned. While this is a little work, it also gives you before and after state access to the data for any auditing and/or checks you may need to accomplish.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"before-and-after-action-hooks\" class=\"anchor\" href=\"#before-and-after-action-hooks\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eBefore and After Action Hooks\u003c/h2\u003e\n\u003cp\u003eIn case you need to inject code right before and after the actions are executed, you can use the \u003ccode\u003ebefore_actions\u003c/code\u003e and \u003ccode\u003eafter_actions\u003c/code\u003e hooks. It accepts one or multiple lambdas that the Action implementation will invoke. This addition to LightService is a great way to decouple instrumentation from business logic.\u003c/p\u003e\n\u003cp\u003eConsider this code:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSomeOrganizer\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eactions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eactions\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eOneAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eTwoAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eThreeAction\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTwoAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003e:logger\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# Logging information\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erole\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s1\"\u003e'admin'\u003c/span\u003e\n       \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'admin is doing something'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edo_something\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThe logging logic makes \u003ccode\u003eTwoAction\u003c/code\u003e more complex, there is more code for logging than for business logic.\u003c/p\u003e\n\u003cp\u003eYou have two options to decouple instrumentation from real logic with \u003ccode\u003ebefore_actions\u003c/code\u003e and \u003ccode\u003eafter_actions\u003c/code\u003e hooks:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eDeclare your hooks in the Organizer\u003c/li\u003e\n\u003cli\u003eAttach hooks to the Organizer from the outside\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThis is how you can declaratively add before and after hooks to the Organizer:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSomeOrganizer\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n  \u003cspan class=\"n\"\u003ebefore_actions\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elambda\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n                           \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecurrent_action\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"no\"\u003eTwoAction\u003c/span\u003e\n                             \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erole\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s1\"\u003e'admin'\u003c/span\u003e\n                             \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'admin is doing something'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                           \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n                         \u003cspan class=\"k\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eafter_actions\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elambda\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n                          \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecurrent_action\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"no\"\u003eTwoAction\u003c/span\u003e\n                            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erole\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s1\"\u003e'admin'\u003c/span\u003e\n                            \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'admin is DONE doing something'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n                          \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n                        \u003cspan class=\"k\"\u003eend\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eactions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eactions\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eOneAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eTwoAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eThreeAction\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTwoAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edo_something\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eNote how the action has no logging logic after this change. Also, you can target before and after action logic for specific actions, as the \u003ccode\u003ectx.current_action\u003c/code\u003e will have the class name of the currently processed action. In the example above, logging will occur only for \u003ccode\u003eTwoAction\u003c/code\u003e and not for \u003ccode\u003eOneAction\u003c/code\u003e or \u003ccode\u003eThreeAction\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eHere is how you can declaratively add \u003ccode\u003ebefore_hooks\u003c/code\u003e or \u003ccode\u003eafter_hooks\u003c/code\u003e to your Organizer from the outside:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"no\"\u003eSomeOrganizer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebefore_actions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"nb\"\u003elambda\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecurrent_action\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"no\"\u003eTwoAction\u003c/span\u003e\n      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erole\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s1\"\u003e'admin'\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003einfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'admin is doing something'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThese ideas are originally from Aspect Oriented Programming, read more about them \u003ca href=\"https://en.wikipedia.org/wiki/Aspect-oriented_programming\" rel=\"nofollow\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"expects-and-promises\" class=\"anchor\" href=\"#expects-and-promises\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eExpects and Promises\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003eexpects\u003c/code\u003e and \u003ccode\u003epromises\u003c/code\u003e macros are rules for the inputs/outputs of an action.\n\u003ccode\u003eexpects\u003c/code\u003e describes what keys it needs to execute, and \u003ccode\u003epromises\u003c/code\u003e makes sure the keys are in the context after the\naction is reduced. If either of them are violated, a custom exception is thrown.\u003c/p\u003e\n\u003cp\u003eThis is how it's used:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFooAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:baz\u003c/span\u003e\n  \u003cspan class=\"n\"\u003epromises\u003c/span\u003e \u003cspan class=\"ss\"\u003e:bar\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebaz\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efetch\u003c/span\u003e \u003cspan class=\"ss\"\u003e:baz\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003ebar\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebaz\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:bar\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebar\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThe \u003ccode\u003eexpects\u003c/code\u003e macro does a bit more for you: it pulls the value with the expected key from the context, and\nmakes it available to you through a reader. You can refactor the action like this:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFooAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:baz\u003c/span\u003e\n  \u003cspan class=\"n\"\u003epromises\u003c/span\u003e \u003cspan class=\"ss\"\u003e:bar\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ebar\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebaz\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:bar\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ebar\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThe \u003ccode\u003epromises\u003c/code\u003e macro will not only check if the context has the promised keys, it also sets it for you in the context if\nyou use the accessor with the same name. The code above can be further simplified:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFooAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:baz\u003c/span\u003e\n  \u003cspan class=\"n\"\u003epromises\u003c/span\u003e \u003cspan class=\"ss\"\u003e:bar\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebar\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ebaz\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eTake a look at \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/action_expects_and_promises_spec.rb\" rel=\"nofollow\"\u003ethis spec\u003c/a\u003e to see the refactoring in action.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"key-aliases\" class=\"anchor\" href=\"#key-aliases\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eKey Aliases\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003ealiases\u003c/code\u003e macro sets up pairs of keys and aliases in an organizer. Actions can access the context using the aliases.\u003c/p\u003e\n\u003cp\u003eThis allows you to put together existing actions from different sources and have them work together without having to modify their code. Aliases will work with or without action \u003ccode\u003eexpects\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eSay for example you have actions \u003ccode\u003eAnAction\u003c/code\u003e and \u003ccode\u003eAnotherAction\u003c/code\u003e that you've used in previous projects.  \u003ccode\u003eAnAction\u003c/code\u003e provides \u003ccode\u003e:my_key\u003c/code\u003e but \u003ccode\u003eAnotherAction\u003c/code\u003e needs to use that value but expects \u003ccode\u003e:key_alias\u003c/code\u003e.  You can use them together in an organizer like so:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAnOrganizer\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003ealiases\u003c/span\u003e \u003cspan class=\"ss\"\u003e:my_key\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"ss\"\u003e:key_alias\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:order\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eorder\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eAnAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eAnotherAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAnAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003epromises\u003c/span\u003e \u003cspan class=\"ss\"\u003e:my_key\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emy_key\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\"value\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eAnotherAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:key_alias\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ekey_alias\u003c/span\u003e \u003cspan class=\"c1\"\u003e# =\u0026gt; \"value\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003ch2\u003e\n\u003ca id=\"logging\" class=\"anchor\" href=\"#logging\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eLogging\u003c/h2\u003e\n\u003cp\u003eEnable LightService's logging to better understand what goes on within the series of actions,\nwhat's in the context or when an action fails.\u003c/p\u003e\n\u003cp\u003eLogging in LightService is turned off by default. However, turning it on is simple. Add this line to your\nproject's config file:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elogger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eSTDOUT\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eYou can turn off the logger by setting it to nil or \u003ccode\u003e/dev/null\u003c/code\u003e.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elogger\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s1\"\u003e'/dev/null'\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eWatch the console while you are executing the workflow through the organizer. You should see something like this:\u003c/p\u003e\n\u003cpre lang=\"bash\" class=\"highlight-bash\"\u003eI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - calling organizer \u0026lt;TestDoubles::MakesTeaAndCappuccino\u0026gt;\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -     keys \u003cspan class=\"k\"\u003ein \u003c/span\u003econtext: :tea, :milk, :coffee\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - executing \u0026lt;TestDoubles::MakesTeaWithMilkAction\u0026gt;\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -   expects: :tea, :milk\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -   promises: :milk_tea\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -     keys \u003cspan class=\"k\"\u003ein \u003c/span\u003econtext: :tea, :milk, :coffee, :milk_tea\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - executing \u0026lt;TestDoubles::MakesLatteAction\u0026gt;\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -   expects: :coffee, :milk\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -   promises: :latte\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -     keys \u003cspan class=\"k\"\u003ein \u003c/span\u003econtext: :tea, :milk, :coffee, :milk_tea, :latte\n\u003c/pre\u003e\n\u003cp\u003eThe log provides a blueprint of the series of actions. You can see what organizer is invoked, what actions\nare called in what order, what do the expect and promise and most importantly what keys you have in the context\nafter each action is executed.\u003c/p\u003e\n\u003cp\u003eThe logger logs its messages with \"INFO\" level. The exception to this is the event when an action fails the context.\nThat message is logged with \"WARN\" level:\u003c/p\u003e\n\u003cpre lang=\"bash\" class=\"highlight-bash\"\u003eI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - calling organizer \u0026lt;TestDoubles::MakesCappuccinoAddsTwoAndFails\u0026gt;\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -     keys \u003cspan class=\"k\"\u003ein \u003c/span\u003econtext: :milk, :coffee\nW, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  WARN \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - :-\u003cspan class=\"o\"\u003e(((\u003c/span\u003e \u0026lt;TestDoubles::MakesLatteAction\u0026gt; has failed...\nW, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  WARN \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - context message: Can\u003cspan class=\"s1\"\u003e't make a latte from a milk that'\u003c/span\u003es too hot!\n\u003c/pre\u003e\n\u003cp\u003eThe log message will show you what message was added to the context when the action pushed the\ncontext into a failure state.\u003c/p\u003e\n\u003cp\u003eThe event of skipping the rest of the actions is also captured by its logs:\u003c/p\u003e\n\u003cpre lang=\"bash\" class=\"highlight-bash\"\u003eI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - calling organizer \u0026lt;TestDoubles::MakesCappuccinoSkipsAddsTwo\u0026gt;\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] -     keys \u003cspan class=\"k\"\u003ein \u003c/span\u003econtext: :milk, :coffee\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - \u003cspan class=\"p\"\u003e;\u003c/span\u003e-\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u0026lt;TestDoubles::MakesLatteAction\u0026gt; has decided to skip the rest of the actions\nI, \u003cspan class=\"o\"\u003e[\u003c/span\u003eDATE]  INFO \u003cspan class=\"nt\"\u003e--\u003c/span\u003e : \u003cspan class=\"o\"\u003e[\u003c/span\u003eLightService] - context message: Can\u003cspan class=\"s1\"\u003e't make a latte with a fatty milk like that!\n\u003c/span\u003e\u003c/pre\u003e\n\u003cp\u003eYou can specify the logger on the organizer level, so the organizer does not use the global logger.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFooOrganizer\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elog_with\u003c/span\u003e \u003cspan class=\"no\"\u003eLogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"/my/special.log\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003ch2\u003e\n\u003ca id=\"error-codes\" class=\"anchor\" href=\"#error-codes\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eError Codes\u003c/h2\u003e\n\u003cp\u003eYou can add some more structure to your error handling by taking advantage of error codes in the context.\nNormally, when something goes wrong in your actions, you fail the process by setting the context to failure:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFooAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"I don't like what happened here.\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eHowever, you might need to handle the errors coming from your action pipeline differently.\nUsing an error code can help you check what type of expected error occurred in the organizer\nor in the actions.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFooAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eservice_call\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esuccess?\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Service call failed\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eerror_code: \u003c/span\u003e\u003cspan class=\"mi\"\u003e1001\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"c1\"\u003e# Do something else\u003c/span\u003e\n\n    \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eentity\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esave\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Saving the entity failed\"\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003eerror_code: \u003c/span\u003e\u003cspan class=\"mi\"\u003e2001\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003ch2\u003e\n\u003ca id=\"action-rollback\" class=\"anchor\" href=\"#action-rollback\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eAction Rollback\u003c/h2\u003e\n\u003cp\u003eSometimes your action has to undo what it did when an error occurs. Think about a chain of actions where you need\nto persist records in your data store in one action and you have to call an external service in the next. What happens if there\nis an error when you call the external service? You want to remove the records you previously saved. You can do it now with\nthe \u003ccode\u003erolled_back\u003c/code\u003e macro.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSaveEntities\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n  \u003cspan class=\"n\"\u003eexpects\u003c/span\u003e \u003cspan class=\"ss\"\u003e:user\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esave!\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003erolled_back\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edestroy\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eYou need to call the \u003ccode\u003efail_with_rollback!\u003c/code\u003e method to initiate a rollback for actions starting with the action where the failure\nwas triggered.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCallExternalApi\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eapi_call_result\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eSomeAPI\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esave_user\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail_with_rollback!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"Error when calling external API\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eapi_call_result\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efailure?\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eUsing the \u003ccode\u003erolled_back\u003c/code\u003e macro is optional for the actions in the chain. You shouldn't care about undoing non-persisted changes.\u003c/p\u003e\n\u003cp\u003eThe actions are rolled back in reversed order from the point of failure starting with the action that triggered it.\u003c/p\u003e\n\u003cp\u003eSee \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/rollback_spec.rb\" rel=\"nofollow\"\u003ethis acceptance test\u003c/a\u003e to learn more about this functionality.\u003c/p\u003e\n\u003cp\u003eYou may find yourself directly using an action that can roll back by calling \u003ccode\u003e.execute\u003c/code\u003e instead of using it from within an Organizer.\nIf this action fails and attempts a rollback, a \u003ccode\u003eFailWithRollbackError\u003c/code\u003e exception will be raised. This is so that the organizer can\nrollback the actions one by one. If you don't want to wrap your call to the action with a \u003ccode\u003ebegin, rescue FailWithRollbackError\u003c/code\u003e\nblock, you can introspect the context like so, and keep your usage of the action clean:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFooAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# context.organized_by will be nil if run from an action,\u003c/span\u003e\n    \u003cspan class=\"c1\"\u003e# or will be the class name if run from an organizer\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eorganized_by\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enil?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail_with_rollback!\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003ch2\u003e\n\u003ca id=\"localizing-messages\" class=\"anchor\" href=\"#localizing-messages\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eLocalizing Messages\u003c/h2\u003e\n\u003cp\u003eBy default LightService provides a mechanism for easily translating your error or success messages via I18n.  You can also provide your own custom localization adapter if your application's logic is more complex than what is shown here.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eFooAction\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eunless\u003c/span\u003e \u003cspan class=\"n\"\u003eservice_call\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003esuccess?\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:exceeded_api_limit\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n      \u003cspan class=\"c1\"\u003e# The failure message used here equates to:\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e# I18n.t(:exceeded_api_limit, scope: \"foo_action.light_service.failures\")\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThis also works with nested classes via the ActiveSupport \u003ccode\u003e#underscore\u003c/code\u003e method, just as ActiveRecord performs localization lookups on models placed inside a module.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003ePaymentGateway\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCaptureFunds\u003c/span\u003e\n    \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eapi_service\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efailed?\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:funds_not_available\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n      \u003cspan class=\"c1\"\u003e# this failure message equates to:\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e# I18n.t(:funds_not_available, scope: \"payment_gateway/capture_funds.light_service.failures\")\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eIf you need to provide custom variables for interpolation during localization, pass that along in a hash.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"nn\"\u003ePaymentGateway\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eCaptureFunds\u003c/span\u003e\n    \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eAction\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eexecuted\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eapi_service\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efailed?\u003c/span\u003e\n        \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efail!\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:funds_not_available\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"ss\"\u003elast_four: \u003c/span\u003e\u003cspan class=\"s2\"\u003e\"1234\"\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n      \u003cspan class=\"c1\"\u003e# this failure message equates to:\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e# I18n.t(:funds_not_available, last_four: \"1234\", scope: \"payment_gateway/capture_funds.light_service.failures\")\u003c/span\u003e\n\n      \u003cspan class=\"c1\"\u003e# the translation string itself being:\u003c/span\u003e\n      \u003cspan class=\"c1\"\u003e# =\u0026gt; \"Unable to process your payment for account ending in %{last_four}\"\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eTo provide your own custom adapter, use the configuration setting and subclass the default adapter LightService provides.\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eConfiguration\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003elocalization_adapter\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eMyLocalizer\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003enew\u003c/span\u003e\n\n\u003cspan class=\"c1\"\u003e# lib/my_localizer.rb\u003c/span\u003e\n\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eMyLocalizer\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eLocalizationAdapter\u003c/span\u003e\n\n  \u003cspan class=\"c1\"\u003e# I just want to change the default lookup path\u003c/span\u003e\n  \u003cspan class=\"c1\"\u003e# =\u0026gt; \"light_service.failures.payment_gateway/capture_funds\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ei18n_scope_from_class\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eaction_class\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"s2\"\u003e\"light_service.\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003epluralize\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e.\u003c/span\u003e\u003cspan class=\"si\"\u003e#{\u003c/span\u003e\u003cspan class=\"n\"\u003eaction_class\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eunderscore\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\"\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eTo get the value of a \u003ccode\u003efail!\u003c/code\u003e or \u003ccode\u003esucceed!\u003c/code\u003e message, simply call \u003ccode\u003e#message\u003c/code\u003e on the returned context.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"orchestrator-logic-in-organizers\" class=\"anchor\" href=\"#orchestrator-logic-in-organizers\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eOrchestrator Logic in Organizers\u003c/h2\u003e\n\u003cp\u003eThe Organizer - Action combination works really well for simple use cases. However, as business logic gets more complex, or when LightService is used in an ETL workflow, the code that routes the different organizers becomes very complex and imperative. Let's look at a piece of code that does basic data transformations:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExtractsTransformsLoadsData\u003c/span\u003e\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eRetrievesConnectionInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003ePullsDataFromRemoteApi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eretrieved_items\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eretrieved_items\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003eretrieved_items\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eempty?\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eNotifiesEngineeringTeamAction\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eexecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003eretrieved_items\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eeach\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e\u003cspan class=\"n\"\u003eitem\u003c/span\u003e\u003cspan class=\"o\"\u003e|\u003c/span\u003e\n      \u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"ss\"\u003e:item\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eitem\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eTransformsData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n    \u003cspan class=\"n\"\u003econtext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"no\"\u003eLoadsData\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"no\"\u003eSendsNotifications\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThe \u003ccode\u003eLightService::Context\u003c/code\u003e is initialized with the first action, that context is passed around among organizers and actions. This code is still simpler than many out there, but it feels very imperative: it has conditionals, iterators in it. Let's see how we could make it a bit more simpler with a declarative style:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eExtractsTransformsLoadsData\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:connection\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003econnection\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eactions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eactions\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eRetrievesConnectionInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"no\"\u003ePullsDataFromRemoteApi\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"n\"\u003ereduce_if\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eretrieved_items\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eempty?\u003c/span\u003e \u003cspan class=\"p\"\u003e},\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eNotifiesEngineeringTeamAction\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e]),\u003c/span\u003e\n      \u003cspan class=\"n\"\u003eiterate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:retrieved_items\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"no\"\u003eTransformsData\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e]),\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eLoadsData\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"no\"\u003eSendsNotifications\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThis code is much easier to reason about, it's less noisy and it captures the goal of LightService well: simple, declarative code that's easy to understand.\u003c/p\u003e\n\u003cp\u003eThe 7 different orchestrator constructs an organizer can have:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003ereduce_until\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ereduce_if\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eiterate\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eexecute\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewith_callback\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eadd_to_context\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eadd_aliases\u003c/code\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ccode\u003ereduce_until\u003c/code\u003e behaves like a while loop in imperative languages, it iterates until the provided predicate in the lambda evaluates to true. Take a look at \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/reduce_until_spec.rb\" rel=\"nofollow\"\u003ethis acceptance test\u003c/a\u003e to see how it's used.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ereduce_if\u003c/code\u003e will reduce the included organizers and/or actions if the predicate in the lambda evaluates to true. \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/reduce_if_spec.rb\" rel=\"nofollow\"\u003eThis acceptance test\u003c/a\u003e describes this functionality.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eiterate\u003c/code\u003e gives your iteration logic, the symbol you define there has to be in the context as a key. For example, to iterate over items you will use \u003ccode\u003eiterate(:items)\u003c/code\u003e in your steps, the context needs to have \u003ccode\u003eitems\u003c/code\u003e as a key, otherwise it will fail. The organizer will singularize the collection name and will put the actual item into the context under that name. Remaining with the example above, each element will be accessible by the name \u003ccode\u003eitem\u003c/code\u003e for the actions in the \u003ccode\u003eiterate\u003c/code\u003e steps. \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/iterate_spec.rb\" rel=\"nofollow\"\u003eThis acceptance test\u003c/a\u003e should provide you with an example.\u003c/p\u003e\n\u003cp\u003eTo take advantage of another organizer or action, you might need to tweak the context a bit. Let's say you have a hash, and you need to iterate over its values in a series of action. To alter the context and have the values assigned into a variable, you need to create a new action with 1 line of code in it. That seems a lot of ceremony for a simple change. You can do that in a \u003ccode\u003eexecute\u003c/code\u003e method like this \u003ccode\u003eexecute(-\u0026gt;(ctx) { ctx[:some_values] = ctx.some_hash.values })\u003c/code\u003e. \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/execute_spec.rb\" rel=\"nofollow\"\u003eThis test\u003c/a\u003e describes how you can use it.\u003c/p\u003e\n\u003cp\u003eUse \u003ccode\u003ewith_callback\u003c/code\u003e when you want to execute actions with a deferred and controlled callback. It works similar to a Sax parser, I've used it for processing large files. The advantage of it is not having to keep large amount of data in memory. See \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/with_callback_spec.rb\" rel=\"nofollow\"\u003ethis acceptance test\u003c/a\u003e as a working example.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eadd_to_context\u003c/code\u003e can add key-value pairs on the fly to the context. This functionality is useful when you need a value injected into the context under a specific key right before the subsequent actions are executed. \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/add_to_context_spec.rb\" rel=\"nofollow\"\u003eThis test\u003c/a\u003e describes its functionality.\u003c/p\u003e\n\u003cp\u003eYour action needs a certain key in the context but it's under a different one? Use the function \u003ccode\u003eadd_aliases\u003c/code\u003e to alias an existing key in the context under the desired key. Take a look at \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/organizer/add_aliases_spec.rb\" rel=\"nofollow\"\u003ethis test\u003c/a\u003e to see an example.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"contextfactory-for-faster-action-testing\" class=\"anchor\" href=\"#contextfactory-for-faster-action-testing\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eContextFactory for Faster Action Testing\u003c/h2\u003e\n\u003cp\u003eAs the complexity of your workflow increases, you will find yourself spending more and more time creating a context (LightService::Context it is) for your action tests. Some of this code can be reused by clever factories, but still, you are using a context that is artificial, and can be different from what the previous actions produced. This is especially true, when you use LightService in ETLs, where you start out with initial data and your actions are mutating its state.\u003c/p\u003e\n\u003cp\u003eHere is an example:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSomeOrganizer\u003c/span\u003e\n  \u003cspan class=\"kp\"\u003eextend\u003c/span\u003e \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eOrganizer\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ecall\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003ereduce\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eactions\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nc\"\u003eself\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eactions\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n       \u003cspan class=\"no\"\u003eETL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eParsesPayloadAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n       \u003cspan class=\"no\"\u003eETL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eBuildsEnititiesAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n       \u003cspan class=\"no\"\u003eETL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eSetsUpMappingsAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n       \u003cspan class=\"no\"\u003eETL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eSavesEntitiesAction\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n       \u003cspan class=\"no\"\u003eETL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eSendsNotificationAction\u003c/span\u003e\n    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eYou should test your workflow from the outside, invoking the organizer’s \u003ccode\u003ecall\u003c/code\u003e method and verify that the data was properly created or updated in your data store. However, sometimes you need to zoom into one action, and setting up the context to test it is tedious work. This is where \u003ccode\u003eContextFactory\u003c/code\u003e can be helpful.\u003c/p\u003e\n\u003cp\u003eIn order to test the third action \u003ccode\u003eETL::SetsUpMappingAction\u003c/code\u003e, you have to have several entities in the context. Depending on the logic you need to write code for, this could be a lot of work. However, by using the \u003ccode\u003eContextFactory\u003c/code\u003e in your spec, you could easily have a prepared context that’s ready for testing:\u003c/p\u003e\n\u003cpre lang=\"ruby\" class=\"highlight-ruby\"\u003e\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'spec_helper'\u003c/span\u003e\n\u003cspan class=\"nb\"\u003erequire\u003c/span\u003e \u003cspan class=\"s1\"\u003e'light-service/testing'\u003c/span\u003e\n\n\u003cspan class=\"no\"\u003eRSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003edescribe\u003c/span\u003e \u003cspan class=\"no\"\u003eETL\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eSetsUpMappingsAction\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n  \u003cspan class=\"n\"\u003elet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:context\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"no\"\u003eLightService\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eTesting\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"no\"\u003eContextFactory\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003emake_from\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003eSomeOrganizer\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efor\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edescribed_class\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"ss\"\u003e:payload\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"no\"\u003eFile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eread\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"err\"\u003e‘\u003c/span\u003e\u003cspan class=\"n\"\u003espec\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003epayload\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ejson\u003c/span\u003e\u003cspan class=\"err\"\u003e’\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\n  \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"err\"\u003e‘\u003c/span\u003e\u003cspan class=\"n\"\u003eworks\u003c/span\u003e \u003cspan class=\"n\"\u003elike\u003c/span\u003e \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"n\"\u003eshould\u003c/span\u003e\u003cspan class=\"err\"\u003e’\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eresult\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edescribed_class\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eexecute\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"n\"\u003eexpect\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresult\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eto\u003c/span\u003e \u003cspan class=\"n\"\u003ebe_success\u003c/span\u003e\n  \u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003cspan class=\"k\"\u003eend\u003c/span\u003e\n\u003c/pre\u003e\n\u003cp\u003eThis context then can be passed to the action under test, freeing you up from the 20 lines of factory or fixture calls to create a context for your specs.\u003c/p\u003e\n\u003cp\u003eIn case your organizer has more logic in its \u003ccode\u003ecall\u003c/code\u003e method, you could create your own test organizer in your specs like you can see it in this \u003ca href=\"https://github.com/adomokos/light-service/blob/master/spec/acceptance/testing/context_factory_spec.rb#L4-L11\" rel=\"nofollow\"\u003eacceptance test\u003c/a\u003e. This is reusable in all your action tests.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"rails-support\" class=\"anchor\" href=\"#rails-support\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eRails support\u003c/h2\u003e\n\u003cp\u003eLightService includes Rails generators for creating both Organizers and Actions along with corresponding tests. Currently only RSpec is\nsupported (\u003ca href=\"https://github.com/adomokos/light-service/pulls\" rel=\"nofollow\"\u003ePR's for supporting MiniTest are welcome\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003eNote: Generators are namespaced to \u003ccode\u003elight_service\u003c/code\u003e not \u003ccode\u003elight-service\u003c/code\u003e due to Rake name constraints.\u003c/p\u003e\n\u003ch3\u003e\n\u003ca id=\"organizer-generation\" class=\"anchor\" href=\"#organizer-generation\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eOrganizer generation\u003c/h3\u003e\n\u003cpre lang=\"shell\" class=\"highlight-shell\"\u003erails generate light_service:organizer My::SuperFancy::Organizer\n\u003cspan class=\"c\"\u003e# -- or\u003c/span\u003e\nrails generate light_service:organizer my/super_fancy/organizer\n\u003c/pre\u003e\n\u003cp\u003eOptions for this generator are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e--dir=\u0026lt;SOME_DIR\u0026gt;\u003c/code\u003e. \u003ccode\u003e\u0026lt;SOME_DIR\u0026gt;\u003c/code\u003e defaults to \u003ccode\u003eorganizers\u003c/code\u003e. Will write organizers to \u003ccode\u003e/app/organizers\u003c/code\u003e, and specs to \u003ccode\u003e/spec/organizers\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e--no-tests\u003c/code\u003e. Default is \u003ccode\u003e--tests\u003c/code\u003e. Will generate a test file matching the namespace you've supplied.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e\n\u003ca id=\"action-generation\" class=\"anchor\" href=\"#action-generation\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eAction generation\u003c/h3\u003e\n\u003cpre lang=\"shell\" class=\"highlight-shell\"\u003erails generate light_service:action My::SuperFancy::Action\n\u003cspan class=\"c\"\u003e# -- or\u003c/span\u003e\nrails generate light_service:action my/super_fancy/action\n\u003c/pre\u003e\n\u003cp\u003eOptions for this generator are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e--dir=\u0026lt;SOME_DIR\u0026gt;\u003c/code\u003e. \u003ccode\u003e\u0026lt;SOME_DIR\u0026gt;\u003c/code\u003e defaults to \u003ccode\u003eactions\u003c/code\u003e. Will write actions to \u003ccode\u003e/app/actions\u003c/code\u003e, and specs to \u003ccode\u003e/spec/actions\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e--no-tests\u003c/code\u003e. Defaults is \u003ccode\u003e--tests\u003c/code\u003e. Will generate a test file matching the namespace you've supplied.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e--no-roll-back\u003c/code\u003e. Default is \u003ccode\u003e--roll-back\u003c/code\u003e. Will generate a \u003ccode\u003erolled_back\u003c/code\u003e block for you to implement with \u003ca href=\"#action-rollback\"\u003eroll back functionality\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e\n\u003ca id=\"advanced-action-generation\" class=\"anchor\" href=\"#advanced-action-generation\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eAdvanced action generation\u003c/h3\u003e\n\u003cp\u003eYou are able to optionally specify \u003ccode\u003eexpects\u003c/code\u003e and/or \u003ccode\u003epromises\u003c/code\u003e keys during generation\u003c/p\u003e\n\u003cpre lang=\"shell\" class=\"highlight-shell\"\u003erails generate light_service:action CrankWidget expects:one_fish,two_fish promises:red_fish,blue_fish\n\u003c/pre\u003e\n\u003cp\u003eWhen specifying \u003ccode\u003eexpects\u003c/code\u003e, convenience variables will be initialized in the \u003ccode\u003eexecuted\u003c/code\u003e block so that you don't have to call\nthem through the context. A stub context will be created in the test file using these keys too.\u003c/p\u003e\n\u003cp\u003eWhen specifying \u003ccode\u003epromises\u003c/code\u003e, specs will be created testing for their existence after executing the action.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"contributing\" class=\"anchor\" href=\"#contributing\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eContributing\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eFork it\u003c/li\u003e\n\u003cli\u003eCreate your feature branch (\u003ccode\u003egit checkout -b my-new-feature\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eCommit your changes (\u003ccode\u003egit commit -am 'Added some feature'\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003ePush to the branch (\u003ccode\u003egit push origin my-new-feature\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eCreate new Pull Request\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eHuge thanks to the \u003ca href=\"https://github.com/adomokos/light-service/graphs/contributors\" rel=\"nofollow\"\u003econtributors\u003c/a\u003e!\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"release-notes\" class=\"anchor\" href=\"#release-notes\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eRelease Notes\u003c/h2\u003e\n\u003cp\u003eFollow the release notes in this \u003ca href=\"https://github.com/adomokos/light-service/blob/master/RELEASES.md\" rel=\"nofollow\"\u003edocument\u003c/a\u003e.\u003c/p\u003e\n\u003ch2\u003e\n\u003ca id=\"license\" class=\"anchor\" href=\"#license\" aria-hidden=\"true\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003eLicense\u003c/h2\u003e\n\u003cp\u003eLightService is released under the \u003ca href=\"http://www.opensource.org/licenses/MIT\" rel=\"nofollow\"\u003eMIT License\u003c/a\u003e.\u003c/p\u003e\n\u003c/body\u003e\u003c/html\u003e\n","project_id":6458053,"name":"light-service","owner_login":"adomokos","description":"Series of Actions with an emphasis on simplicity.","pushed_at":"2021-01-05T03:56:08.000Z","stargazers_count":525,"open_issues_count":11,"has_downloads":true,"archived":false,"license_key":"mit","homepage":"","private":false,"project_created_at":"2012-10-30T13:56:13.000Z","project_updated_at":"2021-01-13T20:45:03.000Z","language":null,"added_language_topic":false},"categories":[{"name":"Advertising","topicsCount":10},{"name":"Application Programming Interfaces","topicsCount":124},{"name":"Applications","topicsCount":192},{"name":"Artificial Intelligence","topicsCount":78},{"name":"Blockchain","topicsCount":73},{"name":"Build Tools","topicsCount":113},{"name":"Cloud Computing","topicsCount":80},{"name":"Code Quality","topicsCount":28},{"name":"Collaboration","topicsCount":32},{"name":"Command Line Interface","topicsCount":49},{"name":"Community","topicsCount":83},{"name":"Companies","topicsCount":60},{"name":"Compilers","topicsCount":63},{"name":"Computer Science","topicsCount":80},{"name":"Configuration Management","topicsCount":42},{"name":"Content Management","topicsCount":175},{"name":"Control Flow","topicsCount":213},{"name":"Data Formats","topicsCount":78},{"name":"Data Processing","topicsCount":276},{"name":"Data Storage","topicsCount":135},{"name":"Economics","topicsCount":64},{"name":"Frameworks","topicsCount":215},{"name":"Games","topicsCount":129},{"name":"Graphics","topicsCount":110},{"name":"Hardware","topicsCount":152},{"name":"Integrated Development Environments","topicsCount":49},{"name":"Learning Resources","topicsCount":166},{"name":"Legal","topicsCount":29},{"name":"Libraries","topicsCount":129},{"name":"Lists Of Projects","topicsCount":22},{"name":"Machine Learning","topicsCount":347},{"name":"Mapping","topicsCount":64},{"name":"Marketing","topicsCount":15},{"name":"Mathematics","topicsCount":55},{"name":"Media","topicsCount":239},{"name":"Messaging","topicsCount":98},{"name":"Networking","topicsCount":315},{"name":"Operating Systems","topicsCount":89},{"name":"Operations","topicsCount":121},{"name":"Package Managers","topicsCount":55},{"name":"Programming Languages","topicsCount":245},{"name":"Runtime Environments","topicsCount":100},{"name":"Science","topicsCount":42},{"name":"Security","topicsCount":396},{"name":"Social Media","topicsCount":27},{"name":"Software Architecture","topicsCount":72},{"name":"Software Development","topicsCount":72},{"name":"Software Performance","topicsCount":58},{"name":"Software Quality","topicsCount":133},{"name":"Text Editors","topicsCount":49},{"name":"Text Processing","topicsCount":136},{"name":"User Interface","topicsCount":330},{"name":"User Interface Components","topicsCount":514},{"name":"Version Control","topicsCount":30},{"name":"Virtualization","topicsCount":71},{"name":"Web Browsers","topicsCount":42},{"name":"Web Servers","topicsCount":26},{"name":"Web User Interface","topicsCount":210},{"name":"All Projects","topicsCount":0}],"advertisement":{"variation":"project","title":"Become A Software Engineer At Top Companies","description":"Identify your strengths with a free online coding quiz, and skip resume and recruiter screens at multiple companies at once.  It's free, confidential, includes a free flight and hotel, along with help to study to pass interviews and negotiate a high salary!","url":"https://triplebyte.com/a/PGNifkM/pt2"},"nonCommercial":false,"nonDerivative":false}</script>
      



    <!-- load synchronously before app bundle so adsbygoogle is always defined, google's new ad code doesn't seem to like this, at least for the initial review  -->
    <!-- try loading programatically and async with a callback to push the ads and see if it helps page load speed -->
    <!--script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script-->
    <script src="/packs/root-bundle-1f53b6db74aa6b1bef19.js"></script>
  </body>
</html>
