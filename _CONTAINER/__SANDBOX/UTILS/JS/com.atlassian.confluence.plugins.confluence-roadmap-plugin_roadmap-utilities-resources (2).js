WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-helper.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.Helper={getPosXOnMonthTimeline:function(g,e){var j=moment(g.startDate).startOf("month");var f=moment(e).startOf("month");var d=c.DateUtilities.getNumberOfMonths(j,f);var i=d*Roadmap.MONTH_WIDTH;var h=c.DateUtilities.getMilisecondsFromStartMonth(e)*Roadmap.MONTH_WIDTH/c.DateUtilities.getMilisecondsInMonth(e);return Math.round(i+h)},getPosXOnWeekTimeline:function(g,d){var e=moment(g.startDate).startOf("isoWeek");var f=moment(d).diff(e,"weeks",true);var h=f*Roadmap.WEEK_WIDTH;return Math.round(h)},getWidthTimeline:function(f,e){var d=e.duration;if(f.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){d*=Roadmap.MONTH_WIDTH}else{d*=Roadmap.WEEK_WIDTH}return d<Roadmap.EXTRA_SPACE_AROUND?0:Math.round(d-Roadmap.EXTRA_SPACE_AROUND)},getMonthStartDateByPosition:function(i,h){var d=Math.floor(h/Roadmap.MONTH_WIDTH);var g=moment(i.startDate).startOf("month");var e=g.add(d,"months").toDate();var f=Math.abs(h)%Roadmap.MONTH_WIDTH;if(f!==0&&d<0){f=Roadmap.MONTH_WIDTH-f}var j=c.DateUtilities.getMilisecondsInMonth(e)*f/Roadmap.MONTH_WIDTH;return new Date(e.getTime()+j)},getWeekStartDateByPosition:function(f,e){var h=moment(f.startDate).startOf("isoWeek");var d=e/Roadmap.WEEK_WIDTH;var g=d*c.DateUtilities.MILLISECONDS_A_WEEK;return new Date(h.valueOf()+g)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var e=Math.random()*16|0,d=f=="x"?e:(e&3|8);return d.toString(16)})}};c.ColorHelper={resetColorCounts:function(){a.each(Roadmap.COLORS,function(d){d.count=0})},findColor:function(d){return a.find(Roadmap.COLORS,function(e){return e.lane===d.lane})},adjustColorCount:function(e,f){var d=c.ColorHelper.findColor(e);if(d){d.count=d.count+f}},getColor:function(){return a.min(Roadmap.COLORS,function(d){return d.count})}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-utilities.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.DateUtilities={MILLISECONDS_A_DAY:86400000,MILLISECONDS_A_WEEK:604800000,parseDate:function(e){var d=moment(e,Roadmap.SHORT_DATE_FORMAT,true);if(d.isValid()){return d}d=moment(e,Roadmap.TWO_YY_SHORT_DATE_FORMAT,true);return d.isValid()?d:null},getDateStringFromDate:function(e,d){if(d){return moment(e).format(d)}return moment(e).format(Roadmap.DATE_FORMAT)},getDateFromDateString:function(e,d){return moment(e,d||Roadmap.DATE_FORMAT).toDate()},getNumberOfMonths:function(e,d){var g=moment(e),f=moment(d);return f.diff(g,"months")},getMilisecondsInMonth:function(d){return moment(d).daysInMonth()*c.DateUtilities.MILLISECONDS_A_DAY},getMilisecondsFromStartMonth:function(d){return d.getTime()-moment(d).startOf("month").valueOf()},calculateDurationInformation:function(d){var g=c.DateUtilities.getMilisecondsInMonth(d.toDate());var e=c.DateUtilities.getMilisecondsFromStartMonth(d.toDate());var f=g-e;return{totalMillisOfMonth:g,millisFromStartMonth:e,millisRemainingOfMonth:f,durationOfMonth:e/g,remainingDurationOfMonth:f/g}},convertToWeekDuration:function(e,g){var l=moment(e);var j=l.clone();var m=c.DateUtilities.calculateDurationInformation(l);if(g<=m.remainingDurationOfMonth){var f=g*m.totalMillisOfMonth;j=j.add(f,"ms")}else{j=j.add(m.millisRemainingOfMonth,"ms");g=g-m.remainingDurationOfMonth;var h=Math.floor(g);if(h>0){j=j.add(h,"months")}var k=g%1;var i=c.DateUtilities.getMilisecondsInMonth(j.toDate());var d=k*i;j.add(d,"ms")}return j.diff(l,"weeks",true)},convertToMonthDuration:function(e,j){var k=moment(e);var f=j*c.DateUtilities.MILLISECONDS_A_WEEK;var i=k.clone().add(f,"ms");var h=i.get("year")*12+i.get("month");h=h-(k.get("year")*12+k.get("month"));var l=c.DateUtilities.calculateDurationInformation(k);if(h===0){return f/l.totalMillisOfMonth}else{var g=l.remainingDurationOfMonth;var d=c.DateUtilities.calculateDurationInformation(i);g=g+d.durationOfMonth;g=g+(h-1);return g}}};c.FieldUtilities={fixDatePickerFields:function(d){var e=d.find("input[data-aui-dp-uuid]");e.each(function(f,g){var i=b(g),h=i.attr("data-aui-dp-uuid");i.on("click focus",function(){var j=b("[data-aui-dp-popup-uuid="+h+"]");if(AJS.version<="5.4.5"){var k=j.datepicker("option","onSelect");j.datepicker("option","onSelect",function(m,l){k(m,l);i.change()})}j.parents(".aui-inline-dialog").addClass("datepicker-roadmap-patch")})})}}}(AJS.$,window._));
}catch(e){WRMCB(e)};