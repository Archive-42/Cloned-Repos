'use strict';

exports.__esModule = true;
exports.isCommandRejectableByPageError = isCommandRejectableByPageError;
exports.canSetDebuggerBreakpointBeforeCommand = canSetDebuggerBreakpointBeforeCommand;
exports.isScreenshotCommand = isScreenshotCommand;
exports.isBrowserManipulationCommand = isBrowserManipulationCommand;
exports.isServiceCommand = isServiceCommand;
exports.isExecutableInTopWindowOnly = isExecutableInTopWindowOnly;
exports.isJSExpression = isJSExpression;

var _type = require('./type');

var _type2 = _interopRequireDefault(_type);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const RAW_API_JS_EXPRESSION_TYPE = 'js-expr'; // -------------------------------------------------------------
// WARNING: this file is used by both the client and the server.
// Do not use any browser or node-specific API!
// -------------------------------------------------------------
function isCommandRejectableByPageError(command) {
    return !isObservationCommand(command) && !isBrowserManipulationCommand(command) && !isServiceCommand(command) || isRejectableBrowserManipulationCommand(command) && !isWindowSwitchingCommand(command);
}

function isClientFunctionCommand(command) {
    return command.type === _type2.default.executeClientFunction || command.type === _type2.default.executeSelector;
}

function isObservationCommand(command) {
    return isClientFunctionCommand(command) || command.type === _type2.default.wait || command.type === _type2.default.assertion;
}

function isWindowSwitchingCommand(command) {
    return command.type === _type2.default.switchToIframe || command.type === _type2.default.switchToMainWindow;
}

function canSetDebuggerBreakpointBeforeCommand(command) {
    return command.type !== _type2.default.debug && !isClientFunctionCommand(command) && !isServiceCommand(command);
}

function isScreenshotCommand(command) {
    return command.type === _type2.default.takeScreenshot || command.type === _type2.default.takeElementScreenshot || command.type === _type2.default.takeScreenshotOnFail;
}

function isBrowserManipulationCommand(command) {
    return command.type === _type2.default.takeScreenshot || command.type === _type2.default.takeElementScreenshot || command.type === _type2.default.takeScreenshotOnFail || command.type === _type2.default.resizeWindow || command.type === _type2.default.resizeWindowToFitDevice || command.type === _type2.default.maximizeWindow;
}

function isRejectableBrowserManipulationCommand(command) {
    return command.type === _type2.default.resizeWindow || command.type === _type2.default.resizeWindowToFitDevice || command.type === _type2.default.maximizeWindow;
}

function isServiceCommand(command) {
    return command.type === _type2.default.testDone || command.type === _type2.default.takeScreenshotOnFail || command.type === _type2.default.showAssertionRetriesStatus || command.type === _type2.default.hideAssertionRetriesStatus || command.type === _type2.default.setBreakpoint || command.type === _type2.default.takeScreenshotOnFail;
}

function isExecutableInTopWindowOnly(command) {
    return command.type === _type2.default.testDone || command.type === _type2.default.switchToMainWindow || command.type === _type2.default.setNativeDialogHandler || command.type === _type2.default.getNativeDialogHistory || command.type === _type2.default.setTestSpeed || command.type === _type2.default.showAssertionRetriesStatus || command.type === _type2.default.hideAssertionRetriesStatus || command.type === _type2.default.setBreakpoint || isBrowserManipulationCommand(command) && command.type !== _type2.default.takeElementScreenshot;
}

function isJSExpression(val) {
    return val !== null && typeof val === 'object' && val.type === RAW_API_JS_EXPRESSION_TYPE && typeof val.value === 'string';
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy90ZXN0LXJ1bi9jb21tYW5kcy91dGlscy5qcyJdLCJuYW1lcyI6WyJpc0NvbW1hbmRSZWplY3RhYmxlQnlQYWdlRXJyb3IiLCJjYW5TZXREZWJ1Z2dlckJyZWFrcG9pbnRCZWZvcmVDb21tYW5kIiwiaXNTY3JlZW5zaG90Q29tbWFuZCIsImlzQnJvd3Nlck1hbmlwdWxhdGlvbkNvbW1hbmQiLCJpc1NlcnZpY2VDb21tYW5kIiwiaXNFeGVjdXRhYmxlSW5Ub3BXaW5kb3dPbmx5IiwiaXNKU0V4cHJlc3Npb24iLCJSQVdfQVBJX0pTX0VYUFJFU1NJT05fVFlQRSIsImNvbW1hbmQiLCJpc09ic2VydmF0aW9uQ29tbWFuZCIsImlzUmVqZWN0YWJsZUJyb3dzZXJNYW5pcHVsYXRpb25Db21tYW5kIiwiaXNXaW5kb3dTd2l0Y2hpbmdDb21tYW5kIiwiaXNDbGllbnRGdW5jdGlvbkNvbW1hbmQiLCJ0eXBlIiwiVFlQRSIsImV4ZWN1dGVDbGllbnRGdW5jdGlvbiIsImV4ZWN1dGVTZWxlY3RvciIsIndhaXQiLCJhc3NlcnRpb24iLCJzd2l0Y2hUb0lmcmFtZSIsInN3aXRjaFRvTWFpbldpbmRvdyIsImRlYnVnIiwidGFrZVNjcmVlbnNob3QiLCJ0YWtlRWxlbWVudFNjcmVlbnNob3QiLCJ0YWtlU2NyZWVuc2hvdE9uRmFpbCIsInJlc2l6ZVdpbmRvdyIsInJlc2l6ZVdpbmRvd1RvRml0RGV2aWNlIiwibWF4aW1pemVXaW5kb3ciLCJ0ZXN0RG9uZSIsInNob3dBc3NlcnRpb25SZXRyaWVzU3RhdHVzIiwiaGlkZUFzc2VydGlvblJldHJpZXNTdGF0dXMiLCJzZXRCcmVha3BvaW50Iiwic2V0TmF0aXZlRGlhbG9nSGFuZGxlciIsImdldE5hdGl2ZURpYWxvZ0hpc3RvcnkiLCJzZXRUZXN0U3BlZWQiLCJ2YWwiLCJ2YWx1ZSJdLCJtYXBwaW5ncyI6Ijs7O1FBUWdCQSw4QixHQUFBQSw4QjtRQXFCQUMscUMsR0FBQUEscUM7UUFJQUMsbUIsR0FBQUEsbUI7UUFNQUMsNEIsR0FBQUEsNEI7UUFlQUMsZ0IsR0FBQUEsZ0I7UUFTQUMsMkIsR0FBQUEsMkI7UUFZQUMsYyxHQUFBQSxjOztBQXZFaEI7Ozs7OztBQUVBLE1BQU1DLDZCQUE2QixTQUFuQyxDLENBTkE7QUFDQTtBQUNBO0FBQ0E7QUFLTyxTQUFTUCw4QkFBVCxDQUF5Q1EsT0FBekMsRUFBa0Q7QUFDckQsV0FBTyxDQUFDQyxxQkFBcUJELE9BQXJCLENBQUQsSUFBa0MsQ0FBQ0wsNkJBQTZCSyxPQUE3QixDQUFuQyxJQUE0RSxDQUFDSixpQkFBaUJJLE9BQWpCLENBQTdFLElBQ0FFLHVDQUF1Q0YsT0FBdkMsS0FDRyxDQUFDRyx5QkFBeUJILE9BQXpCLENBRlg7QUFHSDs7QUFFRCxTQUFTSSx1QkFBVCxDQUFrQ0osT0FBbEMsRUFBMkM7QUFDdkMsV0FBT0EsUUFBUUssSUFBUixLQUFpQkMsZUFBS0MscUJBQXRCLElBQ0FQLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtFLGVBRDdCO0FBRUg7O0FBRUQsU0FBU1Asb0JBQVQsQ0FBK0JELE9BQS9CLEVBQXdDO0FBQ3BDLFdBQU9JLHdCQUF3QkosT0FBeEIsS0FDQUEsUUFBUUssSUFBUixLQUFpQkMsZUFBS0csSUFEdEIsSUFFQVQsUUFBUUssSUFBUixLQUFpQkMsZUFBS0ksU0FGN0I7QUFHSDs7QUFFRCxTQUFTUCx3QkFBVCxDQUFtQ0gsT0FBbkMsRUFBNEM7QUFDeEMsV0FBT0EsUUFBUUssSUFBUixLQUFpQkMsZUFBS0ssY0FBdEIsSUFBd0NYLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtNLGtCQUFyRTtBQUNIOztBQUVNLFNBQVNuQixxQ0FBVCxDQUFnRE8sT0FBaEQsRUFBeUQ7QUFDNUQsV0FBT0EsUUFBUUssSUFBUixLQUFpQkMsZUFBS08sS0FBdEIsSUFBK0IsQ0FBQ1Qsd0JBQXdCSixPQUF4QixDQUFoQyxJQUFvRSxDQUFDSixpQkFBaUJJLE9BQWpCLENBQTVFO0FBQ0g7O0FBRU0sU0FBU04sbUJBQVQsQ0FBOEJNLE9BQTlCLEVBQXVDO0FBQzFDLFdBQU9BLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtRLGNBQXRCLElBQ0FkLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtTLHFCQUR0QixJQUVBZixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLVSxvQkFGN0I7QUFHSDs7QUFFTSxTQUFTckIsNEJBQVQsQ0FBdUNLLE9BQXZDLEVBQWdEO0FBQ25ELFdBQU9BLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtRLGNBQXRCLElBQ0FkLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtTLHFCQUR0QixJQUVBZixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLVSxvQkFGdEIsSUFHQWhCLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtXLFlBSHRCLElBSUFqQixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLWSx1QkFKdEIsSUFLQWxCLFFBQVFLLElBQVIsS0FBaUJDLGVBQUthLGNBTDdCO0FBTUg7O0FBRUQsU0FBU2pCLHNDQUFULENBQWlERixPQUFqRCxFQUEwRDtBQUN0RCxXQUFPQSxRQUFRSyxJQUFSLEtBQWlCQyxlQUFLVyxZQUF0QixJQUNDakIsUUFBUUssSUFBUixLQUFpQkMsZUFBS1ksdUJBRHZCLElBRUNsQixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLYSxjQUY5QjtBQUdIOztBQUVNLFNBQVN2QixnQkFBVCxDQUEyQkksT0FBM0IsRUFBb0M7QUFDdkMsV0FBT0EsUUFBUUssSUFBUixLQUFpQkMsZUFBS2MsUUFBdEIsSUFDQXBCLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtVLG9CQUR0QixJQUVBaEIsUUFBUUssSUFBUixLQUFpQkMsZUFBS2UsMEJBRnRCLElBR0FyQixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLZ0IsMEJBSHRCLElBSUF0QixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLaUIsYUFKdEIsSUFLQXZCLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtVLG9CQUw3QjtBQU1IOztBQUVNLFNBQVNuQiwyQkFBVCxDQUFzQ0csT0FBdEMsRUFBK0M7QUFDbEQsV0FBT0EsUUFBUUssSUFBUixLQUFpQkMsZUFBS2MsUUFBdEIsSUFDQXBCLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtNLGtCQUR0QixJQUVBWixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLa0Isc0JBRnRCLElBR0F4QixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLbUIsc0JBSHRCLElBSUF6QixRQUFRSyxJQUFSLEtBQWlCQyxlQUFLb0IsWUFKdEIsSUFLQTFCLFFBQVFLLElBQVIsS0FBaUJDLGVBQUtlLDBCQUx0QixJQU1BckIsUUFBUUssSUFBUixLQUFpQkMsZUFBS2dCLDBCQU50QixJQU9BdEIsUUFBUUssSUFBUixLQUFpQkMsZUFBS2lCLGFBUHRCLElBUUE1Qiw2QkFBNkJLLE9BQTdCLEtBQXlDQSxRQUFRSyxJQUFSLEtBQWlCQyxlQUFLUyxxQkFSdEU7QUFTSDs7QUFFTSxTQUFTakIsY0FBVCxDQUF5QjZCLEdBQXpCLEVBQThCO0FBQ2pDLFdBQU9BLFFBQVEsSUFBUixJQUFnQixPQUFPQSxHQUFQLEtBQWUsUUFBL0IsSUFBMkNBLElBQUl0QixJQUFKLEtBQWFOLDBCQUF4RCxJQUNBLE9BQU80QixJQUFJQyxLQUFYLEtBQXFCLFFBRDVCO0FBRUgiLCJmaWxlIjoidGVzdC1ydW4vY29tbWFuZHMvdXRpbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBXQVJOSU5HOiB0aGlzIGZpbGUgaXMgdXNlZCBieSBib3RoIHRoZSBjbGllbnQgYW5kIHRoZSBzZXJ2ZXIuXG4vLyBEbyBub3QgdXNlIGFueSBicm93c2VyIG9yIG5vZGUtc3BlY2lmaWMgQVBJIVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuaW1wb3J0IFRZUEUgZnJvbSAnLi90eXBlJztcblxuY29uc3QgUkFXX0FQSV9KU19FWFBSRVNTSU9OX1RZUEUgPSAnanMtZXhwcic7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbW1hbmRSZWplY3RhYmxlQnlQYWdlRXJyb3IgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gIWlzT2JzZXJ2YXRpb25Db21tYW5kKGNvbW1hbmQpICYmICFpc0Jyb3dzZXJNYW5pcHVsYXRpb25Db21tYW5kKGNvbW1hbmQpICYmICFpc1NlcnZpY2VDb21tYW5kKGNvbW1hbmQpIHx8XG4gICAgICAgICAgIGlzUmVqZWN0YWJsZUJyb3dzZXJNYW5pcHVsYXRpb25Db21tYW5kKGNvbW1hbmQpXG4gICAgICAgICAgICYmICFpc1dpbmRvd1N3aXRjaGluZ0NvbW1hbmQoY29tbWFuZCk7XG59XG5cbmZ1bmN0aW9uIGlzQ2xpZW50RnVuY3Rpb25Db21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5leGVjdXRlQ2xpZW50RnVuY3Rpb24gfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLmV4ZWN1dGVTZWxlY3Rvcjtcbn1cblxuZnVuY3Rpb24gaXNPYnNlcnZhdGlvbkNvbW1hbmQgKGNvbW1hbmQpIHtcbiAgICByZXR1cm4gaXNDbGllbnRGdW5jdGlvbkNvbW1hbmQoY29tbWFuZCkgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLndhaXQgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLmFzc2VydGlvbjtcbn1cblxuZnVuY3Rpb24gaXNXaW5kb3dTd2l0Y2hpbmdDb21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zd2l0Y2hUb0lmcmFtZSB8fCBjb21tYW5kLnR5cGUgPT09IFRZUEUuc3dpdGNoVG9NYWluV2luZG93O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FuU2V0RGVidWdnZXJCcmVha3BvaW50QmVmb3JlQ29tbWFuZCAoY29tbWFuZCkge1xuICAgIHJldHVybiBjb21tYW5kLnR5cGUgIT09IFRZUEUuZGVidWcgJiYgIWlzQ2xpZW50RnVuY3Rpb25Db21tYW5kKGNvbW1hbmQpICYmICFpc1NlcnZpY2VDb21tYW5kKGNvbW1hbmQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTY3JlZW5zaG90Q29tbWFuZCAoY29tbWFuZCkge1xuICAgIHJldHVybiBjb21tYW5kLnR5cGUgPT09IFRZUEUudGFrZVNjcmVlbnNob3QgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnRha2VFbGVtZW50U2NyZWVuc2hvdCB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUudGFrZVNjcmVlbnNob3RPbkZhaWw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Jyb3dzZXJNYW5pcHVsYXRpb25Db21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS50YWtlU2NyZWVuc2hvdCB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUudGFrZUVsZW1lbnRTY3JlZW5zaG90IHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS50YWtlU2NyZWVuc2hvdE9uRmFpbCB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUucmVzaXplV2luZG93IHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5yZXNpemVXaW5kb3dUb0ZpdERldmljZSB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUubWF4aW1pemVXaW5kb3c7XG59XG5cbmZ1bmN0aW9uIGlzUmVqZWN0YWJsZUJyb3dzZXJNYW5pcHVsYXRpb25Db21tYW5kIChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5yZXNpemVXaW5kb3cgfHxcbiAgICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5yZXNpemVXaW5kb3dUb0ZpdERldmljZSB8fFxuICAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLm1heGltaXplV2luZG93O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTZXJ2aWNlQ29tbWFuZCAoY29tbWFuZCkge1xuICAgIHJldHVybiBjb21tYW5kLnR5cGUgPT09IFRZUEUudGVzdERvbmUgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnRha2VTY3JlZW5zaG90T25GYWlsIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zaG93QXNzZXJ0aW9uUmV0cmllc1N0YXR1cyB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuaGlkZUFzc2VydGlvblJldHJpZXNTdGF0dXMgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnNldEJyZWFrcG9pbnQgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnRha2VTY3JlZW5zaG90T25GYWlsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFeGVjdXRhYmxlSW5Ub3BXaW5kb3dPbmx5IChjb21tYW5kKSB7XG4gICAgcmV0dXJuIGNvbW1hbmQudHlwZSA9PT0gVFlQRS50ZXN0RG9uZSB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuc3dpdGNoVG9NYWluV2luZG93IHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zZXROYXRpdmVEaWFsb2dIYW5kbGVyIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5nZXROYXRpdmVEaWFsb2dIaXN0b3J5IHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5zZXRUZXN0U3BlZWQgfHxcbiAgICAgICAgICAgY29tbWFuZC50eXBlID09PSBUWVBFLnNob3dBc3NlcnRpb25SZXRyaWVzU3RhdHVzIHx8XG4gICAgICAgICAgIGNvbW1hbmQudHlwZSA9PT0gVFlQRS5oaWRlQXNzZXJ0aW9uUmV0cmllc1N0YXR1cyB8fFxuICAgICAgICAgICBjb21tYW5kLnR5cGUgPT09IFRZUEUuc2V0QnJlYWtwb2ludCB8fFxuICAgICAgICAgICBpc0Jyb3dzZXJNYW5pcHVsYXRpb25Db21tYW5kKGNvbW1hbmQpICYmIGNvbW1hbmQudHlwZSAhPT0gVFlQRS50YWtlRWxlbWVudFNjcmVlbnNob3Q7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0pTRXhwcmVzc2lvbiAodmFsKSB7XG4gICAgcmV0dXJuIHZhbCAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0JyAmJiB2YWwudHlwZSA9PT0gUkFXX0FQSV9KU19FWFBSRVNTSU9OX1RZUEUgJiZcbiAgICAgICAgICAgdHlwZW9mIHZhbC52YWx1ZSA9PT0gJ3N0cmluZyc7XG59XG4iXX0=
