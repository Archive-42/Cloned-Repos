"use strict";!function(e){nggAjax={settings:{url:nggAjaxSetup.url,type:"POST",action:nggAjaxSetup.action,operation:nggAjaxSetup.operation,nonce:nggAjaxSetup.nonce,ids:nggAjaxSetup.ids,permission:nggAjaxSetup.permission,error:nggAjaxSetup.error,failure:nggAjaxSetup.failure,timeout:2e4,retries:0,max_retries:5,retry_delay:3e4},run:function(t){s=this.settings;e.ajax({type:"POST",url:s.url,data:"action="+s.action+"&operation="+s.operation+"&_wpnonce="+s.nonce+"&image="+s.ids[t]+"&retries="+nggAjax.settings.retries,cache:!1,timeout:3e4,success:function(e){switch(parseInt(e)){case-1:nggProgressBar.addNote(nggAjax.settings.permission);break;case 0:nggProgressBar.addNote(nggAjax.settings.error);break;case 1:break;default:nggProgressBar.addNote("<strong>ID "+nggAjax.settings.ids[t]+":</strong> "+nggAjax.settings.failure,e)}},error:function(e,t,s){nggAjax.settings.errorThrown=s},complete:function(e,s){if(++t<nggAjax.settings.ids.length){var n=!0;if("error"==s||"abort"==s)if(nggAjax.settings.retries+=1,nggAjax.settings.retries<=nggAjax.settings.max_retries){var g=nggAjax.settings.retry_delay/1e3;t--,n=!1,nggProgressBar.addNote("<strong>ID "+nggAjax.settings.ids[length]+":</strong> Retrying in "+g+" seconds; host might be throttling."),setTimeout(function(){nggAjax.run(t)},nggAjax.settings.retry_delay)}else{var r=e.responseText;""==r&&(r="( "+nggAjax.settings.errorThrown+" )"),nggProgressBar.addNote("<strong>ID "+nggAjax.settings.ids[t]+":</strong> "+nggAjax.settings.failure,r),nggProgressBar.increase(t)}else nggAjax.settings.retries=0,nggProgressBar.increase(t);n&&nggAjax.run(t)}else nggProgressBar.finished()}})},readIDs:function(t){s=this.settings;e.ajax({type:"POST",url:s.url,data:"action="+s.action+"&operation="+s.operation+"&_wpnonce="+s.nonce+"&image="+s.ids[t],dataType:"json",cache:!1,timeout:3e4,success:function(e){imageIDS=imageIDS.concat(e)},error:function(e){nggProgressBar.addNote("<strong>ID "+nggAjax.settings.ids[t]+":</strong> "+nggAjax.settings.failure,e.responseText)},complete:function(){t++,nggProgressBar.increase(t),t<nggAjax.settings.ids.length?nggAjax.readIDs(t):(t=0,nggAjax.settings.ids=imageIDS,nggAjax.settings.operation=nextOperation,nggAjax.settings.maxStep=imageIDS.length,nggProgressBar.init(nggAjax.settings),nggAjax.run(t))}})},init:function(t){if(!this.inited){this.settings=e.extend({},this.settings,{},t||{}),"gallery_"==this.settings.operation.substring(0,8)?(nextOperation=this.settings.operation.substring(8),this.settings.operation="get_image_ids",imageIDS=new Array,this.readIDs(0)):this.run(0),this.inited=!0}}}}(jQuery);