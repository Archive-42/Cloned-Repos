<h1 id="description">–description–</h1>
<p>So far, if any component receives new <code>state</code> or new <code>props</code>, it re-renders itself and all its children. This is usually okay. But React provides a lifecycle method you can call when child components receive new <code>state</code> or <code>props</code>, and declare specifically if the components should update or not. The method is <code>shouldComponentUpdate()</code>, and it takes <code>nextProps</code> and <code>nextState</code> as parameters.</p>
<p>This method is a useful way to optimize performance. For example, the default behavior is that your component re-renders when it receives new <code>props</code>, even if the <code>props</code> haven’t changed. You can use <code>shouldComponentUpdate()</code> to prevent this by comparing the <code>props</code>. The method must return a <code>boolean</code> value that tells React whether or not to update the component. You can compare the current props (<code>this.props</code>) to the next props (<code>nextProps</code>) to determine if you need to update or not, and return <code>true</code> or <code>false</code> accordingly.</p>
<h1 id="instructions">–instructions–</h1>
<p>The <code>shouldComponentUpdate()</code> method is added in a component called <code>OnlyEvens</code>. Currently, this method returns <code>true</code> so <code>OnlyEvens</code> re-renders every time it receives new <code>props</code>. Modify the method so <code>OnlyEvens</code> updates only if the <code>value</code> of its new props is even. Click the <code>Add</code> button and watch the order of events in your browser’s console as the lifecycle hooks are triggered.</p>
<h1 id="hints">–hints–</h1>
<p>The <code>Controller</code> component should render the <code>OnlyEvens</code> component as a child.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="at">assert</span>(</a>
<a class="sourceLine" id="cb1-2" title="2">  (() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="kw">const</span> mockedComponent <span class="op">=</span> <span class="va">Enzyme</span>.<span class="at">mount</span>(<span class="va">React</span>.<span class="at">createElement</span>(Controller))<span class="op">;</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb1-5" title="5">      <span class="va">mockedComponent</span>.<span class="at">find</span>(<span class="st">&#39;Controller&#39;</span>).<span class="at">length</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span></a>
<a class="sourceLine" id="cb1-6" title="6">      <span class="va">mockedComponent</span>.<span class="at">find</span>(<span class="st">&#39;OnlyEvens&#39;</span>).<span class="at">length</span> <span class="op">===</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1-7" title="7">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="op">}</span>)()</a>
<a class="sourceLine" id="cb1-9" title="9">)<span class="op">;</span></a></code></pre></div>
<p>The <code>shouldComponentUpdate</code> method should be defined on the <code>OnlyEvens</code> component.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="at">assert</span>(</a>
<a class="sourceLine" id="cb2-2" title="2">  (() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="kw">const</span> child <span class="op">=</span> <span class="va">React</span>.<span class="at">createElement</span>(OnlyEvens)</a>
<a class="sourceLine" id="cb2-4" title="4">      .<span class="va">type</span>.<span class="va">prototype</span>.<span class="va">shouldComponentUpdate</span>.<span class="at">toString</span>()</a>
<a class="sourceLine" id="cb2-5" title="5">      .<span class="at">replace</span>(<span class="ss">/s/g</span><span class="op">,</span> <span class="st">&#39;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="cf">return</span> child <span class="op">!==</span> <span class="st">&#39;undefined&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="op">}</span>)()</a>
<a class="sourceLine" id="cb2-8" title="8">)<span class="op">;</span></a></code></pre></div>
<p>The <code>OnlyEvens</code> component should return an <code>h1</code> tag which renders the value of <code>this.props.value</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1">(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="kw">const</span> mockedComponent <span class="op">=</span> <span class="va">Enzyme</span>.<span class="at">mount</span>(<span class="va">React</span>.<span class="at">createElement</span>(Controller))<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3">  <span class="kw">const</span> first <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="va">mockedComponent</span>.<span class="at">setState</span>(<span class="op">{</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1000</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="cf">return</span> <span class="va">mockedComponent</span>.<span class="at">find</span>(<span class="st">&#39;h1&#39;</span>).<span class="at">html</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="op">};</span></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="kw">const</span> second <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-8" title="8">    <span class="va">mockedComponent</span>.<span class="at">setState</span>(<span class="op">{</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="cf">return</span> <span class="va">mockedComponent</span>.<span class="at">find</span>(<span class="st">&#39;h1&#39;</span>).<span class="at">html</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="op">};</span></a>
<a class="sourceLine" id="cb3-11" title="11">  <span class="kw">const</span> firstValue <span class="op">=</span> <span class="at">first</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-12" title="12">  <span class="kw">const</span> secondValue <span class="op">=</span> <span class="at">second</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-13" title="13">  <span class="at">assert</span>(firstValue <span class="op">===</span> <span class="st">&#39;&lt;h1&gt;1000&lt;/h1&gt;&#39;</span> <span class="op">&amp;&amp;</span> secondValue <span class="op">===</span> <span class="st">&#39;&lt;h1&gt;10&lt;/h1&gt;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="op">}</span>)()<span class="op">;</span></a></code></pre></div>
<p><code>OnlyEvens</code> should re-render only when <code>nextProps.value</code> is even.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1">(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="kw">const</span> mockedComponent <span class="op">=</span> <span class="va">Enzyme</span>.<span class="at">mount</span>(<span class="va">React</span>.<span class="at">createElement</span>(Controller))<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="kw">const</span> first <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="va">mockedComponent</span>.<span class="at">setState</span>(<span class="op">{</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">8</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="cf">return</span> <span class="va">mockedComponent</span>.<span class="at">find</span>(<span class="st">&#39;h1&#39;</span>).<span class="at">text</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="op">};</span></a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="kw">const</span> second <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-8" title="8">    <span class="va">mockedComponent</span>.<span class="at">setState</span>(<span class="op">{</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">7</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="cf">return</span> <span class="va">mockedComponent</span>.<span class="at">find</span>(<span class="st">&#39;h1&#39;</span>).<span class="at">text</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-10" title="10">  <span class="op">};</span></a>
<a class="sourceLine" id="cb4-11" title="11">  <span class="kw">const</span> third <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-12" title="12">    <span class="va">mockedComponent</span>.<span class="at">setState</span>(<span class="op">{</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">42</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-13" title="13">    <span class="cf">return</span> <span class="va">mockedComponent</span>.<span class="at">find</span>(<span class="st">&#39;h1&#39;</span>).<span class="at">text</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-14" title="14">  <span class="op">};</span></a>
<a class="sourceLine" id="cb4-15" title="15">  <span class="kw">const</span> firstValue <span class="op">=</span> <span class="at">first</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-16" title="16">  <span class="kw">const</span> secondValue <span class="op">=</span> <span class="at">second</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-17" title="17">  <span class="kw">const</span> thirdValue <span class="op">=</span> <span class="at">third</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-18" title="18">  <span class="at">assert</span>(firstValue <span class="op">===</span> <span class="st">&#39;8&#39;</span> <span class="op">&amp;&amp;</span> secondValue <span class="op">===</span> <span class="st">&#39;8&#39;</span> <span class="op">&amp;&amp;</span> thirdValue <span class="op">===</span> <span class="st">&#39;42&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="op">}</span>)()<span class="op">;</span></a></code></pre></div>
<h1 id="seed">–seed–</h1>
<h2 id="after-user-code">–after-user-code–</h2>
<pre class="jsx"><code>ReactDOM.render(&lt;Controller /&gt;, document.getElementById(&#39;root&#39;));</code></pre>
<h2 id="seed-contents">–seed-contents–</h2>
<pre class="jsx"><code>class OnlyEvens extends React.Component {
  constructor(props) {
    super(props);
  }
  shouldComponentUpdate(nextProps, nextState) {
    console.log(&#39;Should I update?&#39;);
    // Change code below this line
    return true;
    // Change code above this line
  }
  componentDidUpdate() {
    console.log(&#39;Component re-rendered.&#39;);
  }
  render() {
    return &lt;h1&gt;{this.props.value}&lt;/h1&gt;;
  }
}

class Controller extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      value: 0
    };
    this.addValue = this.addValue.bind(this);
  }
  addValue() {
    this.setState(state =&gt; ({
      value: state.value + 1
    }));
  }
  render() {
    return (
      &lt;div&gt;
        &lt;button onClick={this.addValue}&gt;Add&lt;/button&gt;
        &lt;OnlyEvens value={this.state.value} /&gt;
      &lt;/div&gt;
    );
  }
}</code></pre>
<h1 id="solutions">–solutions–</h1>
<pre class="jsx"><code>class OnlyEvens extends React.Component {
  constructor(props) {
    super(props);
  }
  shouldComponentUpdate(nextProps, nextState) {
    console.log(&#39;Should I update?&#39;);
    // Change code below this line
    return nextProps.value % 2 === 0;
    // Change code above this line
  }
  componentDidUpdate() {
    console.log(&#39;Component re-rendered.&#39;);
  }
  render() {
    return &lt;h1&gt;{this.props.value}&lt;/h1&gt;;
  }
}

class Controller extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      value: 0
    };
    this.addValue = this.addValue.bind(this);
  }
  addValue() {
    this.setState(state =&gt; ({
      value: state.value + 1
    }));
  }
  render() {
    return (
      &lt;div&gt;
        &lt;button onClick={this.addValue}&gt;Add&lt;/button&gt;
        &lt;OnlyEvens value={this.state.value} /&gt;
      &lt;/div&gt;
    );
  }
}</code></pre>
