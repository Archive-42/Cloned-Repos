<!doctype html>
<html id="atomic">
    <head>
        <title>Sticky Functional Test</title>
        <script>
        (function(html){
            var c = html.className;
            c += " JsEnabled";
            c = c.replace("NoJs","");
            html.className = c;
        })(document.documentElement);
        </script>
        <link href="css/atomic.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="../../node_modules/mocha/mocha.css" />
    </head>
    <body>
        <div id="mocha" class="Pos(f) Z(1) Bgc(#fff)"></div>
        <div id="container"></div>
        <script src="../../node_modules/mocha/mocha.js"></script>
        <script src="../../node_modules/es5-shim/es5-shim.min.js"></script>
        <script src="../../node_modules/es5-shim/es5-sham.min.js"></script>
        <script src="bundle.js"></script>
        <script type="text/javascript">
            var container = document.getElementById('container');
            var stickyDemo = ReactDOM.render(React.createElement(StickyDemo, null), container);
        </script>
        <script>
            mocha.setup('bdd');
        </script>
        <script src="sticky.spec.js"></script>
        <script>
        (function () {
            var runner = mocha.run();

            var failedTests = [];
            runner.on('end', function () {
                window.mochaResults = runner.stats;
                window.mochaResults.reports = failedTests;
            });

            function flattenTitles(test) {
                var titles = [];
                while (test.parent.title){
                    titles.push(test.parent.title);
                    test = test.parent;
                }
                return titles.reverse();
            }

            runner.on('fail', function (test, err) {
                failedTests.push({
                    name: test.title,
                    result: false,
                    message: err && err.message,
                    stack: err && err.stack,
                    titles: flattenTitles(test)
                });
            });
        }());
        </script>
    </body>
</html>
