<h1 id="data-providers">Data Providers</h1>
<p>Whenever react-admin needs to communicate with the API, it calls methods on the Data Provider object.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1">dataProvider</a>
<a class="sourceLine" id="cb1-2" title="2">    .<span class="at">getOne</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">    .<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-4" title="4">        <span class="va">console</span>.<span class="at">log</span>(<span class="va">response</span>.<span class="at">data</span>)<span class="op">;</span> <span class="co">// { id: 123, title: &quot;hello, world&quot; }</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>It’s the Data Provider’s job to turn these method calls into HTTP requests, and transform the HTTP responses to the data format expected by react-admin. In technical terms, a Data Provider is an <em>adapter</em> for an API.</p>
<p>And to inject a Data Provider in a react-admin application, pass it as the <code>dataProvider</code> prop of the <code>&lt;Admin&gt;</code> component, as follows:</p>
<pre class="jsx"><code>import { Admin, Resource } from &#39;react-admin&#39;;
import dataProvider from &#39;../myDataProvider&#39;;

const App = () =&gt; (
    &lt;Admin dataProvider={dataProvider}&gt;
        // ...
    &lt;/Admin&gt;
)</code></pre>
<p>Thanks to this adapter injection system, react-admin can communicate with any API, whether it uses REST, GraphQL, RPC, or even SOAP, regardless of the dialect it uses. The Data Provider is also the ideal place to add custom HTTP headers, authentication, etc.</p>
<figure>
<img src="./img/data-provider.png" alt="Data Provider architecture" /><figcaption>Data Provider architecture</figcaption>
</figure>
<p>A Data Provider must have the following methods:</p>
<pre class="jsx"><code>const dataProvider = {
    getList:    (resource, params) =&gt; Promise,
    getOne:     (resource, params) =&gt; Promise,
    getMany:    (resource, params) =&gt; Promise,
    getManyReference: (resource, params) =&gt; Promise,
    create:     (resource, params) =&gt; Promise,
    update:     (resource, params) =&gt; Promise,
    updateMany: (resource, params) =&gt; Promise,
    delete:     (resource, params) =&gt; Promise,
    deleteMany: (resource, params) =&gt; Promise,
}</code></pre>
<p>You can find an example Data Provider implementation at the end of this chapter.</p>
<p><strong>Tip</strong>: A Data Provider can have more methods than the 9 methods listed above. For instance, you create a dataProvider with custom methods for calling non-REST API endpoints, manipulating tree structures, subscribing to real time updates, etc.</p>
<p><strong>Tip</strong>: In react-admin v2, Data Providers used to be functions, not objects. React-admin v3 can detect a legacy Data Provider and wrap an object around it. So Data Providers developed for react-admin v2 still work with react-admin v3.</p>
<h2 id="available-providers">Available Providers</h2>
<p>The react-admin project includes 5 Data Providers:</p>
<ul>
<li>Simple REST: <a href="https://github.com/marmelab/react-admin/tree/master/packages/ra-data-simple-rest">marmelab/ra-data-simple-rest</a> (<a href="#usage">read more below</a>). It serves mostly as an example. Incidentally, it is compatible with the <a href="https://github.com/marmelab/FakeRest">FakeRest</a> API.</li>
<li><strong><a href="https://github.com/typicode/json-server">JSON server</a></strong>: <a href="https://github.com/marmelab/react-admin/tree/master/packages/ra-data-json-server">marmelab/ra-data-json-server</a>. Great for prototyping an admin over a yet-to-be-developed REST API.</li>
<li><a href="https://graphql.org/">Simple GraphQL</a>: <a href="https://github.com/marmelab/react-admin/tree/master/packages/ra-data-graphql-simple">marmelab/ra-data-graphql-simple</a>. A GraphQL provider built with Apollo and tailored to target a simple GraphQL implementation.</li>
<li>Local JSON: <a href="https://github.com/marmelab/react-admin/tree/master/packages/ra-data-fakerest">marmelab/ra-data-fakerest</a>. Based on a local object, it doesn’t even use HTTP. Use it for testing purposes.</li>
<li>Local Storage: <a href="https://github.com/marmelab/react-admin/tree/master/packages/ra-data-localstorage">marmelab/ra-data-localstorage</a>. User editions are persisted across refreshes and between sessions. This allows local-first apps, and can be useful in tests.</li>
</ul>
<p>Developers from the react-admin community have open-sourced Data Providers for many more backends:</p>
<ul>
<li><strong><a href="https://docs.amplify.aws">AWS Amplify</a></strong>: <a href="https://github.com/MrHertal/react-admin-amplify">MrHertal/react-admin-amplify</a></li>
<li><strong><a href="https://github.com/zachrybaker/ra-data-rest-client">Configurable Identity Property REST Client</a></strong>: <a href="https://github.com/zachrybaker/ra-data-rest-client">zachrybaker/ra-data-rest-client</a></li>
<li><strong><a href="https://corebos.com/">coreBOS</a></strong>: <a href="https://github.com/coreBOS/reactadminportal">React-Admin coreBOS Integration</a></li>
<li><strong><a href="https://www.django-rest-framework.org/">Django Rest Framework</a></strong>: <a href="https://github.com/synaptic-cl/ra-data-drf">synaptic-cl/ra-data-drf</a></li>
<li><strong><a href="https://github.com/lalalilo/express-sequelize-crud">Express &amp; Sequelize</a></strong>: <a href="https://github.com/lalalilo/express-sequelize-crud">express-sequelize-crud</a></li>
<li><strong><a href="https://www.feathersjs.com/">Feathersjs</a></strong>: <a href="https://github.com/josx/ra-data-feathers">josx/ra-data-feathers</a></li>
<li><strong><a href="https://firebase.google.com/docs/firestore">Firebase Firestore</a></strong>: <a href="https://github.com/benwinding/react-admin-firebase">benwinding/react-admin-firebase</a>.</li>
<li><strong><a href="https://firebase.google.com/docs/database">Firebase Realtime Database</a></strong>: <a href="https://github.com/aymendhaya/ra-data-firebase-client">aymendhaya/ra-data-firebase-client</a>.</li>
<li><strong><a href="https://graphql.org/">GraphQL</a></strong>: <a href="https://github.com/marmelab/react-admin/tree/master/packages/ra-data-graphql">marmelab/ra-data-graphql</a> (uses <a href="https://www.apollodata.com/">Apollo</a>)</li>
<li><strong><a href="http://stateless.co/hal_specification.html">HAL</a></strong>: <a href="https://github.com/b-social/ra-data-hal">b-social/ra-data-hal</a></li>
<li><strong><a href="https://github.com/hasura/graphql-engine">Hasura</a></strong>: <a href="https://github.com/hasura/ra-data-hasura">hasura/ra-data-hasura</a>, auto generates valid GraphQL queries based on the properties exposed by the Hasura API.</li>
<li><strong><a href="https://www.hydra-cg.com/">Hydra</a> / <a href="https://json-ld.org/">JSON-LD</a></strong>: <a href="https://github.com/api-platform/admin/blob/master/src/hydra/dataProvider.js">api-platform/admin/hydra</a></li>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API">IndexedDB</a></strong>: <a href="https://github.com/tykoth/ra-data-dexie">tykoth/ra-data-dexie</a></li>
<li><strong><a href="https://jsonapi.org/">JSON API</a></strong>: <a href="https://github.com/henvo/ra-jsonapi-client">henvo/ra-jsonapi-client</a></li>
<li><strong><a href="https://tools.ietf.org/html/draft-kelly-json-hal-08">JSON HAL</a></strong>: <a href="https://www.npmjs.com/package/ra-data-json-hal">ra-data-json-hal</a></li>
<li><strong><a href="https://github.com/typicode/json-server">JSON server</a></strong>: <a href="https://github.com/marmelab/react-admin/tree/master/packages/ra-data-json-server">marmelab/ra-data-json-server</a>.</li>
<li><strong><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage">LocalStorage</a></strong>: <a href="https://github.com/marmelab/react-admin/tree/master/packages/ra-data-localstorage">marmelab/ra-data-localstorage</a></li>
<li><strong><a href="https://loopback.io/lb3">Loopback3</a></strong>: <a href="https://github.com/darthwesker/react-admin-loopback">darthwesker/react-admin-loopback</a></li>
<li><strong><a href="https://loopback.io/">Loopback4</a></strong>: <a href="https://github.com/elmaistrenko/react-admin-lb4">elmaistrenko/react-admin-lb4</a></li>
<li><strong><a href="https://github.com/RancaguaInnova/moleculer-data-provider">Moleculer Microservices</a></strong>: <a href="https://github.com/RancaguaInnova/moleculer-data-provider">RancaguaInnova/moleculer-data-provider</a></li>
<li><strong><a href="https://github.com/nestjsx/crud">NestJS CRUD</a></strong>: <a href="https://github.com/rayman1104/ra-data-nestjsx-crud">rayman1104/ra-data-nestjsx-crud</a></li>
<li><strong><a href="https://parseplatform.org/">Parse</a></strong>: <a href="https://github.com/almahdi/ra-data-parse">almahdi/ra-data-parse</a></li>
<li><strong><a href="https://www.graphile.org/postgraphile/">PostGraphile</a></strong>: <a href="https://github.com/BowlingX/ra-postgraphile">bowlingx/ra-postgraphile</a></li>
<li><strong><a href="https://postgrest.org/">PostgREST</a></strong>: <a href="https://github.com/raphiniert-com/ra-data-postgrest">raphiniert-com/ra-data-postgrest</a></li>
<li><strong><a href="https://github.com/weakky/ra-data-prisma">Prisma</a></strong>: <a href="https://github.com/weakky/ra-data-prisma">weakky/ra-data-prisma</a></li>
<li><strong><a href="https://www.prisma.io/">Prisma Version 2</a></strong>: <a href="https://github.com/panter/ra-data-prisma">panter/ra-data-prisma</a></li>
<li><strong><a href="https://www.opencrud.org/">OpenCRUD</a></strong>: <a href="https://github.com/Weakky/ra-data-opencrud">weakky/ra-data-opencrud</a></li>
<li><strong><a href="https://github.com/JKHeadley/rest-hapi">REST-HAPI</a></strong>: <a href="https://github.com/mkg20001/ra-data-rest-hapi">ra-data-rest-hapi</a></li>
<li><strong><a href="https://sailsjs.com/">Sails.js</a></strong>: <a href="https://github.com/mpampin/ra-data-json-sails">mpampin/ra-data-json-sails</a></li>
<li><strong><a href="https://spring.io/projects/spring-boot">Spring Boot</a></strong>: <a href="https://github.com/vishpat/ra-data-springboot-rest">vishpat/ra-data-springboot-rest</a></li>
<li><strong><a href="https://strapi.io/">Strapi</a></strong>: <a href="https://github.com/nazirov91/ra-strapi-rest">nazirov91/ra-strapi-rest</a></li>
</ul>
<p>If you’ve written a Data Provider for another backend, and open-sourced it, please help complete this list with your package.</p>
<p><strong>Tip</strong>: In version 1, react-admin was called <a href="https://github.com/marmelab/admin-on-rest">admin-on-rest</a> (AOR), and developers shared Data Providers for even more backends. Due to breaking changes in v2, these providers are no longer working. Fortunately, Data Providers aren’t complex pieces of code, and using legacy Data Provider with a recent react-admin version requires minimal changes. If you are a maintainer of one of these projects, we would warmly welcome an upgrade.</p>
<ul>
<li><strong><a href="https://github.com/abiglobalhealth/aor-dynamodb-client">DynamoDb</a></strong>: <a href="https://github.com/abiglobalhealth/aor-dynamodb-client">abiglobalhealth/aor-dynamodb-client</a></li>
<li><strong><a href="https://github.com/dchester/epilogue">Epilogue</a></strong>: <a href="https://github.com/dunghuynh/aor-epilogue-client">dunghuynh/aor-epilogue-client</a></li>
<li><strong><a href="https://github.com/ParsePlatform/parse-server">Parse Server</a></strong>: <a href="https://github.com/leperone/aor-parseserver-client">leperone/aor-parseserver-client</a></li>
<li><strong><a href="https://github.com/o1lab/xmysql">Xmysql</a></strong>: <a href="https://github.com/soaserele/aor-xmysql">soaserele/aor-xmysql</a></li>
</ul>
<h2 id="usage">Usage</h2>
<p>As an example, let’s focus on the Simple REST data provider. It fits REST APIs using simple GET parameters for filters and sorting.</p>
<p>Install the <code>ra-data-simple-rest</code> package to use this provider.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="ex">yarn</span> add ra-data-simple-rest</a></code></pre></div>
<p>Then, initialize the provider with the REST backend URL, and pass the result to the <code>dataProvider</code> prop of the <code>&lt;Admin&gt;</code> component:</p>
<pre class="jsx"><code>// in src/App.js
import * as React from &quot;react&quot;;
import { Admin, Resource } from &#39;react-admin&#39;;
import simpleRestProvider from &#39;ra-data-simple-rest&#39;;

import { PostList } from &#39;./posts&#39;;

const App = () =&gt; (
    &lt;Admin dataProvider={simpleRestProvider(&#39;http://path.to.my.api/&#39;)}&gt;
        &lt;Resource name=&quot;posts&quot; list={PostList} /&gt;
    &lt;/Admin&gt;
);

export default App;</code></pre>
<p>Here is how this Data Provider maps react-admin calls to API calls:</p>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="header">
<th>Method name</th>
<th>API call</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>getList</code></td>
<td><code>GET http://my.api.url/posts?sort=["title","ASC"]&amp;range=[0, 24]&amp;filter={"title":"bar"}</code></td>
</tr>
<tr class="even">
<td><code>getOne</code></td>
<td><code>GET http://my.api.url/posts/123</code></td>
</tr>
<tr class="odd">
<td><code>getMany</code></td>
<td><code>GET http://my.api.url/posts?filter={"id":[123,456,789]}</code></td>
</tr>
<tr class="even">
<td><code>getManyReference</code></td>
<td><code>GET http://my.api.url/posts?filter={"author_id":345}</code></td>
</tr>
<tr class="odd">
<td><code>create</code></td>
<td><code>POST http://my.api.url/posts</code></td>
</tr>
<tr class="even">
<td><code>update</code></td>
<td><code>PUT http://my.api.url/posts/123</code></td>
</tr>
<tr class="odd">
<td><code>updateMany</code></td>
<td>Multiple calls to <code>PUT http://my.api.url/posts/123</code></td>
</tr>
<tr class="even">
<td><code>delete</code></td>
<td><code>DELETE http://my.api.url/posts/123</code></td>
</tr>
<tr class="odd">
<td><code>deleteMany</code></td>
<td>Multiple calls to <code>DELETE http://my.api.url/posts/123</code></td>
</tr>
</tbody>
</table>
<p><strong>Note</strong>: The simple REST client expects the API to include a <code>Content-Range</code> header in the response to <code>getList</code> calls. The value must be the total number of resources in the collection. This allows react-admin to know how many pages of resources there are in total, and build the pagination controls.</p>
<pre><code>Content-Range: posts 0-24/319</code></pre>
<p>If your API is on another domain as the JS code, you’ll need to whitelist this header with an <code>Access-Control-Expose-Headers</code> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">CORS</a> header.</p>
<pre><code>Access-Control-Expose-Headers: Content-Range</code></pre>
<h2 id="adding-custom-headers">Adding Custom Headers</h2>
<p>The <code>simpleRestProvider</code> function accepts an HTTP client function as second argument. By default, it uses react-admin’s <code>fetchUtils.fetchJson()</code> function as HTTP client. It’s similar to HTML5 <code>fetch()</code>, except it handles JSON decoding and HTTP error codes automatically.</p>
<p>That means that if you need to add custom headers to your requests, you can just <em>wrap</em> the <code>fetchJson()</code> call inside your own function:</p>
<pre class="jsx"><code>import { fetchUtils, Admin, Resource } from &#39;react-admin&#39;;
import simpleRestProvider from &#39;ra-data-simple-rest&#39;;

const fetchJson = (url, options = {}) =&gt; {
    if (!options.headers) {
        options.headers = new Headers({ Accept: &#39;application/json&#39; });
    }
    // add your own headers here
    options.headers.set(&#39;X-Custom-Header&#39;, &#39;foobar&#39;);
    return fetchUtils.fetchJson(url, options);
}
const dataProvider = simpleRestProvider(&#39;http://path.to.my.api/&#39;, fetchJson);

const App = () =&gt; (
    &lt;Admin dataProvider={dataProvider}&gt;
        &lt;Resource name=&quot;posts&quot; list={PostList} /&gt;
    &lt;/Admin&gt;
);</code></pre>
<p>Now all the requests to the REST API will contain the <code>X-Custom-Header: foobar</code> header.</p>
<p><strong>Tip</strong>: The most common usage of custom headers is for authentication. <code>fetchJson</code> has built-on support for the <code>Authorization</code> token header:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> fetchJson <span class="op">=</span> (url<span class="op">,</span> options <span class="op">=</span> <span class="op">{}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">    <span class="va">options</span>.<span class="at">user</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-3" title="3">        <span class="dt">authenticated</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb9-4" title="4">        <span class="dt">token</span><span class="op">:</span> <span class="st">&#39;SRTRDFVESGNJYTUKTYTHRG&#39;</span></a>
<a class="sourceLine" id="cb9-5" title="5">    <span class="op">};</span></a>
<a class="sourceLine" id="cb9-6" title="6">    <span class="cf">return</span> <span class="va">fetchUtils</span>.<span class="at">fetchJson</span>(url<span class="op">,</span> options)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="op">};</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="kw">const</span> dataProvider <span class="op">=</span> <span class="at">simpleRestProvider</span>(<span class="st">&#39;http://path.to.my.api/&#39;</span><span class="op">,</span> fetchJson)<span class="op">;</span></a></code></pre></div>
<p>Now all the requests to the REST API will contain the <code>Authorization: SRTRDFVESGNJYTUKTYTHRG</code> header.</p>
<h2 id="extending-a-data-provider-example-of-file-upload">Extending a Data Provider (Example of File Upload)</h2>
<p>As Data Providers are just objects, you can extend them with custom logic for a given method, or a given resource.</p>
<p>For instance, the following Data Provider extends the <code>ra-data-simple-rest</code> provider, and adds image upload support for the <code>update('posts')</code> call (react-admin offers an <code>&lt;ImageInput /&gt;</code> component that allows image upload).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="im">import</span> simpleRestProvider <span class="im">from</span> <span class="st">&#39;ra-data-simple-rest&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">const</span> dataProvider <span class="op">=</span> <span class="at">simpleRestProvider</span>(<span class="st">&#39;http://path.to.my.api/&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-4" title="4"></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw">const</span> myDataProvider <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-6" title="6">    ...<span class="at">dataProvider</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-7" title="7">    <span class="dt">update</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-8" title="8">        <span class="cf">if</span> (resource <span class="op">!==</span> <span class="st">&#39;posts&#39;</span> <span class="op">||</span> <span class="op">!</span><span class="va">params</span>.<span class="va">data</span>.<span class="at">pictures</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-9" title="9">            <span class="co">// fallback to the default implementation</span></a>
<a class="sourceLine" id="cb10-10" title="10">            <span class="cf">return</span> <span class="va">dataProvider</span>.<span class="at">update</span>(resource<span class="op">,</span> params)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-11" title="11">        <span class="op">}</span></a>
<a class="sourceLine" id="cb10-12" title="12">        <span class="co">/**</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">         * For posts update only, convert uploaded image in base 64 and attach it to</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">         * the `picture` sent property, with `src` and `title` attributes.</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">         */</span></a>
<a class="sourceLine" id="cb10-16" title="16">        </a>
<a class="sourceLine" id="cb10-17" title="17">        <span class="co">// Freshly dropped pictures are File objects and must be converted to base64 strings</span></a>
<a class="sourceLine" id="cb10-18" title="18">        <span class="kw">const</span> newPictures <span class="op">=</span> <span class="va">params</span>.<span class="va">data</span>.<span class="va">pictures</span>.<span class="at">filter</span>(</a>
<a class="sourceLine" id="cb10-19" title="19">            p <span class="kw">=&gt;</span> <span class="va">p</span>.<span class="at">rawFile</span> <span class="kw">instanceof</span> File</a>
<a class="sourceLine" id="cb10-20" title="20">        )<span class="op">;</span></a>
<a class="sourceLine" id="cb10-21" title="21">        <span class="kw">const</span> formerPictures <span class="op">=</span> <span class="va">params</span>.<span class="va">data</span>.<span class="va">pictures</span>.<span class="at">filter</span>(</a>
<a class="sourceLine" id="cb10-22" title="22">            p <span class="kw">=&gt;</span> <span class="op">!</span>(<span class="va">p</span>.<span class="at">rawFile</span> <span class="kw">instanceof</span> File)</a>
<a class="sourceLine" id="cb10-23" title="23">        )<span class="op">;</span></a>
<a class="sourceLine" id="cb10-24" title="24"></a>
<a class="sourceLine" id="cb10-25" title="25">        <span class="cf">return</span> <span class="va">Promise</span>.<span class="at">all</span>(<span class="va">newPictures</span>.<span class="at">map</span>(convertFileToBase64))</a>
<a class="sourceLine" id="cb10-26" title="26">            .<span class="at">then</span>(base64Pictures <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb10-27" title="27">                <span class="va">base64Pictures</span>.<span class="at">map</span>(picture64 <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb10-28" title="28">                    <span class="dt">src</span><span class="op">:</span> picture64<span class="op">,</span></a>
<a class="sourceLine" id="cb10-29" title="29">                    <span class="dt">title</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="va">params</span>.<span class="va">data</span>.<span class="at">title</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-30" title="30">                <span class="op">}</span>))</a>
<a class="sourceLine" id="cb10-31" title="31">            )</a>
<a class="sourceLine" id="cb10-32" title="32">            .<span class="at">then</span>(transformedNewPictures <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb10-33" title="33">                <span class="va">dataProvider</span>.<span class="at">update</span>(resource<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-34" title="34">                    ...<span class="at">params</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-35" title="35">                    <span class="dt">data</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-36" title="36">                        ...<span class="va">params</span>.<span class="at">data</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-37" title="37">                        <span class="dt">pictures</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb10-38" title="38">                            ...<span class="at">transformedNewPictures</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-39" title="39">                            ...<span class="at">formerPictures</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-40" title="40">                        ]<span class="op">,</span></a>
<a class="sourceLine" id="cb10-41" title="41">                    <span class="op">},</span></a>
<a class="sourceLine" id="cb10-42" title="42">                <span class="op">}</span>)</a>
<a class="sourceLine" id="cb10-43" title="43">            )<span class="op">;</span></a>
<a class="sourceLine" id="cb10-44" title="44">    <span class="op">},</span></a>
<a class="sourceLine" id="cb10-45" title="45"><span class="op">};</span></a>
<a class="sourceLine" id="cb10-46" title="46"></a>
<a class="sourceLine" id="cb10-47" title="47"><span class="co">/**</span></a>
<a class="sourceLine" id="cb10-48" title="48"><span class="co"> * Convert a `File` object returned by the upload input into a base 64 string.</span></a>
<a class="sourceLine" id="cb10-49" title="49"><span class="co"> * That&#39;s not the most optimized way to store images in production, but it&#39;s</span></a>
<a class="sourceLine" id="cb10-50" title="50"><span class="co"> * enough to illustrate the idea of data provider decoration.</span></a>
<a class="sourceLine" id="cb10-51" title="51"><span class="co"> */</span></a>
<a class="sourceLine" id="cb10-52" title="52"><span class="kw">const</span> convertFileToBase64 <span class="op">=</span> file <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb10-53" title="53">    <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-54" title="54">        <span class="kw">const</span> reader <span class="op">=</span> <span class="kw">new</span> <span class="at">FileReader</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb10-55" title="55">        <span class="va">reader</span>.<span class="at">onload</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="at">resolve</span>(<span class="va">reader</span>.<span class="at">result</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-56" title="56">        <span class="va">reader</span>.<span class="at">onerror</span> <span class="op">=</span> reject<span class="op">;</span></a>
<a class="sourceLine" id="cb10-57" title="57"></a>
<a class="sourceLine" id="cb10-58" title="58">        <span class="va">reader</span>.<span class="at">readAsDataURL</span>(<span class="va">file</span>.<span class="at">rawFile</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-59" title="59">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-60" title="60"></a>
<a class="sourceLine" id="cb10-61" title="61"><span class="im">export</span> <span class="im">default</span> myDataProvider<span class="op">;</span></a></code></pre></div>
<p>Using this technique, you can also combine two Data Providers for two backends into a single object, or use a Proxy to transform responses for all methods.</p>
<h2 id="writing-your-own-data-provider">Writing Your Own Data Provider</h2>
<p>APIs are so diverse that quite often, none of the available Data Providers suit you API. In such cases, you’ll have to write your own Data Provider. Don’t worry, it usually takes only a couple of hours.</p>
<p>The methods of a Data Provider receive a request, and return a promise for a response. Both the request and the response format are standardized.</p>
<p><strong>Caution</strong>: A Data Provider should return the same shape in <code>getList</code> and <code>getOne</code> for a given resource. This is because react-admin uses “optimistic rendering”, and renders the Edit and Show view <em>before</em> calling <code>dataProvider.getOne()</code> by reusing the response from <code>dataProvider.getList()</code> if the user has displayed the List view before. If your API has different shapes for a query for a unique record and for a query for a list of records, your Data Provider should make these records consistent in shape before returning them to react-admin.</p>
<p>For instance, the following Data Provider returns more details in <code>getOne</code> than in <code>getList</code>:</p>
<pre class="jsx"><code>const { data } = await dataProvider.getList(&#39;posts&#39;, {
    pagination: { page: 1, perPage: 5 },
    sort: { field: &#39;title&#39;, order: &#39;ASC&#39; },
    filter: { author_id: 12 },
})
// [
//   { id: 123, title: &quot;hello, world&quot;, author_id: 12 },
//   { id: 125, title: &quot;howdy partner&quot;, author_id: 12 },
//  ],

const { data } = dataProvider.getOne(&#39;posts&#39;, { id: 123 })
// {
//     data: { id: 123, title: &quot;hello, world&quot;, author_id: 12, body: &#39;Lorem Ipsum Sic Dolor Amet&#39; }
// }</code></pre>
<p>This will cause the Edit view to blink on load. If you have this problem, modify your Data Provider to return the same shape for all methods.</p>
<h2 id="request-format">Request Format</h2>
<p>Data queries require a <em>method</em> (e.g. <code>getOne</code>), a <em>resource</em> (e.g. ‘posts’) and a set of <em>parameters</em>.</p>
<p><strong>Tip</strong>: In comparison, HTTP requests require a <em>verb</em> (e.g. ‘GET’), an <em>url</em> (e.g. ‘http://myapi.com/posts’), a list of <em>headers</em> (like <code>Content-Type</code>) and a <em>body</em>.</p>
<p>Standard methods are:</p>
<table>
<colgroup>
<col style="width: 8%" />
<col style="width: 22%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Usage</th>
<th>Parameters format</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>getList</code></td>
<td>Search for resources</td>
<td><code>{ pagination: { page: {int} , perPage: {int} }, sort: { field: {string}, order: {string} }, filter: {Object} }</code></td>
</tr>
<tr class="even">
<td><code>getOne</code></td>
<td>Read a single resource, by id</td>
<td><code>{ id: {mixed} }</code></td>
</tr>
<tr class="odd">
<td><code>getMany</code></td>
<td>Read a list of resource, by ids</td>
<td><code>{ ids: {mixed[]} }</code></td>
</tr>
<tr class="even">
<td><code>getManyReference</code></td>
<td>Read a list of resources related to another one</td>
<td><code>{ target: {string}, id: {mixed}, pagination: { page: {int} , perPage: {int} }, sort: { field: {string}, order: {string} }, filter: {Object} }</code></td>
</tr>
<tr class="odd">
<td><code>create</code></td>
<td>Create a single resource</td>
<td><code>{ data: {Object} }</code></td>
</tr>
<tr class="even">
<td><code>update</code></td>
<td>Update a single resource</td>
<td><code>{ id: {mixed}, data: {Object}, previousData: {Object} }</code></td>
</tr>
<tr class="odd">
<td><code>updateMany</code></td>
<td>Update multiple resources</td>
<td><code>{ ids: {mixed[]}, data: {Object} }</code></td>
</tr>
<tr class="even">
<td><code>delete</code></td>
<td>Delete a single resource</td>
<td><code>{ id: {mixed}, previousData: {Object} }</code></td>
</tr>
<tr class="odd">
<td><code>deleteMany</code></td>
<td>Delete multiple resources</td>
<td><code>{ ids: {mixed[]} }</code></td>
</tr>
</tbody>
</table>
<p>Here are several examples of how react-admin can call the Data Provider:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="va">dataProvider</span>.<span class="at">getList</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-2" title="2">    <span class="dt">pagination</span><span class="op">:</span> <span class="op">{</span> <span class="dt">page</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">perPage</span><span class="op">:</span> <span class="dv">5</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb12-3" title="3">    <span class="dt">sort</span><span class="op">:</span> <span class="op">{</span> <span class="dt">field</span><span class="op">:</span> <span class="st">&#39;title&#39;</span><span class="op">,</span> <span class="dt">order</span><span class="op">:</span> <span class="st">&#39;ASC&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb12-4" title="4">    <span class="dt">filter</span><span class="op">:</span> <span class="op">{</span> <span class="dt">author_id</span><span class="op">:</span> <span class="dv">12</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="va">dataProvider</span>.<span class="at">getOne</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="va">dataProvider</span>.<span class="at">getMany</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">ids</span><span class="op">:</span> [<span class="dv">123</span><span class="op">,</span> <span class="dv">124</span><span class="op">,</span> <span class="dv">125</span>] <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="va">dataProvider</span>.<span class="at">getManyReference</span>(<span class="st">&#39;comments&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-9" title="9">    <span class="dt">target</span><span class="op">:</span> <span class="st">&#39;post_id&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb12-10" title="10">    <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span><span class="op">,</span></a>
<a class="sourceLine" id="cb12-11" title="11">    <span class="dt">sort</span><span class="op">:</span> <span class="op">{</span> <span class="dt">field</span><span class="op">:</span> <span class="st">&#39;created_at&#39;</span><span class="op">,</span> <span class="dt">order</span><span class="op">:</span> <span class="st">&#39;DESC&#39;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="va">dataProvider</span>.<span class="at">update</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-14" title="14">    <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span><span class="op">,</span></a>
<a class="sourceLine" id="cb12-15" title="15">    <span class="dt">data</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;hello, world!&quot;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb12-16" title="16">    <span class="dt">previousData</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;previous title&quot;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb12-17" title="17"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="va">dataProvider</span>.<span class="at">updateMany</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-19" title="19">    <span class="dt">ids</span><span class="op">:</span> [<span class="dv">123</span><span class="op">,</span> <span class="dv">234</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb12-20" title="20">    <span class="dt">data</span><span class="op">:</span> <span class="op">{</span> <span class="dt">views</span><span class="op">:</span> <span class="dv">0</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="va">dataProvider</span>.<span class="at">create</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">data</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;hello, world&quot;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="va">dataProvider</span>.<span class="at">delete</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-24" title="24">    <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span><span class="op">,</span></a>
<a class="sourceLine" id="cb12-25" title="25">    <span class="dt">previousData</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;hello, world&quot;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb12-26" title="26"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-27" title="27"><span class="va">dataProvider</span>.<span class="at">deleteMany</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">ids</span><span class="op">:</span> [<span class="dv">123</span><span class="op">,</span> <span class="dv">234</span>] <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p><strong>Tip</strong>: If your API supports more request types, you can add more methods to the Data Provider (for instance to support upserts, aggregations, or Remote Procedure Call). React-admin won’t call these methods directly, but you can call them in your own component thanks to the <code>useDataProvider</code> hook described in the <a href="./Actions.md">Querying the API</a> documentation.</p>
<h2 id="response-format">Response Format</h2>
<p>Data Providers methods must return a Promise for an object with a <code>data</code> property.</p>
<table>
<thead>
<tr class="header">
<th>Method</th>
<th>Response format</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>getList</code></td>
<td><code>{ data: {Record[]}, total: {int}, validUntil?: {Date} }</code></td>
</tr>
<tr class="even">
<td><code>getOne</code></td>
<td><code>{ data: {Record}, validUntil?: {Date} }</code></td>
</tr>
<tr class="odd">
<td><code>getMany</code></td>
<td><code>{ data: {Record[]}, validUntil?: {Date} }</code></td>
</tr>
<tr class="even">
<td><code>getManyReference</code></td>
<td><code>{ data: {Record[]}, total: {int} }</code></td>
</tr>
<tr class="odd">
<td><code>create</code></td>
<td><code>{ data: {Record} }</code></td>
</tr>
<tr class="even">
<td><code>update</code></td>
<td><code>{ data: {Record} }</code></td>
</tr>
<tr class="odd">
<td><code>updateMany</code></td>
<td><code>{ data: {mixed[]} }</code> The ids which have been updated</td>
</tr>
<tr class="even">
<td><code>delete</code></td>
<td><code>{ data: {Record} }</code> The record that has been deleted</td>
</tr>
<tr class="odd">
<td><code>deleteMany</code></td>
<td><code>{ data: {mixed[]} }</code> The ids of the deleted records (optional)</td>
</tr>
</tbody>
</table>
<p>A <code>{Record}</code> is an object literal with at least an <code>id</code> property, e.g. <code>{ id: 123, title: "hello, world" }</code>.</p>
<p>Building up on the previous example, here are example responses matching the format expected by react-admin:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="va">dataProvider</span>.<span class="at">getList</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">    <span class="dt">pagination</span><span class="op">:</span> <span class="op">{</span> <span class="dt">page</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">perPage</span><span class="op">:</span> <span class="dv">5</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb13-3" title="3">    <span class="dt">sort</span><span class="op">:</span> <span class="op">{</span> <span class="dt">field</span><span class="op">:</span> <span class="st">&#39;title&#39;</span><span class="op">,</span> <span class="dt">order</span><span class="op">:</span> <span class="st">&#39;ASC&#39;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb13-4" title="4">    <span class="dt">filter</span><span class="op">:</span> <span class="op">{</span> <span class="dt">author_id</span><span class="op">:</span> <span class="dv">12</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-6" title="6">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">//     data: [</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">//         { id: 126, title: &quot;allo?&quot;, author_id: 12 },</span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">//         { id: 127, title: &quot;bien le bonjour&quot;, author_id: 12 },</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">//         { id: 124, title: &quot;good day sunshine&quot;, author_id: 12 },</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">//         { id: 123, title: &quot;hello, world&quot;, author_id: 12 },</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">//         { id: 125, title: &quot;howdy partner&quot;, author_id: 12 },</span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">//     ],</span></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">//     total: 27</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="co">// }</span></a>
<a class="sourceLine" id="cb13-17" title="17"></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="va">dataProvider</span>.<span class="at">getOne</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-19" title="19">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-21" title="21"><span class="co">//     data: { id: 123, title: &quot;hello, world&quot; }</span></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="co">// }</span></a>
<a class="sourceLine" id="cb13-23" title="23"></a>
<a class="sourceLine" id="cb13-24" title="24"><span class="va">dataProvider</span>.<span class="at">getMany</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">ids</span><span class="op">:</span> [<span class="dv">123</span><span class="op">,</span> <span class="dv">124</span><span class="op">,</span> <span class="dv">125</span>] <span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-25" title="25">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-26" title="26"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-27" title="27"><span class="co">//     data: [</span></a>
<a class="sourceLine" id="cb13-28" title="28"><span class="co">//         { id: 123, title: &quot;hello, world&quot; },</span></a>
<a class="sourceLine" id="cb13-29" title="29"><span class="co">//         { id: 124, title: &quot;good day sunshise&quot; },</span></a>
<a class="sourceLine" id="cb13-30" title="30"><span class="co">//         { id: 125, title: &quot;howdy partner&quot; },</span></a>
<a class="sourceLine" id="cb13-31" title="31"><span class="co">//     ]</span></a>
<a class="sourceLine" id="cb13-32" title="32"><span class="co">// }</span></a>
<a class="sourceLine" id="cb13-33" title="33"></a>
<a class="sourceLine" id="cb13-34" title="34"><span class="va">dataProvider</span>.<span class="at">getManyReference</span>(<span class="st">&#39;comments&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-35" title="35">    <span class="dt">target</span><span class="op">:</span> <span class="st">&#39;post_id&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb13-36" title="36">    <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span><span class="op">,</span></a>
<a class="sourceLine" id="cb13-37" title="37">    <span class="dt">sort</span><span class="op">:</span> <span class="op">{</span> <span class="dt">field</span><span class="op">:</span> <span class="st">&#39;created_at&#39;</span><span class="op">,</span> <span class="dt">order</span><span class="op">:</span> <span class="st">&#39;DESC&#39;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb13-38" title="38"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-39" title="39">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-40" title="40"></a>
<a class="sourceLine" id="cb13-41" title="41"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-42" title="42"><span class="co">//     data: [</span></a>
<a class="sourceLine" id="cb13-43" title="43"><span class="co">//         { id: 667, title: &quot;I agree&quot;, post_id: 123 },</span></a>
<a class="sourceLine" id="cb13-44" title="44"><span class="co">//         { id: 895, title: &quot;I don&#39;t agree&quot;, post_id: 123 },</span></a>
<a class="sourceLine" id="cb13-45" title="45"><span class="co">//     ],</span></a>
<a class="sourceLine" id="cb13-46" title="46"><span class="co">//     total: 2,</span></a>
<a class="sourceLine" id="cb13-47" title="47"><span class="co">// }</span></a>
<a class="sourceLine" id="cb13-48" title="48"></a>
<a class="sourceLine" id="cb13-49" title="49"><span class="va">dataProvider</span>.<span class="at">create</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">data</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;hello, world&quot;</span> <span class="op">}</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-50" title="50">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-51" title="51"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-52" title="52"><span class="co">//     data: { id: 450, title: &quot;hello, world&quot; }</span></a>
<a class="sourceLine" id="cb13-53" title="53"><span class="co">// }</span></a>
<a class="sourceLine" id="cb13-54" title="54"></a>
<a class="sourceLine" id="cb13-55" title="55"><span class="va">dataProvider</span>.<span class="at">update</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-56" title="56">    <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span><span class="op">,</span></a>
<a class="sourceLine" id="cb13-57" title="57">    <span class="dt">data</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;hello, world!&quot;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb13-58" title="58">    <span class="dt">previousData</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;previous title&quot;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb13-59" title="59"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-60" title="60">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-61" title="61"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-62" title="62"><span class="co">//     data: { id: 123, title: &quot;hello, world!&quot; }</span></a>
<a class="sourceLine" id="cb13-63" title="63"><span class="co">// }</span></a>
<a class="sourceLine" id="cb13-64" title="64"></a>
<a class="sourceLine" id="cb13-65" title="65"><span class="va">dataProvider</span>.<span class="at">updateMany</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-66" title="66">    <span class="dt">ids</span><span class="op">:</span> [<span class="dv">123</span><span class="op">,</span> <span class="dv">234</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb13-67" title="67">    <span class="dt">data</span><span class="op">:</span> <span class="op">{</span> <span class="dt">views</span><span class="op">:</span> <span class="dv">0</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb13-68" title="68"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-69" title="69">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-70" title="70"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-71" title="71"><span class="co">//     data: [123, 234]</span></a>
<a class="sourceLine" id="cb13-72" title="72"><span class="co">// }</span></a>
<a class="sourceLine" id="cb13-73" title="73"></a>
<a class="sourceLine" id="cb13-74" title="74"><span class="va">dataProvider</span>.<span class="at">delete</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-75" title="75">    <span class="dt">id</span><span class="op">:</span> <span class="dv">123</span><span class="op">,</span></a>
<a class="sourceLine" id="cb13-76" title="76">    <span class="dt">previousData</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;hello, world!&quot;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb13-77" title="77"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-78" title="78">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-79" title="79"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-80" title="80"><span class="co">//     data: { id: 123, title: &quot;hello, world&quot; }</span></a>
<a class="sourceLine" id="cb13-81" title="81"><span class="co">// }</span></a>
<a class="sourceLine" id="cb13-82" title="82"></a>
<a class="sourceLine" id="cb13-83" title="83"><span class="va">dataProvider</span>.<span class="at">deleteMany</span>(<span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">ids</span><span class="op">:</span> [<span class="dv">123</span><span class="op">,</span> <span class="dv">234</span>] <span class="op">}</span>)</a>
<a class="sourceLine" id="cb13-84" title="84">.<span class="at">then</span>(response <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(response))<span class="op">;</span></a>
<a class="sourceLine" id="cb13-85" title="85"><span class="co">// {</span></a>
<a class="sourceLine" id="cb13-86" title="86"><span class="co">//     data: [123, 234]</span></a>
<a class="sourceLine" id="cb13-87" title="87"><span class="co">// }</span></a></code></pre></div>
<p><strong>Tip</strong>: The <code>validUntil</code> field in the response is optional. It enables the Application cache, a client-side optimization to speed up rendering and reduce network traffic. Check <a href="./Caching.md#application-cache">the Caching documentation</a> for more details.</p>
<h2 id="error-format">Error Format</h2>
<p>When the API backend returns an error, the Data Provider should return a rejected Promise containing an <code>Error</code> object. This object should contain a <code>status</code> property with the HTTP response code (404, 500, etc.). React-admin inspects this error code, and uses it for <a href="./Authentication.md">authentication</a> (in case of 401 or 403 errors). Besides, react-admin displays the error <code>message</code> on screen in a temporary notification.</p>
<p>If you use <code>fetchJson</code>, you don’t need to do anything: HTTP errors are automatically decorated as expected by react-admin.</p>
<p>If you use another HTTP client, make sure you return a rejected Promise. You can use the <code>HttpError</code> class to throw an error with status in one line:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="im">import</span> <span class="op">{</span> HttpError <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-admin&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="im">export</span> <span class="im">default</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-4" title="4">    <span class="dt">getList</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-5" title="5">        <span class="cf">return</span> <span class="kw">new</span> <span class="at">Promise</span>((resolve<span class="op">,</span> reject) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-6" title="6">            <span class="at">myApiClient</span>(url<span class="op">,</span> <span class="op">{</span> ...<span class="at">options</span><span class="op">,</span> <span class="dt">headers</span><span class="op">:</span> requestHeaders <span class="op">}</span>)</a>
<a class="sourceLine" id="cb14-7" title="7">                .<span class="at">then</span>(response <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb14-8" title="8">                    <span class="va">response</span>.<span class="at">text</span>().<span class="at">then</span>(text <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb14-9" title="9">                        <span class="dt">status</span><span class="op">:</span> <span class="va">response</span>.<span class="at">status</span><span class="op">,</span></a>
<a class="sourceLine" id="cb14-10" title="10">                        <span class="dt">statusText</span><span class="op">:</span> <span class="va">response</span>.<span class="at">statusText</span><span class="op">,</span></a>
<a class="sourceLine" id="cb14-11" title="11">                        <span class="dt">headers</span><span class="op">:</span> <span class="va">response</span>.<span class="at">headers</span><span class="op">,</span></a>
<a class="sourceLine" id="cb14-12" title="12">                        <span class="dt">body</span><span class="op">:</span> text<span class="op">,</span></a>
<a class="sourceLine" id="cb14-13" title="13">                    <span class="op">}</span>))</a>
<a class="sourceLine" id="cb14-14" title="14">                )</a>
<a class="sourceLine" id="cb14-15" title="15">                .<span class="at">then</span>((<span class="op">{</span> status<span class="op">,</span> statusText<span class="op">,</span> headers<span class="op">,</span> body <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-16" title="16">                    <span class="kw">let</span> json<span class="op">;</span></a>
<a class="sourceLine" id="cb14-17" title="17">                    <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-18" title="18">                        json <span class="op">=</span> <span class="va">JSON</span>.<span class="at">parse</span>(body)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-19" title="19">                    <span class="op">}</span> <span class="cf">catch</span> (e) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-20" title="20">                        <span class="co">// not json, no big deal</span></a>
<a class="sourceLine" id="cb14-21" title="21">                    <span class="op">}</span></a>
<a class="sourceLine" id="cb14-22" title="22">                    <span class="cf">if</span> (status <span class="op">&lt;</span> <span class="dv">200</span> <span class="op">||</span> status <span class="op">&gt;=</span> <span class="dv">300</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-23" title="23">                        <span class="cf">return</span> <span class="at">reject</span>(</a>
<a class="sourceLine" id="cb14-24" title="24">                            <span class="kw">new</span> <span class="at">HttpError</span>(</a>
<a class="sourceLine" id="cb14-25" title="25">                                (json <span class="op">&amp;&amp;</span> <span class="va">json</span>.<span class="at">message</span>) <span class="op">||</span> statusText<span class="op">,</span></a>
<a class="sourceLine" id="cb14-26" title="26">                                status<span class="op">,</span></a>
<a class="sourceLine" id="cb14-27" title="27">                                json</a>
<a class="sourceLine" id="cb14-28" title="28">                            )</a>
<a class="sourceLine" id="cb14-29" title="29">                        )<span class="op">;</span></a>
<a class="sourceLine" id="cb14-30" title="30">                    <span class="op">}</span></a>
<a class="sourceLine" id="cb14-31" title="31">                    <span class="cf">return</span> <span class="at">resolve</span>(<span class="op">{</span> status<span class="op">,</span> headers<span class="op">,</span> body<span class="op">,</span> json <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-32" title="32">                <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-33" title="33">        <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-34" title="34">    <span class="op">},</span></a>
<a class="sourceLine" id="cb14-35" title="35">    <span class="co">// ...</span></a>
<a class="sourceLine" id="cb14-36" title="36"><span class="op">};</span></a></code></pre></div>
<h2 id="example-implementation">Example Implementation</h2>
<p>Let’s say that you want to map the react-admin requests to a REST backend exposing the following API:</p>
<h3 id="getlist">getList</h3>
<pre><code>GET http://path.to.my.api/posts?sort=[&quot;title&quot;,&quot;ASC&quot;]&amp;range=[0, 4]&amp;filter={&quot;author_id&quot;:12}

HTTP/1.1 200 OK
Content-Type: application/json
Content-Range: posts 0-4/27
[
    { &quot;id&quot;: 126, &quot;title&quot;: &quot;allo?&quot;, &quot;author_id&quot;: 12 },
    { &quot;id&quot;: 127, &quot;title&quot;: &quot;bien le bonjour&quot;, &quot;author_id&quot;: 12 },
    { &quot;id&quot;: 124, &quot;title&quot;: &quot;good day sunshine&quot;, &quot;author_id&quot;: 12 },
    { &quot;id&quot;: 123, &quot;title&quot;: &quot;hello, world&quot;, &quot;author_id&quot;: 12 },
    { &quot;id&quot;: 125, &quot;title&quot;: &quot;howdy partner&quot;, &quot;author_id&quot;: 12 }
]</code></pre>
<h3 id="getone">getOne</h3>
<pre><code>GET http://path.to.my.api/posts/123

HTTP/1.1 200 OK
Content-Type: application/json
{ &quot;id&quot;: 123, &quot;title&quot;: &quot;hello, world&quot;, &quot;author_id&quot;: 12 }</code></pre>
<h3 id="getmany">getMany</h3>
<pre><code>GET http://path.to.my.api/posts?filter={&quot;id&quot;:[123,124,125]}

HTTP/1.1 200 OK
Content-Type: application/json
[
    { &quot;id&quot;: 123, &quot;title&quot;: &quot;hello, world&quot;, &quot;author_id&quot;: 12 },
    { &quot;id&quot;: 124, &quot;title&quot;: &quot;good day sunshine&quot;, &quot;author_id&quot;: 12 },
    { &quot;id&quot;: 125, &quot;title&quot;: &quot;howdy partner&quot;, &quot;author_id&quot;: 12 }
]</code></pre>
<h3 id="getmanyreference">getManyReference</h3>
<pre><code>GET http://path.to.my.api/comments?sort=[&quot;created_at&quot;,&quot;DESC&quot;]&amp;range=[0, 24]&amp;filter={&quot;post_id&quot;:123}

HTTP/1.1 200 OK
Content-Type: application/json
Content-Range: comments 0-1/2
[
    { &quot;id&quot;: 667, &quot;title&quot;: &quot;I agree&quot;, &quot;post_id&quot;: 123 },
    { &quot;id&quot;: 895, &quot;title&quot;: &quot;I don&#39;t agree&quot;, &quot;post_id&quot;: 123 }
]</code></pre>
<h3 id="create">create</h3>
<pre><code>POST http://path.to.my.api/posts
{ &quot;title&quot;: &quot;hello, world&quot;, &quot;author_id&quot;: 12 }

HTTP/1.1 200 OK
Content-Type: application/json
{ &quot;id&quot;: 123, &quot;title&quot;: &quot;hello, world&quot;, &quot;author_id&quot;: 12 }</code></pre>
<h3 id="update">update</h3>
<pre><code>PUT http://path.to.my.api/posts/123
{ &quot;title&quot;: &quot;hello, world!&quot; }

HTTP/1.1 200 OK
Content-Type: application/json
{ &quot;id&quot;: 123, &quot;title&quot;: &quot;hello, world!&quot;, &quot;author_id&quot;: 12 }</code></pre>
<h3 id="updatemany">updateMany</h3>
<pre><code>PUT http://path.to.my.api/posts?filter={&quot;id&quot;:[123,124,125]}
{ &quot;title&quot;: &quot;hello, world!&quot; }

HTTP/1.1 200 OK
Content-Type: application/json
[123, 124, 125]</code></pre>
<h3 id="delete">delete</h3>
<pre><code>DELETE http://path.to.my.api/posts/123

HTTP/1.1 200 OK
Content-Type: application/json
{ &quot;id&quot;: 123, &quot;title&quot;: &quot;hello, world&quot;, &quot;author_id&quot;: 12 }</code></pre>
<h3 id="deletemany">deleteMany</h3>
<pre><code>DELETE http://path.to.my.api/posts?filter={&quot;id&quot;:[123,124,125]}

HTTP/1.1 200 OK
Content-Type: application/json
[123, 124, 125]</code></pre>
<p>Here is an example implementation, that you can use as a base for your own Data Providers:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="im">import</span> <span class="op">{</span> fetchUtils <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-admin&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="im">import</span> <span class="op">{</span> stringify <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;query-string&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-3" title="3"></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="kw">const</span> apiUrl <span class="op">=</span> <span class="st">&#39;https://my.api.com/&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="kw">const</span> httpClient <span class="op">=</span> <span class="va">fetchUtils</span>.<span class="at">fetchJson</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-6" title="6"></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="im">export</span> <span class="im">default</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-8" title="8">    <span class="dt">getList</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-9" title="9">        <span class="kw">const</span> <span class="op">{</span> page<span class="op">,</span> perPage <span class="op">}</span> <span class="op">=</span> <span class="va">params</span>.<span class="at">pagination</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-10" title="10">        <span class="kw">const</span> <span class="op">{</span> field<span class="op">,</span> order <span class="op">}</span> <span class="op">=</span> <span class="va">params</span>.<span class="at">sort</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-11" title="11">        <span class="kw">const</span> query <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-12" title="12">            <span class="dt">sort</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>([field<span class="op">,</span> order])<span class="op">,</span></a>
<a class="sourceLine" id="cb24-13" title="13">            <span class="dt">range</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>([(page <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> perPage<span class="op">,</span> page <span class="op">*</span> perPage <span class="op">-</span> <span class="dv">1</span>])<span class="op">,</span></a>
<a class="sourceLine" id="cb24-14" title="14">            <span class="dt">filter</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="va">params</span>.<span class="at">filter</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-15" title="15">        <span class="op">};</span></a>
<a class="sourceLine" id="cb24-16" title="16">        <span class="kw">const</span> url <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">?</span><span class="sc">${</span><span class="at">stringify</span>(query)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-17" title="17"></a>
<a class="sourceLine" id="cb24-18" title="18">        <span class="cf">return</span> <span class="at">httpClient</span>(url).<span class="at">then</span>((<span class="op">{</span> headers<span class="op">,</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb24-19" title="19">            <span class="dt">data</span><span class="op">:</span> json<span class="op">,</span></a>
<a class="sourceLine" id="cb24-20" title="20">            <span class="dt">total</span><span class="op">:</span> <span class="at">parseInt</span>(<span class="va">headers</span>.<span class="at">get</span>(<span class="st">&#39;content-range&#39;</span>).<span class="at">split</span>(<span class="st">&#39;/&#39;</span>).<span class="at">pop</span>()<span class="op">,</span> <span class="dv">10</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-21" title="21">        <span class="op">}</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb24-22" title="22">    <span class="op">},</span></a>
<a class="sourceLine" id="cb24-23" title="23"></a>
<a class="sourceLine" id="cb24-24" title="24">    <span class="dt">getOne</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb24-25" title="25">        <span class="at">httpClient</span>(<span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="va">params</span>.<span class="at">id</span><span class="sc">}</span><span class="vs">`</span>).<span class="at">then</span>((<span class="op">{</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb24-26" title="26">            <span class="dt">data</span><span class="op">:</span> json<span class="op">,</span></a>
<a class="sourceLine" id="cb24-27" title="27">        <span class="op">}</span>))<span class="op">,</span></a>
<a class="sourceLine" id="cb24-28" title="28"></a>
<a class="sourceLine" id="cb24-29" title="29">    <span class="dt">getMany</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-30" title="30">        <span class="kw">const</span> query <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-31" title="31">            <span class="dt">filter</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">id</span><span class="op">:</span> <span class="va">params</span>.<span class="at">ids</span> <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-32" title="32">        <span class="op">};</span></a>
<a class="sourceLine" id="cb24-33" title="33">        <span class="kw">const</span> url <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">?</span><span class="sc">${</span><span class="at">stringify</span>(query)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-34" title="34">        <span class="cf">return</span> <span class="at">httpClient</span>(url).<span class="at">then</span>((<span class="op">{</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">data</span><span class="op">:</span> json <span class="op">}</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb24-35" title="35">    <span class="op">},</span></a>
<a class="sourceLine" id="cb24-36" title="36"></a>
<a class="sourceLine" id="cb24-37" title="37">    <span class="dt">getManyReference</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-38" title="38">        <span class="kw">const</span> <span class="op">{</span> page<span class="op">,</span> perPage <span class="op">}</span> <span class="op">=</span> <span class="va">params</span>.<span class="at">pagination</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-39" title="39">        <span class="kw">const</span> <span class="op">{</span> field<span class="op">,</span> order <span class="op">}</span> <span class="op">=</span> <span class="va">params</span>.<span class="at">sort</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-40" title="40">        <span class="kw">const</span> query <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-41" title="41">            <span class="dt">sort</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>([field<span class="op">,</span> order])<span class="op">,</span></a>
<a class="sourceLine" id="cb24-42" title="42">            <span class="dt">range</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>([(page <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> perPage<span class="op">,</span> page <span class="op">*</span> perPage <span class="op">-</span> <span class="dv">1</span>])<span class="op">,</span></a>
<a class="sourceLine" id="cb24-43" title="43">            <span class="dt">filter</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb24-44" title="44">                ...<span class="va">params</span>.<span class="at">filter</span><span class="op">,</span></a>
<a class="sourceLine" id="cb24-45" title="45">                [<span class="va">params</span>.<span class="at">target</span>]<span class="op">:</span> <span class="va">params</span>.<span class="at">id</span><span class="op">,</span></a>
<a class="sourceLine" id="cb24-46" title="46">            <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-47" title="47">        <span class="op">};</span></a>
<a class="sourceLine" id="cb24-48" title="48">        <span class="kw">const</span> url <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">?</span><span class="sc">${</span><span class="at">stringify</span>(query)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-49" title="49"></a>
<a class="sourceLine" id="cb24-50" title="50">        <span class="cf">return</span> <span class="at">httpClient</span>(url).<span class="at">then</span>((<span class="op">{</span> headers<span class="op">,</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb24-51" title="51">            <span class="dt">data</span><span class="op">:</span> json<span class="op">,</span></a>
<a class="sourceLine" id="cb24-52" title="52">            <span class="dt">total</span><span class="op">:</span> <span class="at">parseInt</span>(<span class="va">headers</span>.<span class="at">get</span>(<span class="st">&#39;content-range&#39;</span>).<span class="at">split</span>(<span class="st">&#39;/&#39;</span>).<span class="at">pop</span>()<span class="op">,</span> <span class="dv">10</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-53" title="53">        <span class="op">}</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb24-54" title="54">    <span class="op">},</span></a>
<a class="sourceLine" id="cb24-55" title="55"></a>
<a class="sourceLine" id="cb24-56" title="56">    <span class="dt">update</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb24-57" title="57">        <span class="at">httpClient</span>(<span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="va">params</span>.<span class="at">id</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-58" title="58">            <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb24-59" title="59">            <span class="dt">body</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="va">params</span>.<span class="at">data</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-60" title="60">        <span class="op">}</span>).<span class="at">then</span>((<span class="op">{</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">data</span><span class="op">:</span> json <span class="op">}</span>))<span class="op">,</span></a>
<a class="sourceLine" id="cb24-61" title="61"></a>
<a class="sourceLine" id="cb24-62" title="62">    <span class="dt">updateMany</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-63" title="63">        <span class="kw">const</span> query <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-64" title="64">            <span class="dt">filter</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">id</span><span class="op">:</span> <span class="va">params</span>.<span class="at">ids</span><span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-65" title="65">        <span class="op">};</span></a>
<a class="sourceLine" id="cb24-66" title="66">        <span class="cf">return</span> <span class="at">httpClient</span>(<span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">?</span><span class="sc">${</span><span class="at">stringify</span>(query)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-67" title="67">            <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;PUT&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb24-68" title="68">            <span class="dt">body</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="va">params</span>.<span class="at">data</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-69" title="69">        <span class="op">}</span>).<span class="at">then</span>((<span class="op">{</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">data</span><span class="op">:</span> json <span class="op">}</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb24-70" title="70">    <span class="op">},</span></a>
<a class="sourceLine" id="cb24-71" title="71"></a>
<a class="sourceLine" id="cb24-72" title="72">    <span class="dt">create</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb24-73" title="73">        <span class="at">httpClient</span>(<span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-74" title="74">            <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb24-75" title="75">            <span class="dt">body</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="va">params</span>.<span class="at">data</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-76" title="76">        <span class="op">}</span>).<span class="at">then</span>((<span class="op">{</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb24-77" title="77">            <span class="dt">data</span><span class="op">:</span> <span class="op">{</span> ...<span class="va">params</span>.<span class="at">data</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="va">json</span>.<span class="at">id</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb24-78" title="78">        <span class="op">}</span>))<span class="op">,</span></a>
<a class="sourceLine" id="cb24-79" title="79"></a>
<a class="sourceLine" id="cb24-80" title="80">    <span class="kw">delete</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb24-81" title="81">        <span class="at">httpClient</span>(<span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span><span class="va">params</span>.<span class="at">id</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-82" title="82">            <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;DELETE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb24-83" title="83">        <span class="op">}</span>).<span class="at">then</span>((<span class="op">{</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">data</span><span class="op">:</span> json <span class="op">}</span>))<span class="op">,</span></a>
<a class="sourceLine" id="cb24-84" title="84"></a>
<a class="sourceLine" id="cb24-85" title="85">    <span class="dt">deleteMany</span><span class="op">:</span> (resource<span class="op">,</span> params) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-86" title="86">        <span class="kw">const</span> query <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-87" title="87">            <span class="dt">filter</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">id</span><span class="op">:</span> <span class="va">params</span>.<span class="at">ids</span><span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-88" title="88">        <span class="op">};</span></a>
<a class="sourceLine" id="cb24-89" title="89">        <span class="cf">return</span> <span class="at">httpClient</span>(<span class="vs">`</span><span class="sc">${</span>apiUrl<span class="sc">}</span><span class="vs">/</span><span class="sc">${</span>resource<span class="sc">}</span><span class="vs">?</span><span class="sc">${</span><span class="at">stringify</span>(query)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb24-90" title="90">            <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;DELETE&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb24-91" title="91">            <span class="dt">body</span><span class="op">:</span> <span class="va">JSON</span>.<span class="at">stringify</span>(<span class="va">params</span>.<span class="at">data</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb24-92" title="92">        <span class="op">}</span>).<span class="at">then</span>((<span class="op">{</span> json <span class="op">}</span>) <span class="kw">=&gt;</span> (<span class="op">{</span> <span class="dt">data</span><span class="op">:</span> json <span class="op">}</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb24-93" title="93">    <span class="op">},</span></a>
<a class="sourceLine" id="cb24-94" title="94"><span class="op">};</span></a></code></pre></div>
<h2 id="using-the-data-provider-in-components">Using The Data Provider In Components</h2>
<p>React-admin stores the Data Provider passed to <code>&lt;Admin&gt;</code> in a React context, so you can access it from anywhere in your code. To facilitate usage, react-admin provides many data provider hooks:</p>
<ul>
<li><code>useDataProvider</code></li>
<li><code>useQuery</code></li>
<li><code>useQueryWithStore</code></li>
<li><code>useMutation</code></li>
<li><code>useGetList</code></li>
<li><code>useGetOne</code></li>
<li><code>useGetMany</code></li>
<li><code>useGetManyReference</code></li>
<li><code>useCreate</code></li>
<li><code>useUpdate</code></li>
<li><code>useUpdateMany</code></li>
<li><code>useDelete</code></li>
<li><code>useDeleteMany</code></li>
</ul>
<p>Here is a glimpse of the <code>useGetOne</code> hook usage:</p>
<pre class="jsx"><code>import { useGetOne } from &#39;react-admin&#39;;

const UserProfile = ({ record }) =&gt; {
    const { data, loading, error } = useGetOne(&#39;users&#39;, record.id);
    if (loading) { return &lt;Loading /&gt;; }
    if (error) { return &lt;p&gt;ERROR&lt;/p&gt;; }
    return &lt;div&gt;User {data.username}&lt;/div&gt;;
};</code></pre>
<p>You will find complete usage documentation for the data provider hooks in the <a href="./Actions.md">Querying the API</a> documentation chapter.</p>
<h2 id="real-time-updates-and-locks">Real-Time Updates And Locks</h2>
<p>Teams where several people work in parallel on a common task need to allow live updates, real-time notifications, and prevent data loss when two editors work on the same resource concurrently.</p>
<p><a href="https://marmelab.com/ra-enterprise/modules/ra-realtime"><code>ra-realtime</code></a> (an <a href="https://marmelab.com/ra-enterprise">Enterprise Edition <img class="icon" src="./img/premium.svg" /></a> module) provides hooks and UI components to lock records, and update views when the underlying data changes. It’s based on the Publish / Subscribe (PubSub) pattern, and requires a backend supporting this pattern (like GraphQL, Mercure).</p>
<p>For instance, here is how to enable live updates on a List view:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb26-1" title="1">import {</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">-   List,</span></a>
<a class="sourceLine" id="cb26-3" title="3">    Datagrid,</a>
<a class="sourceLine" id="cb26-4" title="4">    TextField,</a>
<a class="sourceLine" id="cb26-5" title="5">    NumberField,</a>
<a class="sourceLine" id="cb26-6" title="6">    Datefield,</a>
<a class="sourceLine" id="cb26-7" title="7">} from &#39;react-admin&#39;;</a>
<a class="sourceLine" id="cb26-8" title="8"><span class="va">+import { RealTimeList } from &#39;@react-admin/ra-realtime&#39;;</span></a>
<a class="sourceLine" id="cb26-9" title="9"></a>
<a class="sourceLine" id="cb26-10" title="10">const PostList = props =&gt; (</a>
<a class="sourceLine" id="cb26-11" title="11"><span class="st">-   &lt;List {...props}&gt;</span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="va">+   &lt;RealTimeList {...props}&gt;</span></a>
<a class="sourceLine" id="cb26-13" title="13">        &lt;Datagrid&gt;</a>
<a class="sourceLine" id="cb26-14" title="14">            &lt;TextField source=&quot;title&quot; /&gt;</a>
<a class="sourceLine" id="cb26-15" title="15">            &lt;NumberField source=&quot;views&quot; /&gt;</a>
<a class="sourceLine" id="cb26-16" title="16">            &lt;DateField source=&quot;published_at&quot; /&gt;</a>
<a class="sourceLine" id="cb26-17" title="17">        &lt;/Datagrid&gt;</a>
<a class="sourceLine" id="cb26-18" title="18"><span class="st">-   &lt;/List&gt;</span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="va">+   &lt;/RealTimeList&gt;</span></a>
<a class="sourceLine" id="cb26-20" title="20">);</a></code></pre></div>
<p>Check <a href="https://marmelab.com/ra-enterprise/modules/ra-realtime">the <code>ra-realtime</code> documentation</a> for more details.</p>
